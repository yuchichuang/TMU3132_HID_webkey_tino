ca89 V1.8.9 - (C) Copyright 2006-2014 tenx technology inc. 
Main file   : D:\Projects\TMU3132\TMU3132_HID_webkey_tino_getreport01h\TMU3132_HID_webkey_tino\TP6620 WEBKEY.asm
Current file: D:\Projects\TMU3132\TMU3132_HID_webkey_tino_getreport01h\TMU3132_HID_webkey_tino\TP6620 WEBKEY.asm

000000r 1                   #include	SETUP.h			;Enviroment define
000000r 2                   ;=================================================================================================
000000r 2                   ; 	Tenx TP6620
000000r 2                   ;
000000r 2                   ;==================================================================================================
000000r 2                   ;==================================================================================================
000000r 2                   ;	   System Definitions
000000r 2                   ;==================================================================================================
000000r 2                   
000000r 2                   ;------------- USB ID infomation define ------------------------
000000r 2                   VID_HI			equ		05h;11h;
000000r 2                   VID_LO			equ		ach;30h;
000000r 2                   PID_HI			equ		02h;98h;
000000r 2                   PID_LO			equ		0bh;08h;
000000r 2                   
000000r 2                   
000000r 2                   ;------------- CLOCK initial define ------------
000000r 2                   TP6620_CLK_INI	equ	28h
000000r 2                   
000000r 2                   ;---------- Interrupt Enable Setup Define ----------
000000r 2                   ;WARNING: Be carefully when open EXT/TM0 interrupt enable
000000r 2                   EN_INT0_NONE	equ	e0h	;When Reset
000000r 2                   EN_INT1_NONE	equ	15h
000000r 2                   EN_INT0_UNCONF	equ	e0h	;When Unconfig
000000r 2                   EN_INT1_UNCONF	equ	15h
000000r 2                   EN_INT0_NORMAL	equ	fch	;AddEp1 efh;AddEp2	e7h	;When Config	;Enable Suspend
000000r 2                   EN_INT1_NORMAL	equ	15h
000000r 2                   EN_INT0_SUSPEND	equ	e0h ;When Suspend
000000r 2                   EN_INT1_SUSPEND equ	1ch	;	Enable Resume
000000r 2                   
000000r 1                   #include	HEAD.h			;TX1645 Regster define
000000r 2                   ;==================================================================================================
000000r 2                   ;	   Register Definitions
000000r 2                   ;==================================================================================================
000000r 2                   ;-------------------------------------F-Plane Register Files---------------------------------------
000000r 2                   ;Rambank 0
000000r 2                   ;-------------------------------------F-Plane Register Files---------------------------------------
000000r 2                   ;--------Rambank1 Register Files (20h~7fh)---------------------------
000000r 2                   Indf		 		equ		00h
000000r 2                   Timer0				equ		01h
000000r 2                   Pcl			 	equ		02h
000000r 2                   Psw				equ		03h
000000r 2                   	RomPage			defstring	03h,6
000000r 2                   	RamBank 		defstring 	03h,5
000000r 2                   	Zero			defstring 	03h,2
000000r 2                   	DCarry 			defstring 	03h,1
000000r 2                   	Carry  			defstring 	03h,0
000000r 2                   
000000r 2                   Fsr		 		equ		04h	;F-plane file select register
000000r 2                   Rsr				equ		05h	;R-plane file select register
000000r 2                   PaReg				equ		06h
000000r 2                   	SDA			defstring	06h,1
000000r 2                   PbReg				equ		07h
000000r 2                   PeReg				equ		0ah
000000r 2                   	SCL			defstring	0ah,0
000000r 2                       	LED1			defstring	0ah,1
000000r 2                       	LED2			defstring	0ah,2
000000r 2                           LED			defstring	0ah,3
000000r 2                   
000000r 2                   ;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
000000r 2                   ;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
000000r 2                   
000000r 2                   UsbAddrReg			equ		10h			;
000000r 2                   	UsbEnable		defstring	10h,7
000000r 2                   Int0Reg				equ		11h
000000r 2                   	Set0i			defstring 	11h,7 	;
000000r 2                   	Out0i			defstring 	11h,6 	;
000000r 2                   	Tx0i			defstring 	11h,5 	;
000000r 2                   	Tx1i			defstring 	11h,4 	;
000000r 2                   	Tx2i			defstring 	11h,3 	;
000000r 2                   	Suspi			defstring	11h,2	;
000000r 2                   	Tx3i			defstring 	11h,1 	;
000000r 2                   	Rc4i  			defstring 	11h,0 	;
000000r 2                   
000000r 2                   Int1Reg				equ		12h
000000r 2                   	Wkti			defstring	12h,5
000000r 2                   	Rsti			defstring 	12h,4 	;
000000r 2                   	Rsmi			defstring 	12h,3 	;
000000r 2                   	Pb0i			defstring	12h,1	;
000000r 2                   	Timer0i			defstring	12h,0	;
000000r 2                   
000000r 2                   UsbCtrlReg			equ		13h
000000r 2                   	Suspend			defstring 	13h,7 	;s/w force usb interface into suspend mode
000000r 2                   	Resume			defstring 	13h,6 	;s/w force usb interface send RESUME signal in suspend mode
000000r 2                   	Ep1Cfg			defstring 	13h,5
000000r 2                   	Ep2Cfg			defstring 	13h,4
000000r 2                   	DeviceR			defstring 	13h,3 	;
000000r 2                   	Rc0Rdy			defstring 	13h,0 	;Ep0 Ready r
000000r 2                   Tx0Reg				equ		14h
000000r 2                   	Tx0Rdy			defstring 	14h,7 	;
000000r 2                   	Tx0Tgl			defstring 	14h,6 	;
000000r 2                   	Ep0Stall		defstring 	14h,5 	;
000000r 2                   	In0Stall		defstring	14h,4	;
000000r 2                   Tx1Reg				equ		15h
000000r 2                   	Tx1Rdy			defstring 	15h,7 	;
000000r 2                   	Tx1Tgl			defstring 	15h,6 	;
000000r 2                   	Ep1Stall		defstring 	15h,5 	;
000000r 2                   Tx2Reg				equ		16h
000000r 2                   	Tx2Rdy			defstring 	16h,7 	;
000000r 2                   	Tx2Tgl			defstring 	16h,6 	;
000000r 2                   	Ep2Stall		defstring 	16h,5 	;
000000r 2                   Tx3Reg				equ		17h
000000r 2                   	Tx3Rdy			defstring 	17h,7 	;
000000r 2                   	Tx3Tgl			defstring 	17h,6 	;
000000r 2                   	Ep3Stall		defstring 	17h,5 	;
000000r 2                   	Ep3Cfg			defstring 	17h,4 	;
000000r 2                   Rc4Reg				equ		18h
000000r 2                   	Rc4Rdy			defstring 	18h,7 	;
000000r 2                   	Rc4Tgl			defstring 	18h,6 	;
000000r 2                   	Ep4Stall		defstring 	18h,5 	;
000000r 2                   	Ep4Cfg			defstring 	18h,4 	;
000000r 2                   	Rc4Err			defstring	18h,3
000000r 2                   Tx3Cnt				equ		19h	; (R/W)
000000r 2                   Rc4Cnt				equ		1ah 	; (R only)
000000r 2                   XramCtrlReg			equ		1ch
000000r 2                   	Xram1Usb		defstring	1ch,5
000000r 2                   	Xram2Usb		defstring	1ch,4
000000r 2                   	Xram1Spi		defstring	1ch,3
000000r 2                   	Xram2Spi		defstring	1ch,2
000000r 2                   SpiCtrlReg			equ		1dh
000000r 2                   	SpiMode			defstring	1dh,5
000000r 2                   	SpiEnable		defstring	1dh,4	;SPI enable
000000r 2                   	LsbFirst		defstring	1dh,3
000000r 2                   	SetSpiIn		defstring	1dh,2	;write 1 to set spi receive data from SPI Device
000000r 2                   	SetSpiCmdMode		defstring	1dh,1	;Switch SINGLE/MULTI access of spi
000000r 2                   	ClearRamAddr		defstring	1dh,0	;write 1 to clear ram address
000000r 2                   ;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
000000r 2                   ;------------------------------------------------------------------------------
000000r 2                   ; Internal SRAM(0x20 ~0x3f,224 bytes)	don't need swith sram bank
000000r 2                   ;------------------------------------------------------------------------------
000000r 2                   gCbwNextStep			equ		20h	;cbw state control
000000r 2                   ;	gbStepFlag_SendCSW	defstring	20h,1
000000r 2                   ;	gbStepFlag_Write	defstring	20h,0
000000r 2                   
000000r 2                   
000000r 2                   gInt0Flag			equ		21h	;
000000r 2                   	gbRc0Flag		defstring 	21h,7 	;
000000r 2                   	gbOut0Flag		defstring 	21h,6 	;
000000r 2                   	gbTx0Flag		defstring 	21h,5 	;
000000r 2                   	gbTx1Flag		defstring 	21h,4 	;
000000r 2                   	gbTx2Flag		defstring 	21h,3 	;
000000r 2                   	gbSuspendFlag		defstring	21h,2	;
000000r 2                   	gbTx3Flag		defstring 	21h,1 	;
000000r 2                   	gbRc4Flag		defstring 	21h,0 	;
000000r 2                   gInt1Flag			equ		22h	;
000000r 2                   	gbExtFlag		defstring	22h,7	;
000000r 2                   	gbVDD5VRFlag		defstring	22h,6	;
000000r 2                   	gbWktFlag		defstring	22h,5	;
000000r 2                   	gbRstFlag		defstring	22h,4	;
000000r 2                   	gbRsmFlag		defstring	22h,3	;
000000r 2                   	gbKbdFlag		defstring	22h,2	;
000000r 2                   	gbPb0Flag		defstring	22h,1	;
000000r 2                   	gbTm0Flag		defstring	22h,0	;
000000r 2                   gInt2Flag			equ		23h	
000000r 2                   	gbTm1Flag		defstring	23h,0
000000r 2                   	gbNewAddrFlag		defstring 	23h,1
000000r 2                   	gbEp0TalkFlag		defstring	23h,2
000000r 2                   	DataOKFlag		defstring	23h,4
000000r 2                   	;gbTestFlag1		defstring	23h,5
000000r 2                   	;gbTestFlag2		defstring	23h,6
000000r 2                   	;gbTestFlag3		defstring	23h,7
000000r 2                   	
000000r 2                   gI2CFlag			equ		24h
000000r 2                   	DataOutFlag		defstring	24h,0
000000r 2                   	;DataInFlag		defstring	24h,1
000000r 2                   	OSType			defstring	24h,2
000000r 2                   	StartScanFlag		defstring	24h,3
000000r 2                   	Check_Flag		defstring	24h,4
000000r 2                   	JudgeSendFlag		defstring	24h,5
000000r 2                   	E2PROMFlag		defstring	24h,6
000000r 2                   	;FormatFlag		defstring	24h,7
000000r 2                   
000000r 2                   gScsiStatus2			equ		25h
000000r 2                   	MacVerFlag		defstring	25h,7
000000r 2                   	VerTestDoneFlag		defstring	25h,6		
000000r 2                   ;	E2PCheckFlag		defstring	25h,5
000000r 2                   	;gbHidIdle		defstring	25h,4
000000r 2                   	gbHidProtocol		defstring	25h,3
000000r 2                   	;gbAreaIndexBit8		defstring	25h,2
000000r 2                   	;gbDebug			defstring	25h,1
000000r 2                   	GUIFlag			defstring	25h,0
000000r 2                   
000000r 2                   ;2Ah-2Fh FREE................
000000r 2                   gbResetPath			defstring	2ah,0
000000r 2                   EndTransFlag			defstring	2ah,1
000000r 2                   OneFlag				defstring	2ah,2
000000r 2                   TransFlag			defstring	2ah,3
000000r 2                   PlugFlag			defstring	2ah,4
000000r 2                   WinTransAscII			defstring	2ah,5
000000r 2                   RestorLedsFlag			defstring	2ah,6
000000r 2                   WinRFlag			defstring	2ah,7
000000r 2                   
000000r 2                   EnterFlag			defstring	2bh,0
000000r 2                   BreakFlag			defstring	2bh,1
000000r 2                   DataInFlag1			defstring	2bh,2
000000r 2                   gfUSEinitGetDescriptor		defstring	2bh,3
000000r 2                   ;gfGetString1			defstring	2bh,4
000000r 2                   ;gfGetString2			defstring	2bh,5
000000r 2                   PressToggleFlag			defstring	2bh,6
000000r 2                   KeyPressedFlag			defstring	2bh,7
000000r 2                   
000000r 2                   ;LEDCheckPoint			defstring	2ch,0
000000r 2                   ;GetInfoFlag			defstring	2ch,1
000000r 2                   ;NewOSFlag			defstring	2ch,2
000000r 2                   USB30TrueFlag		defstring	2ch,2
000000r 2                   ;OSTypeFlag			defstring	2ch,3
000000r 2                   USB30TestFlag		defstring	2ch,3
000000r 2                   urladd1forenter		defstring	2ch,4
000000r 2                   ;gSendEnterOver		defstring	2ch,5
000000r 2                   ;gRegisterInitOver	defstring	2ch,6
000000r 2                   ;gEnterDelayOver	defstring	2ch,7
000000r 2                   
000000r 2                   ;SendSecurityEnd		defstring	2dh,0
000000r 2                   CheckLanguage		defstring	2dh,1
000000r 2                   W7StartCount		defstring	2dh,2
000000r 2                   FriPlugEnd			defstring	2dh,3
000000r 2                   NECUSB3ChipFlag		defstring	2dh,4
000000r 2                   E2PROM512Flag		defstring	2dh,5
000000r 2                   WriteE2EROMFlag		defstring	2dh,6
000000r 2                   SendFlag			defstring	2dh,7
000000r 2                   ;FrescoChipFlag		defstring	2dh,4
000000r 2                   ;OSTypeTemp			defstring	2dh,5
000000r 2                   
000000r 2                   CMDInFlag			defstring	2eh,0
000000r 2                   ;SecondCMDInFlag		defstring	2eh,1
000000r 2                   AskROMSizeFlag		defstring	2eh,2
000000r 2                   langSwitchDelayFlag	defstring	2eh,3
000000r 2                   MSJudgeSendOnceFlag	defstring	2eh,4
000000r 2                   AndroidOSFlag		defstring	2eh,5
000000r 2                   ReportIDFlag		defstring	2eh,6
000000r 2                   SendKeyNotYetFlag		defstring	2eh,7
000000r 2                   
000000r 2                   GetDeviceDspt08Byte		defstring	2fh,0
000000r 2                   AndroidURLDoneFlag		defstring	2fh,1
000000r 2                   setting0x51addrFlag		defstring	2fh,2
000000r 2                   
000000r 2                   gTempVar0			equ		30h
000000r 2                   gTempVar1			equ		31h	;Temp use Variable
000000r 2                   gTempVar2			equ		32h	;
000000r 2                   table0x51addr			equ		32h	;
000000r 2                   
000000r 2                   gTempVar3			equ		33h
000000r 2                   gTempVar4			equ		34h
000000r 2                   gTempVar5			equ		35h
000000r 2                   table0x51addr_add5			equ		35h
000000r 2                   
000000r 2                   gTempVar6			equ		36h
000000r 2                   
000000r 2                   ;37h-3Fh FREE.................
000000r 2                   BackupPSW			equ		37h
000000r 2                   TEMP1				equ		38h
000000r 2                   TEMP2				equ		39h
000000r 2                   AnyCountTemp			equ		3ah
000000r 2                   UsbLedDataTemp			equ		3bh
000000r 2                   WorkReg				equ		3ch
000000r 2                   getstring2counter		equ		3dh
000000r 2                   TimerRollOver			equ		3eh
000000r 2                   getstring1counter		equ		3fh
000000r 2                   
000000r 2                   
000000r 2                   ;------------------------------------------------------------------------------
000000r 2                   ;40h~ffh(bank 0 start from here)
000000r 2                   ;------------------------------------------------------------------------------
000000r 2                   gWLengthTemp			equ		40h
000000r 2                   gLengthCnt			equ		41h
000000r 2                   gTableCnt			equ		42h
000000r 2                   gDatalength			equ		43h
000000r 2                   gRemoteWakeupStatus   		equ		44h
000000r 2                   gConfigurationStatus		equ		45h
000000r 2                   gCurAlternate			equ		46h
000000r 2                   TempReg				equ		47h
000000r 2                   ;W_I2C_Address			equ		48h
000000r 2                   WindowsURLEnd			equ		48h
000000r 2                   R_I2C_Address			equ		49h
000000r 2                   R_I2C_Address1			equ		4ah
000000r 2                   nextsetreportflag		equ		4bh
000000r 2                   IdlePeriodStatus		equ		4ch
000000r 2                   gHidProtocolVal			equ		4dh
000000r 2                   ;TEMPE2PDATA			equ		4eh
000000r 2                   ;MaxURLLength			equ		4fh
000000r 2                   AndroidURLIndex			equ		4eh
000000r 2                   AndroidURLLength		equ		4fh
000000r 2                   
000000r 2                   ScanNumber			equ		50h
000000r 2                   TempCount			equ		51h
000000r 2                   EndMaxURL40h			equ		52h
000000r 2                   ReadURLTime			equ		53h
000000r 2                   UsbKeyBuffer0			equ		54h
000000r 2                   UsbKeyBuffer2			equ		55h
000000r 2                   UsbKeyBuffer3			equ		56h
000000r 2                   UsbKeyBuffer4			equ		57h
000000r 2                   KeyPress0			equ		58h
000000r 2                   KeyPress1			equ		59h
000000r 2                   KeyPress2			equ		5ah
000000r 2                   IdlePeriodTemp			equ		5bh
000000r 2                   UsbRequireState			equ		5ch
000000r 2                   WorkRegTemp			equ		5dh
000000r 2                   AsciiMSC			equ		5eh
000000r 2                   AsciiMID			equ		5fh
000000r 2                   AsciiLSC			equ		60h
000000r 2                   Judge_Capital			equ		61h
000000r 2                   CounterHead				equ		62h
000000r 2                   CounterHead2			equ		63h
000000r 2                   ;69h
000000r 2                   ;W_I2C_AddressH			equ	64h
000000r 2                   ;Check0FF				equ	65h
000000r 2                   ;Check1FF				equ	66h
000000r 2                   LanguageType			equ 64h
000000r 2                   AndroidURLEnd			equ	65h
000000r 2                   ScanNumTemp				equ	66h
000000r 2                   
000000r 2                   ReportDataLength		equ	67h
000000r 2                   ReportDataLengthH		equ	68h
000000r 2                   UsbKeyBuffer5			equ 69h
000000r 2                   
000000r 2                   ;gTempTalkCnt1			equ		67h	;Temp only once
000000r 2                   ;gTempTalkCnt2			equ		68h	;Temp only once
000000r 2                   ;gTempTalkCnt3			equ		69h	;Temp only once
000000r 2                   
000000r 2                   DelayCount			equ		6ah
000000r 2                   DelayCountH			equ		6bh
000000r 2                   BackupW				equ		6ch
000000r 2                   ;ReadI2CAddress		equ		6dh
000000r 2                   DelayCount_us		equ		6dh
000000r 2                   ReadI2CAddressH		equ		6eh
000000r 2                   ;PbdTemp				equ		6dh
000000r 2                   ;PbdLastStatus			equ		6eh
000000r 2                   PressToggle			equ		6fh
000000r 2                   
000000r 2                   DataBuffer0			equ		70h
000000r 2                   TimerCountH			equ		70h
000000r 2                   ;GetReportCounter		equ		71h
000000r 2                   
000000r 2                   CtrlCmdSpace		equ		72h
000000r 2                   EncryptionValue		equ		73h
000000r 2                   PitchXor			equ		74h
000000r 2                   ;SecurityKeyIndex	equ		75h
000000r 2                   MACURLEnd		equ		75h
000000r 2                   
000000r 2                   ResetFlag0			equ		72h
000000r 2                   ResetFlag1			equ		73h
000000r 2                   ResetFlag2			equ		74h
000000r 2                   ResetFlag3			equ		75h
000000r 2                   
000000r 2                   URLLenTemp			equ		76h
000000r 2                   ;SecurityDelayTime	equ		77h
000000r 2                   TimeBuffer			equ		78h
000000r 2                   SendSecuritytimes	equ		79h
000000r 2                   
000000r 2                   MacVerFlag0			equ		76h
000000r 2                   MacVerFlag1			equ		77h
000000r 2                   MacVerFlag2			equ		78h
000000r 2                   MacVerFlag3			equ		79h
000000r 2                   
000000r 2                   URLAddressIndex		equ		7ah
000000r 2                   URLAddressLen		equ		7bh
000000r 2                   MacURLAddressIndex	equ		7ch
000000r 2                   MacURLAddressLen	equ		7dh
000000r 2                   Setreportcount		equ		7eh
000000r 2                   Getreportcount		equ		7fh
000000r 2                   ;---------------------BANK1-----------------------------------------------------------
000000r 2                   ReadBuffer			equ		40h
000000r 2                   ReadBuffer0			equ		40h
000000r 2                   ReadBuffer1			equ		41h
000000r 2                   ReadBuffer2			equ		42h
000000r 2                   ReadBuffer3			equ		43h
000000r 2                   ReadBuffer4			equ		44h
000000r 2                   ReadBuffer5			equ		45h
000000r 2                   ReadBuffer6			equ		46h
000000r 2                   ReadBuffer7			equ		47h
000000r 2                   ReadBuffer22			equ		56h
000000r 2                   ReadBuffer23			equ		57h
000000r 2                   ;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
000000r 2                   ;-------------------------------------R-Plane Register Files---------------------------------------
000000r 2                   ;-
000000r 2                   ;-------------------------------------R-Plane Retister Files---------------------------------------
000000r 2                   INDR				equ		00h	; (R/W)  R-Plane address=[RSR]
000000r 2                   
000000r 2                   T0RLD				equ		01h
000000r 2                   T0en				defstring	02h,4
000000r 2                   T0Pscl				equ		02h	;	.3~0
000000r 2                   
000000r 2                   PwrDownCtrlReg			equ		03h	; (W only) write this register to enter Power-Down Mode
000000r 2                   WDTE				equ		04h	; (W only) write this register to clear WDT & enable WDT
000000r 2                   
000000r 2                   WrcConfig			equ		06h
000000r 2                   	Wrc_PD			defstring	06h,7
000000r 2                   
000000r 2                   ClockCtrlReg			equ		07h	; (W only) cpu clock speed select
000000r 2                   	En_Pe3_Cko		defstring	09h,1
000000r 2                   	IrcCko_Sel		defstring	09h,0
000000r 2                   
000000r 2                   TestReg				equ		10h
000000r 2                   Int0IeReg			equ		11h	; (W only)
000000r 2                   Int1IeReg			equ		12h	; (W only)
000000r 2                   
000000r 2                   Rc0Cnt				equ		13h	; (bit3-bit0) R only
000000r 2                   Rc0Reg				equ		13h	; (R only)
000000r 2                   	Rc0ToggleFlag		defstring 	13h,7	;
000000r 2                   	Rc0ErrorFlag		defstring 	13h,6 	;	<<<<<<<<<<< In R-Plan, it may need test bit by byte read.(movrw)
000000r 2                   	Ep0DirFlag		defstring 	13h,5 	;
000000r 2                   	Ep0SetFlag		defstring 	13h,4 	;
000000r 2                   
000000r 2                   PAE				equ		20h	;7~0
000000r 2                   PBE				equ		21h	;3~0
000000r 2                   PEE				equ		24h	;4~0
000000r 2                   PAPU				equ		25h	;7~0
000000r 2                   PBPU				equ		26h	;3~0
000000r 2                   PCDEPU				equ		27h	;0
000000r 2                   
000000r 2                   ;____________SPI
000000r 2                   SpiConfigReg			equ		3bh	; (W only)
000000r 2                   SpiCrsReg			equ		3ch	; (W only) spi clock select
000000r 2                   SpiDmaLengthReg			equ		3dh	; (W only) spi dma transfer length(1~64 bytes)
000000r 2                   SpiTxDataReg			equ		3eh	; (W only)
000000r 2                   SpiRxDataReg			equ		3fh	; (R only)
000000r 2                   
000000r 2                   Set0FifoReg			equ		40h	; (R only) 40h~47h
000000r 2                   	BmRequestType		equ		40h
000000r 2                   	BRequest		equ		41h
000000r 2                   	WValue		  	equ		42h	;default wValue (8-bits)
000000r 2                   	WValueHi		equ		43h
000000r 2                   	WIndex		  	equ		44h	;default wIndex (8-bits)
000000r 2                   	WIndexHi		equ		45h
000000r 2                   	WLength		 	equ		46h	;default wLength (8-bits)
000000r 2                   	WLengthHi	   	equ		47h
000000r 2                   Out0FifoReg			equ		48h	; (R only) 48h~4fh
000000r 2                   Out1FifoReg			equ		49h	;
000000r 2                   Tx0FifoReg			equ		50h	; (W only) 50h~57h
000000r 2                   	Tx0Fifo0		equ		50h
000000r 2                   	Tx0Fifo1		equ		51h
000000r 2                   	Tx0Fifo2		equ		52h
000000r 2                   	Tx0Fifo3		equ		53h
000000r 2                   	Tx0Fifo4		equ		54h
000000r 2                   	Tx0Fifo5		equ		55h
000000r 2                   	Tx0Fifo6		equ		56h
000000r 2                   	Tx0Fifo7		equ		57h
000000r 2                   Tx1FifoReg			equ		58h	; (W only) 58h~5fh
000000r 2                   Tx1FifoReg0			equ		58h
000000r 2                   Tx1FifoReg1			equ		59h
000000r 2                   Tx1FifoReg2			equ		5ah
000000r 2                   Tx1FifoReg3			equ		5bh
000000r 2                   Tx1FifoReg4			equ		5ch
000000r 2                   Tx1FifoReg5			equ		5dh
000000r 2                   Tx1FifoReg6			equ		5eh
000000r 2                   Tx1FifoReg7			equ		5fh
000000r 2                   
000000r 2                   Tx2FifoReg			equ		60h	; (W only) 60h~67h
000000r 2                   Tx2FifoReg0			equ		60h
000000r 2                   Tx2FifoReg1			equ		61h
000000r 2                   Tx2FifoReg2			equ		62h
000000r 2                   Tx2FifoReg3			equ		63h
000000r 2                   Tx2FifoReg4			equ		64h
000000r 2                   Tx2FifoReg5			equ		65h
000000r 2                   Tx2FifoReg6			equ		66h
000000r 2                   Tx2FifoReg7			equ		67h
000000r 2                   
000000r 2                   Xram1StartAddress		equ		80h
000000r 2                   Xram10				equ		80h
000000r 2                   Xram11				equ		81h
000000r 2                   Xram12				equ		82h
000000r 2                   Xram13				equ		83h
000000r 2                   Xram14				equ		84h
000000r 2                   Xram15				equ		85h
000000r 2                   Xram16				equ		86h
000000r 2                   Xram17				equ		87h
000000r 2                   Xram2StartAddress		equ		c0h
000000r 2                   Xram20				equ		c0h
000000r 2                   Xram21				equ		c1h
000000r 2                   Xram22				equ		c2h
000000r 2                   Xram23				equ		c3h
000000r 2                   Xram24				equ		c4h
000000r 2                   Xram25				equ		c5h
000000r 2                   Xram26				equ		c6h
000000r 2                   Xram27				equ		c7h
000000r 2                   
000000r 2                   ;==================================================================================================
000000r 2                   ;	   			Constant Definition
000000r 2                   ;==================================================================================================
000000r 2                   BIT0				equ		01h
000000r 2                   BIT1				equ		02h
000000r 2                   BIT2				equ		04h
000000r 2                   BIT3				equ		08h
000000r 2                   BIT4				equ		10h
000000r 2                   BIT5				equ		20h
000000r 2                   BIT6				equ		40h
000000r 2                   BIT7				equ		80h
000000r 2                   UsbNoReport			equ		00h
000000r 2                   UsbReportError			equ		01h
000000r 2                   UsbReport			equ		02h
000000r 2                   ;--------------------------------------------------------------------------------------------------
000000r 2                   ; Normal Constant Definition
000000r 2                   ;--------------------------------------------------------------------------------------------------
000000r 2                   W				equ		00h
000000r 2                   F				equ		01h
000000r 2                   ;--------------------------------------------------------------------------------------------------
000000r 2                   ; For USB Constant Definition
000000r 2                   ;--------------------------------------------------------------------------------------------------
000000r 2                   ;--------Define BmRequestType Types Files----------------------------
000000r 2                   HostToDevice			equ		00h
000000r 2                   HostToInterface			equ		01h
000000r 2                   HostToEndpoint			equ		02h
000000r 2                   HostClassToInterface		equ		21h
000000r 2                   DeviceToHost			equ		80h
000000r 2                   InterfaceToHost			equ		81h
000000r 2                   EndpointToHost			equ		82h
000000r 2                   InterfaceToHostClass		equ		a1h
000000r 2                   
000000r 2                   ;--------Define BRequest Types Files---------------------------------
000000r 2                   
000000r 2                   GetStatus			equ		00h
000000r 2                   ClearFeature			equ		01h
000000r 2                   ;GetIdle			equ		02h
000000r 2                   SetFeature			equ		03h
000000r 2                   SetAddress			equ		05h
000000r 2                   GetDescriptor			equ		06h
000000r 2                   GetConfiguration		equ		08h
000000r 2                   SetConfiguration		equ		09h
000000r 2                   GetInterface			equ		0ah
000000r 2                   SetInterface			equ		0bh
000000r 2                   ;--------Standard Descriptor Types-----------------------------------
000000r 2                   
000000r 2                   Device				equ		01h
000000r 2                   Configuration			equ		02h
000000r 2                   String				equ		03h
000000r 2                   Interface			equ		04h
000000r 2                   Endpoint			equ		05h
000000r 2                   HidClass			equ		21h
000000r 2                   HidReport			equ		22h
000000r 2                   
000000r 2                   String0				equ		00h
000000r 2                   String1				equ		01h
000000r 2                   String2				equ		02h
000000r 2                   String3				equ		03h
000000r 2                   
000000r 2                   Report1				equ		01h
000000r 2                   Report2				equ		02h
000000r 2                   
000000r 2                   ;------------------------------------------------------------------------
000000r 2                   ; For HID Constant Definition
000000r 2                   ;------------------------------------------------------------------------
000000r 2                   ;-class specific descriptor types from section  Standard Requests-
000000r 2                   
000000r 2                   GetRequest			equ		a1h
000000r 2                   SetRequest			equ		21h
000000r 2                   
000000r 2                   ;-class specific request codes from section 7.2 Class Specific Requests
000000r 2                   
000000r 2                   GetReport			equ		01h
000000r 2                   GetIdle				equ		02h
000000r 2                   GetProtocol			equ		03h
000000r 2                   SetReport			equ		09h
000000r 2                   SetIdle				equ		0ah
000000r 2                   SetProtocol			equ		0bh
000000r 2                   
000000r 2                   ;-------------------------------------------------------------------------
000000r 2                   UnConfig			equ		00h
000000r 2                   Config				equ		01h
000000r 2                   
000000r 2                   LedValue			equ		02h
000000r 2                   StallValue			equ		01h
000000r 2                   
000000r 2                   DisableRemoteWakeup		equ		00h
000000r 2                   EnableRemoteWakeup		equ		02h
000000r 2                   
000000r 2                   Endpoint0			equ		80h	;
000000r 2                   Endpoint1			equ		81h	;Tx1
000000r 2                   Endpoint2			equ		82h	;Tx2
000000r 2                   Endpoint3			equ		83h	;Tx3
000000r 2                   Endpoint4			equ		04h	;Rc4
000000r 2                   
000000r 2                   Interface0			equ		00h
000000r 2                   Interface1			equ		01h
000000r 2                   Interface2			equ		02h
000000r 2                   
000000r 2                   DeviceLen			equ		12h
000000r 2                   ConfigLen			defstring	(String0_Descriptor-Configuration_Descriptor)
000000r 2                   
000000r 2                   String0Len		  	equ		04h
000000r 2                   String1Len		  	defstring 	(String2_Descriptor-String1_Descriptor)
000000r 2                   String2Len		  	defstring 	(HID_Report1_Desc-String2_Descriptor)
000000r 2                   
000000r 2                   ConfigIndex			defstring	(Configuration_Descriptor-Device_Descriptor)
000000r 2                   String0Index			defstring	(String0_Descriptor-Device_Descriptor)
000000r 2                   String1Index			defstring	(String1_Descriptor-Device_Descriptor)
000000r 2                   String2Index			defstring	(String2_Descriptor-Device_Descriptor)
000000r 2                   
000000r 2                   KeyboardReport			equ		01h
000000r 2                   LedReport			equ		02h
000000r 2                   
000000r 2                   HidClassLen			equ		09h
000000r 2                   HidReport1Len			defstring	(Device_Status_Table1-HID_Report1_Desc)
000000r 2                   HidClass1Index			defstring	(HID_Class1_Desc-Device_Descriptor)
000000r 2                   HidReport1Index			defstring	(HID_Report1_Desc-Device_Descriptor)
000000r 2                   
000000r 2                   ;HidReport2Len			defstring	(Device_Status_Table2-HID_Report2_Desc)
000000r 2                   ;HidClass2Index			defstring	(HID_Class2_Desc-Device_Descriptor)
000000r 2                   ;HidReport2Index			defstring	(HID_Report2_Desc-Device_Descriptor)
000000r 2                   
000000r 2                   ;DeviceIDIndex			defstring	(DeviceIDTable-DeviceIDTable)
000000r 2                   ;URLAddressIndex		defstring	(URLAddressTable-DeviceIDTable)
000000r 2                   ;URLAddressLen			defstring	(MacURLAddressTable-URLAddressTable+1)
000000r 2                   ;URLAddressLenMinus1	defstring	(MacURLAddressTable-URLAddressTable)
000000r 2                   
000000r 2                   ;MacURLAddressIndex		defstring	(MacURLAddressTable-DeviceIDTable)
000000r 2                   ;MacURLAddressLen		defstring	(SecurityKeyURLAddress-MacURLAddressTable+2)
000000r 2                   ;MacURLAddressLenMinus1	defstring	(SecurityKeyURLAddress-MacURLAddressTable)
000000r 2                   
000000r 2                   ;SecurityKeyIndex		defstring	(SecurityKeyURLAddress-DeviceIDTable)
000000r 2                   ;SecurityKeyLen			defstring	(SecurityKeyEnd-SecurityKeyURLAddress)
000000r 2                   ;SecurityEndAddr			defstring	(SecurityKeyEnd-DeviceIDTable)
000000r 2                   
000000r 2                   MacWebLength			defstring	(MacArray_end-MacArray_start)
000000r 2                   MacWebLength1			defstring	(MacArray_end1-MacArray_start1)
000000r 2                   WinWebLength			defstring	(WinArray_endA-WinArray_startA)
000000r 2                   
000000r 2                   LanguageNumber				equ		01h
000000r 2                   EncryptionType				equ		02h
000000r 2                   WindowsURLaddrStartLow		equ		04h
000000r 2                   WindowsURLaddrLength		equ		05h
000000r 2                   WindowsURLaddrEndtLow		equ		07h
000000r 2                   CtrlCmdSpaceType			equ		0dh
000000r 2                   
000000r 2                   MACURLaddrStartLow		equ		04h
000000r 2                   MACURLaddrLength		equ		05h
000000r 2                   MACURLaddrEndtLow		equ		07h
000000r 2                   
000000r 2                   AndroidWebLength		defstring	(AndroidArray_end-AndroidArray_start)
000000r 2                   AndroidThirdLength		defstring	(AndroidThird_end-AndroidThird_start)
000000r 2                   AndroidURLaddrStartLow		equ		04h
000000r 2                   AndroidURLaddrLength		equ		05h
000000r 2                   AndroidURLaddrEndtLow		equ		07h
000000r 2                   ;--------------------------------------------------------------------------------------------------
000000r 2                   ;Macro Definition
000000r 2                   ;--------------------------------------------------------------------------------------------------
000000r 2                   XRAM1CPU_XRAM2CPU	.MAC
000000r 2                   	clrf	XramCtrlReg
000000r 2                   .ENDM
000000r 2                   
000000r 2                   XRAM1SPI_XRAM2CPU	.MAC
000000r 2                   	movlw	08h
000000r 2                   	movwf	XramCtrlReg
000000r 2                   .ENDM
000000r 2                   
000000r 2                   XRAM1CPU_XRAM2SPI	.MAC
000000r 2                   	movlw	04h
000000r 2                   	movwf	XramCtrlReg
000000r 2                   .ENDM
000000r 2                   
000000r 2                   XRAM1CPU_XRAM2USB	.MAC
000000r 2                   	movlw	10h
000000r 2                   	movwf	XramCtrlReg
000000r 2                   .ENDM
000000r 2                   
000000r 2                   XRAM1USB_XRAM2CPU	.MAC
000000r 2                   	movlw	20h
000000r 2                   	movwf	XramCtrlReg
000000r 2                   .ENDM
000000r 2                   
000000r 2                   XRAM1SPI_XRAM2USB	.MAC
000000r 2                   	movlw	18h
000000r 2                   	movwf	XramCtrlReg
000000r 2                   .ENDM
000000r 2                   
000000r 2                   XRAM1USB_XRAM2SPI	.MAC
000000r 2                   	movlw	24h
000000r 2                   	movwf	XramCtrlReg
000000r 2                   .ENDM
000000r 2                   
000000r 2                   ;----------------------------------------
000000r 2                   LBA_SWITCH_P1	.MAC
000000r 2                   	bsf	03h,6	;RomPage1
000000r 2                   .ENDM
000000r 2                   LBA_SWITCH_P0	.MAC
000000r 2                   	bcf 03h,6	;RomPage0
000000r 2                   .ENDM
000000r 2                   ;----------------------------------------
000000r 2                   Delay_us   .MAC   Time            ;Delay "Cycles" instruction cycles
000000r 2                   
000000r 2                     .IF (Time+0=1)
000000r 2                     	goto $ + 1
000000r 2                           nop
000000r 2                           .EXITMAC
000000r 2                     .ENDIF
000000r 2                   
000000r 2                     .IF (Time+0=2)
000000r 2                     	goto $ + 1
000000r 2                           goto $ + 1
000000r 2                           nop
000000r 2                           .EXITMAC
000000r 2                     .ENDIF
000000r 2                   
000000r 2                     .IF (Time+0=3)
000000r 2                           goto $ + 1
000000r 2                           goto $ + 1
000000r 2                           goto $ + 1
000000r 2                           goto $ + 1
000000r 2                           .EXITMAC
000000r 2                     .ENDIF
000000r 2                   
000000r 2                     .IF (Time+0=4)
000000r 2                           goto $ + 1
000000r 2                           goto $ + 1
000000r 2                           goto $ + 1
000000r 2                           goto $ + 1
000000r 2                           goto $ + 1
000000r 2                           nop
000000r 2                           .EXITMAC
000000r 2                     .ENDIF
000000r 2                   
000000r 2                     .IF (Time+0=5)
000000r 2                     	goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                           goto $ + 1
000000r 2                           goto $ + 1
000000r 2                           goto $ + 1
000000r 2                           .EXITMAC
000000r 2                     .ENDIF
000000r 2                   
000000r 2                     .IF (Time+0=6)
000000r 2                           goto $ + 1
000000r 2                           goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                       	goto $ + 1
000000r 2                           .EXITMAC
000000r 2                     .ENDIF
000000r 2                   
000000r 2                     .IF (Time+0=7)
000000r 2                     	goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                           goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                           goto $ + 1
000000r 2                           goto $ + 1
000000r 2                           nop
000000r 2                           .EXITMAC
000000r 2                     .ENDIF
000000r 2                   
000000r 2                     .IF (Time+0=8)
000000r 2                           goto $ + 1
000000r 2                           goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                           goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                           goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                     	goto $ + 1
000000r 2                           goto $ + 1
000000r 2                           .EXITMAC
000000r 2                     .ENDIF
000000r 2                   
000000r 2                   
000000r 2                     .IF (Time%2=0)
000000r 2                           movlw 	Time
000000r 2                           movwf	DelayCount_us
000000r 2                   	decfsz	DelayCount_us,F
000000r 2                   	goto	$ - 1
000000r 2                          .EXITMAC
000000r 2                     .ENDIF
000000r 2                   
000000r 2                     .IF (Time%2=1)
000000r 2                           movlw 	Time
000000r 2                           movwf	DelayCount_us
000000r 2                   	decfsz	DelayCount_us,F
000000r 2                   	goto	$ - 1
000000r 2                   ;       .EXITMAC
000000r 2                     .ENDIF
000000r 2                   
000000r 2                   .ENDM
000000r 2                   
000000r 1                   #include 	USB_FUNC.asm		;USB function
000000r 2                   
000000r 2                   ;==================================================================================================
000000r 2                   		org	0000h			;Reset Vector
000000  2                   ;==================================================================================================
000000  2                   
000000  2  3000 443          		goto	Start
000001  2                   
000001  2                   ;==================================================================================================
000001  2                   		org	0001h			;Interrupt Vector
000001  2                   ;==================================================================================================
000001  2  3000 e           		goto	INT_Rc0
000002  2  3000 1a          		goto	INT_Out0
000003  2  3000 2b          		goto	INT_Tx0
000004  2  3000 35          		goto	INT_Tx1
000005  2  3000 3e          		goto	INT_Tx2
000006  2  3000 b1          		goto	INT_Susp
000007  2  3000 48          		goto	INT_Tx3
000008  2  3000 51          		goto	INT_Rc4
000009  2                   
000009  2  3000 8c          		goto	INT_Rst
00000A  2  3000 99          		goto	INT_Rsm
00000B  2  3000 5a          		goto	INT_WakeupTimer
00000C  2  3000 64          		goto	INT_Timer0
00000D  2  3000 82          		goto	INT_PB0ExternalIO
00000E  2                   
00000E  2                   ;==============================================================================
00000E  2                   ;==============================================================================
00000E  2                   INT_Rc0:					;SETUP Command
00000E  2  0080 6c          		movwf	BackupW
00000F  2  0800 3           		movfw	Psw
000010  2  0080 37          		movwf	BackupPSW
000011  2                   
000011  2  0180 14          		clrf	Tx0Reg
000012  2                   
000012  2  1900 7f          		movlw	7fh
000013  2  0080 11          		movwf	Int0Reg
000014  2                   		;bcf	Set0i
000014  2  1200 21,7        		bsf	gbRc0Flag
000015  2  1000 14,5        		bcf	Ep0Stall
000016  2                   
000016  2  0800 37          		movfw	BackupPSW
000017  2  0080 3           		movwf	Psw
000018  2  0800 6c          		movfw	BackupW
000019  2  0060             		reti
00001A  2                   
00001A  2                   INT_Out0:					;Received DATA
00001A  2  0080 6c          		movwf	BackupW
00001B  2  0800 3           		movfw	Psw
00001C  2  0080 37          		movwf	BackupPSW
00001D  2                   
00001D  2  1900 bf          		movlw	bfh
00001E  2  0080 11          		movwf	Int0Reg
00001F  2                   	;	bcf	Out0i
00001F  2  1400 2d,6        		btfsc	WriteE2EROMFlag	
000020  2  1200 21,6        		bsf	gbOut0Flag
000021  2  1F00 13          		movrw	Rc0Cnt
000022  2  1B00 2           		andlw	02h
000023  2  1400 3,2         		btfsc	Zero
000024  2  3000 27          		goto	$+3
000025  2  1F00 49          		movrw	Out1FifoReg;Out0FifoReg			;if Rc0Cnt=1, it is SetLed data here
000026  2  0080 3b          		movwf	UsbLedDataTemp
000027  2  0800 37          		movfw	BackupPSW
000028  2  0080 3           		movwf	Psw
000029  2  0800 6c          		movfw	BackupW
00002A  2  0060             		reti
00002B  2                   
00002B  2                   INT_Tx0:					;Send DATA
00002B  2  0080 6c          		movwf	BackupW
00002C  2  0800 3           		movfw	Psw
00002D  2  0080 37          		movwf	BackupPSW
00002E  2                   
00002E  2  1900 df          		movlw	dfh
00002F  2  0080 11          		movwf	Int0Reg
000030  2                   
000030  2                   	;	bcf	Tx0i
000030  2  1200 21,5        		bsf	gbTx0Flag
000031  2                   
000031  2  0800 37          		movfw	BackupPSW
000032  2  0080 3           		movwf	Psw
000033  2  0800 6c          		movfw	BackupW
000034  2                   
000034  2  0060             		reti
000035  2                   
000035  2                   INT_Tx1:
000035  2  0080 6c          		movwf	BackupW
000036  2  0800 3           		movfw	Psw
000037  2  0080 37          		movwf	BackupPSW
000038  2                   
000038  2  1900 ef          		movlw	efh
000039  2  0080 11          		movwf	Int0Reg
00003A  2                   
00003A  2                   	;	bcf	Tx1i
00003A  2                   	;	bsf	gbTx1Flag
00003A  2                   
00003A  2  0800 37          		movfw	BackupPSW
00003B  2  0080 3           		movwf	Psw
00003C  2  0800 6c          		movfw	BackupW
00003D  2  0060             		reti
00003E  2                   
00003E  2                   INT_Tx2:
00003E  2  0080 6c          		movwf	BackupW
00003F  2  0800 3           		movfw	Psw
000040  2  0080 37          		movwf	BackupPSW
000041  2                   
000041  2  1900 f7          		movlw	f7h
000042  2  0080 11          		movwf	Int0Reg
000043  2                   
000043  2                   	;	bcf	Tx2i
000043  2  1200 21,3        		bsf	gbTx2Flag
000044  2                   
000044  2  0800 37          		movfw	BackupPSW
000045  2  0080 3           		movwf	Psw
000046  2  0800 6c          		movfw	BackupW
000047  2  0060             		reti
000048  2                   
000048  2                   INT_Tx3:
000048  2  0080 6c          		movwf	BackupW
000049  2  0800 3           		movfw	Psw
00004A  2  0080 37          		movwf	BackupPSW
00004B  2                   
00004B  2  1900 fd          		movlw	fdh
00004C  2  0080 11          		movwf	Int0Reg
00004D  2                   
00004D  2                   	;	bcf	Tx3i
00004D  2                   	;	bsf	gbTx3Flag
00004D  2                   
00004D  2  0800 37          		movfw	BackupPSW
00004E  2  0080 3           		movwf	Psw
00004F  2  0800 6c          		movfw	BackupW
000050  2  0060             		reti
000051  2                   
000051  2                   INT_Rc4:
000051  2  0080 6c          		movwf	BackupW
000052  2  0800 3           		movfw	Psw
000053  2  0080 37          		movwf	BackupPSW
000054  2                   
000054  2  1900 fe          		movlw	feh
000055  2  0080 11          		movwf	Int0Reg
000056  2                   
000056  2                   	;	bcf	Rc4i
000056  2                   	;	bsf	gbRc4Flag
000056  2                   
000056  2  0800 37          		movfw	BackupPSW
000057  2  0080 3           		movwf	Psw
000058  2  0800 6c          		movfw	BackupW
000059  2  0060             		reti
00005A  2                   
00005A  2                   INT_WakeupTimer:
00005A  2  0080 6c          		movwf	BackupW
00005B  2  0800 3           		movfw	Psw
00005C  2  0080 37          		movwf	BackupPSW
00005D  2                   
00005D  2  1900 df          		movlw	dfh
00005E  2  0080 12          		movwf	Int1Reg
00005F  2                   
00005F  2                   	;	bcf	Wkti
00005F  2  1200 22,5        		bsf	gbWktFlag
000060  2                   
000060  2  0800 37          		movfw	BackupPSW
000061  2  0080 3           		movwf	Psw
000062  2  0800 6c          		movfw	BackupW
000063  2  0060             		reti
000064  2                   
000064  2                   INT_Timer0:
000064  2  0080 6c          		movwf	BackupW
000065  2  0800 3           		movfw	Psw
000066  2  0080 37          		movwf	BackupPSW
000067  2                   
000067  2  1900 fe          		movlw	feh
000068  2  0080 12          		movwf	Int1Reg
000069  2                   	;	bcf	Timer0i
000069  2  1200 22,0        		bsf	gbTm0Flag
00006A  2  0A00 3e,1        		incf	TimerRollOver,F
00006B  2                   
00006B  2  1600 2d,2        		btfss	W7StartCount		;entry time: set report
00006C  2  3000 7e          		goto	$+18
00006D  2  1400 2d,3        		btfsc	FriPlugEnd
00006E  2  3000 7e          		goto	$+16		
00006F  2  1900 1           		movlw	01h
000070  2  0600 63,0        		xorwf	CounterHead2,W
000071  2  1400 3,2         		btfsc	Zero
000072  2  3000 78          		goto	$+6
000073  2  0A00 62,1        		incf	CounterHead,F
000074  2  0880 62          		testz	CounterHead
000075  2  1400 3,2         		btfsc	Zero
000076  2  0A00 63,1        		incf	CounterHead2,F
000077  2  3000 7e          		goto	$+7
000078  2  0180 3e          		clrf	TimerRollOver
000079  2  1900 4           		movlw	04h					;3x delay for send key
00007A  2  0080 6b          		movwf	DelayCountH
00007B  2  1200 24,5        		bsf		JudgeSendFlag
00007C  2  1200 2d,3        		bsf		FriPlugEnd			;if FriPlugEnd be cleared, this counter will be execute one more time.
00007D  2  1200 2e,4        		bsf		MSJudgeSendOnceFlag
00007E  2                   	
00007E  2  0800 37          		movfw	BackupPSW
00007F  2  0080 3           		movwf	Psw
000080  2  0800 6c          		movfw	BackupW
000081  2  0060             		reti
000082  2                   
000082  2                   INT_PB0ExternalIO:
000082  2  0080 6c          		movwf	BackupW
000083  2  0800 3           		movfw	Psw
000084  2  0080 37          		movwf	BackupPSW
000085  2                   
000085  2  1900 fd          		movlw	fdh
000086  2  0080 12          		movwf	Int1Reg
000087  2                   
000087  2                   	;	bcf	Pb0i
000087  2  1200 22,1        		bsf	gbPb0Flag
000088  2                   
000088  2  0800 37          		movfw	BackupPSW
000089  2  0080 3           		movwf	Psw
00008A  2  0800 6c          		movfw	BackupW
00008B  2  0060             		reti
00008C  2                   
00008C  2                   
00008C  2                   ;==============================================================================
00008C  2                   INT_Rst:
00008C  2  0080 6c          		movwf	BackupW
00008D  2  0800 3           		movfw	Psw
00008E  2  0080 37          		movwf	BackupPSW
00008F  2                   
00008F  2                   		;bsf	LED1
00008F  2  1900 ef          		movlw	efh
000090  2  0080 12          		movwf	Int1Reg
000091  2                   	;	bcf	Rsti
000091  2  1200 22,4        		bsf	gbRstFlag
000092  2  1000 13,7        		bcf	Suspend			;Clear Interface in suspend mode
000093  2                   
000093  2  1200 2a,0        		bsf	gbResetPath
000094  2                   ;		call	UsbReset
000094  2  3000 e1          		goto	UsbReset
000095  2                   	INT_RST_END_USBRESET:
000095  2                   	;	bcf	LED
000095  2                   
000095  2  0800 37          		movfw	BackupPSW
000096  2  0080 3           		movwf	Psw
000097  2  0800 6c          		movfw	BackupW
000098  2  0060             		reti
000099  2                   ;==============================================================================
000099  2                   INT_Rsm:
000099  2  0080 6c          		movwf	BackupW
00009A  2  0800 3           		movfw	Psw
00009B  2  0080 37          		movwf	BackupPSW
00009C  2                   
00009C  2  1900 f7          		movlw	f7h
00009D  2  0080 12          		movwf	Int1Reg
00009E  2                   	;	bcf	Rsmi
00009E  2                   
00009E  2  1000 a,1         		bcf	LED1
00009F  2                   
00009F  2  1900 c           		movlw	0ch		;Try Pb2/Pb3 pull-up;TestV7
0000A0  2  1E00 26          		movwr	PBPU
0000A1  2  1900 ff          		movlw	ffh
0000A2  2  0080 7           		movwf	PbReg
0000A3  2  1200 13,3        		bsf	DeviceR
0000A4  2                   
0000A4  2  1900 80          		movlw	80h
0000A5  2  0400 10,1        		iorwf	UsbAddrReg,F
0000A6  2                   
0000A6  2                   	;	bsf	gbRsmFlag
0000A6  2  1000 21,2        		bcf	gbSuspendFlag		;Keeping FLAG
0000A7  2  1000 13,7        		bcf	Suspend			;Clear Interface in suspend mode
0000A8  2                   
0000A8  2  1900 fc          		movlw	EN_INT0_NORMAL
0000A9  2  1E00 11          		movwr	Int0IeReg
0000AA  2  1900 15          		movlw	EN_INT1_NORMAL
0000AB  2  1E00 12          		movwr	Int1IeReg
0000AC  2  1200 24,3        		bsf	StartScanFlag
0000AD  2                   
0000AD  2  0800 37          		movfw	BackupPSW
0000AE  2  0080 3           		movwf	Psw
0000AF  2  0800 6c          		movfw	BackupW
0000B0  2  0060             		reti
0000B1  2                   ;==============================================================================
0000B1  2                   INT_Susp:
0000B1  2  0080 6c          		movwf	BackupW
0000B2  2  0800 3           		movfw	Psw
0000B3  2  0080 37          		movwf	BackupPSW
0000B4  2                   
0000B4  2  1900 fa          		movlw	fah
0000B5  2  0080 11          		movwf	Int0Reg
0000B6  2                   ;		bcf	Suspi
0000B6  2  1200 21,2          		bsf	gbSuspendFlag		;Keeping FLAG
0000B7  2                   
0000B7  2  1200 a,1         		bsf	LED1
0000B8  2  1200 a,2         		bsf	LED2
0000B9  2                   
0000B9  2                   	;	movlw	EN_INT0_SUSPEND
0000B9  2                   	;	movwr	Int0IeReg
0000B9  2                   	;	movlw	EN_INT1_SUSPEND
0000B9  2                   	;	movwr	Int1IeReg
0000B9  2                           ;
0000B9  2                     	;	bsf	Suspend			;Force Interface to suspend mode
0000B9  2                           ;
0000B9  2                   	;	movfw	UsbAddrReg		;If have address ?
0000B9  2                   	;	andlw	7fh
0000B9  2                   	;	btfsc	Zero
0000B9  2                   	;	goto	END_PWR_DOWN
0000B9  2                           ;
0000B9  2                   	;	movlw	ffh
0000B9  2                   	;	movwr	PwrDownCtrlReg
0000B9  2                   	END_PWR_DOWN:
0000B9  2  0800 37          		movfw	BackupPSW
0000BA  2  0080 3           		movwf	Psw
0000BB  2  0800 6c          		movfw	BackupW
0000BC  2  0060               		reti
0000BD  2                   ;==============================================================================
0000BD  2                   SystemReset:
0000BD  2  1900 28          		movlw	TP6620_CLK_INI
0000BE  2  1E00 7           		movwr	ClockCtrlReg
0000BF  2                   
0000BF  2  1900 60          		movlw	60h
0000C0  2  1E00 6           		movwr	WrcConfig
0000C1  2                   	;_________Init Tm0_______
0000C1  2                   		;>>>DON'T CHANGE TIMER-0 PRRIOD<<<<
0000C1  2  1900 0           		movlw	00d			;(256-24*1)		;1ms
0000C2  2                   
0000C2  2  1E00 1           		movwr	T0RLD
0000C3  2  0080 1           		movwf	Timer0			;Count of time
0000C4  2                   
0000C4  2  1900 18          		movlw	18h			;Enable/Prescale8=256
0000C5  2  1E00 2           		movwr	T0Pscl
0000C6  2                   						; BIT.4		Enable
0000C6  2                   						; BIT.3-0	Prescale(0:div1/1:div2/8:div256)
0000C6  2  1900 1           		movlw	1h
0000C7  2  1E00 12          		movwr	12h			;Enable Interrupt
0000C8  2                   
0000C8  2                   	;-----Clear RamBank1---------
0000C8  2  1200 3,5         		bsf	RamBank			;1
0000C9  2  1900 40          		movlw	40h
0000CA  2  2000 d8          		call	InitRAM
0000CB  2                   	;-----Clear RamBank0------
0000CB  2  1000 3,5         		bcf	RamBank			;0
0000CC  2  1900 20          		movlw	20h
0000CD  2  2000 d8          		call	InitRAM
0000CE  2  1900 0           		movlw	00h
0000CF  2  0080 7f          		movwf	Getreportcount
0000D0  2  0080 7e          		movwf	Setreportcount
0000D1  2                   	;-----Reset Int -----------
0000D1  2  1900 e0          		movlw	EN_INT0_NONE
0000D2  2  1E00 11          		movwr	Int0IeReg
0000D3  2  1900 15          		movlw	EN_INT1_NONE
0000D4  2  1E00 12          		movwr	Int1IeReg
0000D5  2                   
0000D5  2                   	;-----Data Info Bit Flag------
0000D5  2  1600 6,0         		btfss	PaReg,0
0000D6  2  1200 24,6        		bsf	E2PROMFlag
0000D7  2  0040             		ret
0000D8  2                   ;--------------------------------------
0000D8  2                   ;	Clear Area : 20h-7fh
0000D8  2                   ;--------------------------------------
0000D8  2                   InitRAM:
0000D8  2                   	;	movlw	20h
0000D8  2  0080 4           		movwf	Fsr
0000D9  2                   	SR_ClearLoop0:
0000D9  2  1900 0           		movlw	00h
0000DA  2  0080 0           		movwf	Indf
0000DB  2  0A00 4,1         		incf	Fsr,F
0000DC  2  1900 7f          		movlw	7fh
0000DD  2  0200 4,0         		subwf	Fsr,W
0000DE  2  1600 3,2         		btfss	Zero
0000DF  2  3000 d9          		goto	SR_ClearLoop0
0000E0  2  0040             		ret
0000E1  2                   
0000E1  2                   ;==============================================================================
0000E1  2                   UsbReset:
0000E1  2                   	;	movlw	0
0000E1  2                   	;	movwf	UsbAddrReg
0000E1  2                   	
0000E1  2                   		;movlw	ffh
0000E1  2                   		;movwf	DelayCount
0000E1  2                   		;movlw	a8h
0000E1  2                   		;movwf	DelayCountH
0000E1  2                   	;InitWaiting:
0000E1  2                   		;decf	DelayCount,F
0000E1  2                   		;testz	DelayCount
0000E1  2                   		;btfsc	Zero
0000E1  2                   		;decf	DelayCountH,F
0000E1  2                   		;testz	DelayCountH
0000E1  2                   		;btfss	Zero
0000E1  2                   		;goto	InitWaiting
0000E1  2                   		;clrf	DelayCount
0000E1  2                   		;clrf	DelayCountH
0000E1  2                   		
0000E1  2                   	;-----Clear RamBank1---------
0000E1  2                   		;bsf	RamBank			;1
0000E1  2                   		;movlw	40h
0000E1  2                   		;call	InitRAM
0000E1  2                   	;-----Clear RamBank0------
0000E1  2                   		;bcf	RamBank			;0
0000E1  2                   		;movlw	20h
0000E1  2                   		;call	InitRAM
0000E1  2                   		
0000E1  2  0180 11          		clrf	Int0Reg
0000E2  2  0180 12          		clrf	Int1Reg
0000E3  2  0180 14          		clrf	Tx0Reg
0000E4  2  0180 17          		clrf	Tx3Reg
0000E5  2  0180 18          		clrf	Rc4Reg
0000E6  2                   
0000E6  2  1200 13,3        		bsf	DeviceR
0000E7  2                   
0000E7  2  1000 13,7        		bcf	Suspend
0000E8  2  1900 e0          		movlw	EN_INT0_NONE
0000E9  2  1E00 11          		movwr	Int0IeReg
0000EA  2  1900 15          		movlw	EN_INT1_NONE
0000EB  2  1E00 12          		movwr	Int1IeReg
0000EC  2                   	;	movlw	BIT7			;EN_USB bit
0000EC  2  1900 80          		movlw   80h
0000ED  2  0080 10          		movwf	UsbAddrReg
0000EE  2                   
0000EE  2  0180 20          		clrf	gCbwNextStep
0000EF  2  1900 10          		XRAM1CPU_XRAM2USB
0000F0  2  0080 1c          
0000F1  2                   
0000F1  2  1200 13,0        		bsf	Rc0Rdy
0000F2  2  1400 2a,0        		btfsc	gbResetPath
0000F3  2  3000 95          		goto	INT_RST_END_USBRESET
0000F4  2  0040             		ret
0000F5  2                   
0000F5  2                   ;==============================================================================
0000F5  2                   SuspendTask:
0000F5  2  1900 e0          		movlw	EN_INT0_SUSPEND
0000F6  2  1E00 11          		movwr	Int0IeReg
0000F7  2  1900 1c          		movlw	EN_INT1_SUSPEND
0000F8  2  1E00 12          		movwr	Int1IeReg
0000F9  2                   
0000F9  2  1000 a,3         		bcf	LED
0000FA  2                   
0000FA  2  1200 13,7          		bsf	Suspend			;Force Interface to suspend mode
0000FB  2                   
0000FB  2  0800 10          		movfw	UsbAddrReg		;If have address ?
0000FC  2  1B00 7f          		andlw	7fh
0000FD  2  1400 3,2         		btfsc	Zero
0000FE  2  0040             		ret
0000FF  2                   
0000FF  2  1900 ff          		movlw	ffh
000100  2  1E00 3           		movwr	PwrDownCtrlReg
000101  2  0000             		nop
000102  2  0000             		nop
000103  2  0000             		nop
000104  2  1200 a,3         		bsf	LED
000105  2  0040             		ret
000106  2                   
000106  2                   ;==============================================================================
000106  2                   ;Input W=Length
000106  2                   EP0Transfer:
000106  2  0080 36          		movwf	gTempVar6
000107  2                   
000107  2  1900 40          		movlw	BIT6			;TX0tgl=>1
000108  2  0600 14,1        		xorwf	Tx0Reg,F
000109  2  1900 f0            		movlw	f0h
00010A  2  0500 14,1          		andwf	Tx0Reg,F		;Clear TX0cnt
00010B  2  0800 36          		movfw	gTempVar6
00010C  2  0400 14,1        		iorwf	Tx0Reg,F		;gLengthCnt=>1
00010D  2  1200 14,7          		bsf	Tx0Rdy
00010E  2  0040             		ret
00010F  2                   
00010F  2                   NoDataControl:
00010F  2  0140             		clrw
000110  2  2000 106         		call	EP0Transfer
000111  2  1200 13,0        		bsf	Rc0Rdy			;WaitNextCommand
000112  2  0040             		ret
000113  2                   ;==============================================================================
000113  2                   EP3Transfer:
000113  2                   		;movlw	BIT6			;TX0tgl=>1
000113  2                   		;xorwf	Tx3Reg,F
000113  2                   		;movlw	40h
000113  2                   		;movwf	Tx3Cnt
000113  2                     		;bsf	Tx3Rdy
000113  2                   		;ret
000113  2                   ;==============================================================================
000113  2                   Rc0Task:
000113  2  1000 21,7        		bcf	gbRc0Flag
000114  2                   		
000114  2  1F00 13          		movrw	Rc0Reg			;if(Rc0Err) ErrHandler.
000115  2  1B00 40          		andlw	BIT6
000116  2  1600 3,2         		btfss	Zero
000117  2  3000 225         		goto	SetupCmdErr
000118  2                   
000118  2  1F00 40          		movrw	BmRequestType
000119  2  0080 31          		movwf	gTempVar1
00011A  2  0E00 31,1        		swapf	gTempVar1,F
00011B  2  0C00 31,0        		rrf	gTempVar1,W
00011C  2  1B00 3           		andlw	3h
00011D  2  0700 2,1         		addwf	Pcl,F
00011E  2                   
00011E  2  3000 212         		goto	RequestStandard
00011F  2  3000 122         		goto	RequestClass
000120  2  3000 211         		goto	RequestVendor
000121  2  3000 225         		goto	SetupCmdErr
000122  2                   ;==============================================================================
000122  2                   RequestClass:
000122  2                   		;Check Index value
000122  2  1F00 44          		movrw	WIndex			;WIndex must be 0 or 1
000123  2  1B00 fe          		andlw	feh
000124  2  1600 3,2         		btfss	Zero
000125  2  3000 225         		goto	SetupCmdErr
000126  2                   
000126  2  1F00 44          		movrw	WIndex
000127  2  0700 2,1         		addwf	Pcl,F
000128  2  3000 12c         		goto	ClassCmd_HID
000129  2  3000 12c         		goto	ClassCmd_HID	;SetupCmdErr
00012A  2  3000 225         		goto	SetupCmdErr
00012B  2  3000 225         		goto	SetupCmdErr
00012C  2                   ;==============================================================================
00012C  2                   
00012C  2                   ClassCmd_HID:
00012C  2  1F00 41          		movrw	BRequest
00012D  2  1D00 b           		xorlw	SetProtocol
00012E  2  1400 3,2         		btfsc	Zero
00012F  2  3000 1ee         		goto	HidSetProtocol
000130  2                   
000130  2  1F00 41          		movrw	BRequest
000131  2  1D00 3           		xorlw	GetProtocol
000132  2  1400 3,2         		btfsc	Zero
000133  2  3000 20a         		goto	HidGetProtocol
000134  2                   
000134  2  1F00 41          		movrw	BRequest
000135  2  1D00 1           		xorlw	GetReport
000136  2  1400 3,2         		btfsc	Zero
000137  2  3000 1b8         		goto	HidGetReport
000138  2                   
000138  2  1F00 41          		movrw	BRequest
000139  2  1D00 9           		xorlw	SetReport
00013A  2  1400 3,2         		btfsc	Zero
00013B  2  3000 168         		goto	HidSetReport
00013C  2                   
00013C  2  1F00 41          		movrw	BRequest
00013D  2  1D00 2           		xorlw	GetIdle
00013E  2  1400 3,2         		btfsc	Zero
00013F  2  3000 145         		goto	HidGetIdle
000140  2                   
000140  2  1F00 41          		movrw	BRequest
000141  2  1D00 a           		xorlw	SetIdle
000142  2  1400 3,2         		btfsc	Zero
000143  2  3000 14a         		goto	HidSetIdle
000144  2                   
000144  2  3000 225         		goto	SetupCmdErr
000145  2                   
000145  2                   	HidGetIdle:
000145  2  0800 4c          		movfw	IdlePeriodStatus		;Echo DATA
000146  2  1E00 50          		movwr	Tx0Fifo0
000147  2                   
000147  2  1900 1           		movlw	1h
000148  2  2000 106         		call	EP0Transfer
000149  2  0040             		ret
00014A  2                   
00014A  2                   	HidSetIdle:
00014A  2                   		;WValue->ReportID/0(all)
00014A  2  1400 24,2        			btfsc	OSType				;for Fresco USB 3.0
00014B  2  3000 154         			goto	$+9;$+6;
00014C  2  1200 24,2        			bsf	OSType
00014D  2  1900 2           			movlw	02h
00014E  2  0200 3f,0        			subwf	getstring1counter,W	;if getstring1counter >= 2, bcf	OSType
00014F  2  1400 3,0         			btfsc	Carry
000150  2  3000 153         			goto	$+3
000151  2  1200 2d,4        			bsf	NECUSB3ChipFlag			;handle send key stuck, meanwhile 
000152  2  3000 154         			goto	$+2
000153  2  1000 24,2        			bcf	OSType					;restore original mac os
000154  2                   
000154  2                   
000154  2  1900 1           			movlw	01h
000155  2  0200 3f,0        			subwf	getstring1counter,W	
000156  2  1600 3,0         			btfss	Carry
000157  2  3000 15e         			goto	$+7			
000158  2  1900 2           			movlw	02h					;check if Android 4.0 OS
000159  2  0200 3d,0        			subwf	getstring2counter,W
00015A  2  1400 3,0         			btfsc	Carry
00015B  2  3000 15e         			goto	$+3
00015C  2  1000 24,2        			bcf	OSType					;select other flag for Android
00015D  2  1200 2e,5        			bsf	AndroidOSFlag
00015E  2                   
00015E  2                   			
00015E  2  1200 24,3        		bsf	StartScanFlag
00015F  2  0180 3e          			clrf	TimerRollOver
000160  2  1900 8a          			movlw	8ah
000161  2  0080 6a          			movwf	DelayCount
000162  2                   			
000162  2  1F00 43          		movrw	WValueHi
000163  2  0080 4c          		movwf	IdlePeriodStatus
000164  2  0080 5b          		movwf	IdlePeriodTemp
000165  2                   
000165  2  0140             		clrw				;ACK
000166  2  2000 106         		call	EP0Transfer
000167  2  0040             		ret
000168  2                   
000168  2                   	HidSetReport:
000168  2                   		;..............................
000168  2                   		;........Receive Data..........
000168  2                   		;..............................
000168  2  1F00 46          		movrw	WLength
000169  2  1D00 20          		xorlw	20h
00016A  2  1400 3,2         		btfsc	Zero
00016B  2  1200 2d,6        		bsf		WriteE2EROMFlag
00016C  2  0A00 7e,1        		incf	Setreportcount,F				;when fisrt emuration, the value must be even, otherwise odd
00016D  2  0880 45            		testz	gConfigurationStatus			;ConfigurationStatus = UnConfig ?
00016E  2  1400 3,2           		btfsc	Zero
00016F  2  3000 1b6          		goto	HidSetRequestTaskError
000170  2                       CheckInterface2:
000170  2  1F00 44          			movrw	WIndex
000171  2  1D00 1           			xorlw	01h
000172  2  1600 3,2           		btfss	Zero
000173  2  3000 175           		goto	CheckInterface1
000174  2  3000 1b2           		goto	HidSetRequestTaskSend
000175  2                   	CheckInterface1:	
000175  2  1200 24,3            	bsf	StartScanFlag
000176  2  1F00 44          			movrw	WIndex
000177  2  1D00 0           			xorlw	00h		
000178  2  1600 3,2           		btfss	Zero
000179  2  3000 1b6           		goto	HidSetRequestTaskError
00017A  2                   		
00017A  2  1F00 43          		movrw	WValueHi
00017B  2  1D00 2           		xorlw	02h			
00017C  2  1400 3,2           		btfsc	Zero		
00017D  2  1200 2d,2          		bsf		W7StartCount				;enable this flag = start timer for trigger JudgeSendFlag
00017E  2                   		
00017E  2  1400 24,4          		btfsc	Check_Flag
00017F  2  3000 1b2         		goto	HidSetRequestTaskSend
000180  2  1600 24,2          		btfss	OSType
000181  2  3000 1b2           		goto	HidSetRequestTaskSend
000182  2  1900 0           		movlw	00h
000183  2  0600 4b,0        		xorwf	nextsetreportflag,W
000184  2  1400 3,2         		btfsc	Zero
000185  2  3000 18c         		goto	testfirstplugin
000186  2  1900 1           		movlw	01h
000187  2  0600 4b,0        		xorwf	nextsetreportflag,W
000188  2  1600 3,2         		btfss	Zero
000189  2  3000 1b2         		goto	HidSetRequestTaskSend
00018A  2  0A00 4b,1        		incf	nextsetreportflag,F
00018B  2  3000 192         		goto	deviceready
00018C  2                     	testfirstplugin:
00018C  2  1400 2c,2        		btfsc	USB30TrueFlag
00018D  2  3000 1b1         		goto	waitnextgetreport	
00018E  2                   		
00018E  2  1900 4             		movlw	04h;07h						;1st emuration run failed
00018F  2  0200 3d,0          		subwf	getstring2counter,W
000190  2  1400 3,0           		btfsc	Carry	
000191  2                   		
000191  2                   		;btfsc	USB30TrueFlag
000191  2                   		;goto	waitnextgetreport	
000191  2                   		
000191  2                     		;movlw	04h						;only 1st emuration long delay
000191  2                     		;subwf	getstring2counter,W
000191  2                     		;btfsc	Carry		
000191  2  3000 1b1           		goto	waitnextgetreport		;goto first emuration delay
000192  2                     	deviceready:
000192  2                   		
000192  2  1900 1             		movlw	01h
000193  2  0200 3d,0          		subwf	getstring2counter,W
000194  2  1600 3,0           		btfss	Carry		
000195  2  3000 1b2           		goto	HidSetRequestTaskSend
000196  2  1200 24,4          		bsf	Check_Flag
000197  2                   
000197  2  1F00 43          		movrw	WValueHi
000198  2  1D00 2           		xorlw	02h			
000199  2  1600 3,2           		btfss	Zero		
00019A  2  3000 1ad         		goto	deviceready2
00019B  2  1900 2           			movlw	02h						;for NEC USB 3.0 chipset
00019C  2  0200 3d,0        			subwf	getstring2counter,W
00019D  2  1600 3,0         			btfss	Carry
00019E  2  1200 2d,4        			bsf	NECUSB3ChipFlag
00019F  2                   			
00019F  2  1600 2d,4        			btfss	NECUSB3ChipFlag
0001A0  2  3000 1a9         			goto	$+9
0001A1  2  0800 7e          			movfw	Setreportcount
0001A2  2  1D00 1           			xorlw	01h;02h
0001A3  2  1600 3,2         			btfss	Zero
0001A4  2  3000 1ad         			goto	deviceready2
0001A5  2  0800 7f          			movfw	Getreportcount
0001A6  2  1D00 1           			xorlw	01h;02h
0001A7  2  1600 3,2         			btfss	Zero
0001A8  2  3000 1ad         			goto	deviceready2
0001A9  2                   
0001A9  2  1400 2e,4        			btfsc	MSJudgeSendOnceFlag	;make sure only one send key path
0001AA  2  3000 1ad         			goto	deviceready2
0001AB  2                   			
0001AB  2  1200 24,5        	 	bsf	JudgeSendFlag				;if u want to send key, JudgeSendFlag and Check_Flag must be 1
0001AC  2  1200 2d,3        		bsf	FriPlugEnd
0001AD  2                   deviceready2:		
0001AD  2  0180 3e            		clrf	TimerRollOver			;second emuration delay
0001AE  2  1900 c             		movlw	0ch;a0h;		
0001AF  2  0080 6a            		movwf	DelayCount	
0001B0  2  3000 1b2           		goto	HidSetRequestTaskSend
0001B1  2                   	waitnextgetreport:
0001B1  2  0A00 4b,1        		incf	nextsetreportflag,F		;if first goto here, getstring2counter>=7 
0001B2  2                   			;movlw	09h
0001B2  2                   			;subwf	getstring2counter,W
0001B2  2                   			;btfss	Carry
0001B2  2                   			;goto	$+12
0001B2  2                   			;movfw	Getreportcount
0001B2  2                   			;xorlw	01h
0001B2  2                   			;btfss	Zero			
0001B2  2                   			;goto	$+8
0001B2  2                   			;bsf	JudgeSendFlag
0001B2  2                   			;bsf	Check_Flag
0001B2  2                   			;;bsf	FriPlugEnd
0001B2  2                   			;clrf	TimerRollOver
0001B2  2                   			;movlw	8ah		
0001B2  2                   			;movwf	DelayCount	
0001B2  2                   			;movlw	04h
0001B2  2                   			;movwf	DelayCountH			
0001B2  2                   		;btfss	USB30TrueFlag
0001B2  2                   		;goto	$+7
0001B2  2                   		;movfw	Setreportcount
0001B2  2                   		;andlw	02h
0001B2  2                   		;btfss	Zero
0001B2  2                   		;goto	$+3
0001B2  2                   		;bsf	JudgeSendFlag
0001B2  2                   		;bsf	Check_Flag
0001B2  2                   		
0001B2  2                   		;bsf	JudgeSendFlag
0001B2  2                     		;bcf	Check_Flag
0001B2  2                     		;clrf	TimerRollOver			;first emuration delay
0001B2  2                     		;movlw	f0h;0ch;
0001B2  2                     		;movwf	DelayCount
0001B2  2                     		;movlw	04h
0001B2  2                     		;movwf	DelayCountH
0001B2  2                   		;bsf	JudgeSendFlag
0001B2  2                   		;bsf	FriPlugEnd
0001B2  2                       HidSetRequestTaskSend:
0001B2  2  0140             		clrw				;ACK
0001B3  2  2000 106         		call	EP0Transfer
0001B4  2  1200 13,0        		bsf	Rc0Rdy
0001B5  2  0040             		ret
0001B6  2                   ;--------------------------------------------------		
0001B6  2                   	HidSetRequestTaskError:
0001B6  2  1200 14,5        		bsf	Ep0Stall
0001B7  2  0040             		ret		
0001B8  2                   ;--------------------------------------------------		
0001B8  2                   
0001B8  2                   	HidGetReport:
0001B8  2                   		;..............................
0001B8  2                   		;..........Return Data.........
0001B8  2                   		;..............................
0001B8  2                   ;		incf	Getreportcount,F
0001B8  2  1F00 44          		movrw	WIndex			;if(Index==1)
0001B9  2  1D00 0           		xorlw	00h
0001BA  2  1600 3,2             		btfss	Zero
0001BB  2  3000 1bf             		goto	GetReport1
0001BC  2                   	GetReport2:
0001BC  2  1900 1             		movlw	1h
0001BD  2  0080 43          		movwf	gDatalength
0001BE  2  3000 315         		goto	GetDescriptorTaskSend
0001BF  2                   
0001BF  2                         	GetReport1:
0001BF  2  1F00 43                		movrw	WValueHi
0001C0  2  1D00 1               		xorlw	01h			;KeyboardReport
0001C1  2  1400 3,2             		btfsc	Zero
0001C2  2  3000 1e2             		goto	SendKeyboardReport
0001C3  2                   	SendLedReport:
0001C3  2  1400 2e,2        		btfsc	AskROMSizeFlag
0001C4  2  3000 1ca         		goto	SendE2PROMSize
0001C5  2                   		
0001C5  2                   ;		btfsc	CMDInFlag
0001C5  2                   ;		goto	Senddata2host
0001C5  2                   
0001C5  2                   		
0001C5  2  0800 3b            		movfw	UsbLedDataTemp
0001C6  2  1E00 50            		movwr	Tx0Fifo0
0001C7  2  1900 c1            		movlw	c1h
0001C8  2  0080 14            		movwf	Tx0Reg
0001C9  2  0040             		ret
0001CA  2                   
0001CA  2                   SendE2PROMSize:
0001CA  2  1000 2e,2        		bcf		AskROMSizeFlag
0001CB  2  1600 24,6        		btfss	E2PROMFlag
0001CC  2  0040             		ret
0001CD  2                   		
0001CD  2  1900 55          		movlw	55h
0001CE  2  1E00 50           		movwr	Tx0Fifo0
0001CF  2  1900 1           		movlw	01h
0001D0  2  1400 2d,5        		btfsc	E2PROM512Flag
0001D1  2  1900 2           		movlw	02h
0001D2  2  1E00 51          		movwr	Tx0Fifo1
0001D3  2  1900 0           		movlw	00h
0001D4  2  1E00 52           		movwr	Tx0Fifo2
0001D5  2  1900 0           		movlw	00h
0001D6  2  1E00 53           		movwr	Tx0Fifo3
0001D7  2  1900 0           		movlw	00h
0001D8  2  1E00 54           		movwr	Tx0Fifo4
0001D9  2  1900 0           		movlw	00h
0001DA  2  1E00 55           		movwr	Tx0Fifo5
0001DB  2  1900 0           		movlw	00h
0001DC  2  1E00 56           		movwr	Tx0Fifo6
0001DD  2  1900 0           		movlw	00h
0001DE  2  1E00 57           		movwr	Tx0Fifo7
0001DF  2                   		
0001DF  2  1900 c8            		movlw	c8h
0001E0  2  0080 14            		movwf	Tx0Reg		
0001E1  2  0040             		ret
0001E2  2                   		
0001E2  2                         	SendKeyboardReport:
0001E2  2  1900 0                 		movlw	00h
0001E3  2  1E00 50                		movwr	Tx0Fifo0
0001E4  2  1E00 51                		movwr	Tx0Fifo1
0001E5  2  1E00 52                		movwr	Tx0Fifo2
0001E6  2  1E00 53                		movwr	Tx0Fifo3
0001E7  2  1E00 54                		movwr	Tx0Fifo4
0001E8  2  1E00 55                		movwr	Tx0Fifo5
0001E9  2  1E00 56                		movwr	Tx0Fifo6
0001EA  2  1E00 57                		movwr	Tx0Fifo7
0001EB  2  1900 c8          		movlw	c8h
0001EC  2  0080 14            		movwf	Tx0Reg
0001ED  2  0040             		ret
0001EE  2                   
0001EE  2                   	HidSetProtocol:
0001EE  2  1400 24,4        		btfsc	Check_Flag
0001EF  2  3000 200         		goto	NoMacOS
0001F0  2                   		
0001F0  2  1400 2f,0        		btfsc GetDeviceDspt08Byte
0001F1  2  1000 24,2        		bcf OSType
0001F2  2                   		
0001F2  2  1400 24,2          		btfsc	OSType
0001F3  2  3000 200         		goto	NoMacOS
0001F4  2  1900 1           		movlw	01h
0001F5  2  0200 3d,0        		subwf	getstring2counter,W;getstring0counter,W
0001F6  2  1600 3,0         		btfss	Carry
0001F7  2  3000 200         		goto	NoMacOS
0001F8  2  1200 24,4        		bsf	Check_Flag
0001F9  2  1400 24,2        		btfsc	OSType
0001FA  2  3000 1fc         		goto	HidSetProtocol_2	
0001FB  2  1200 24,5        	 	bsf	JudgeSendFlag
0001FC  2                   HidSetProtocol_2:		
0001FC  2  0180 3e          	 	clrf	TimerRollOver
0001FD  2  1900 c           	 	movlw	0ch;60h			;08h
0001FE  2  0080 6a          	 	movwf	DelayCount
0001FF  2                   		
0001FF  2                   		;movlw	01h
0001FF  2                   		;movwf	DelayCountH
0001FF  2  0180 6b          	 	clrf	DelayCountH
000200  2                     	NoMacOS:
000200  2  1200 24,3        		bsf	StartScanFlag
000201  2                   
000201  2  1200 25,3        		bsf	gbHidProtocol
000202  2  1F00 42          		movrw	WValue
000203  2  0080 4d          		movwf	gHidProtocolVal
000204  2  1B00 ff          		andlw	ffh
000205  2  1400 3,2         		btfsc	Zero
000206  2  1000 25,3        		bcf	gbHidProtocol
000207  2                   
000207  2  0140             		clrw				;ACK
000208  2  2000 106         		call	EP0Transfer
000209  2  0040             		ret
00020A  2                   
00020A  2                   	HidGetProtocol:
00020A  2  0140             		clrw				;Echo DATA
00020B  2  1400 25,3        		btfsc	gbHidProtocol
00020C  2  0800 4d          		movfw	gHidProtocolVal
00020D  2  1E00 50          		movwr	Tx0Fifo0
00020E  2                   
00020E  2  1900 1           		movlw	1h
00020F  2  2000 106         		call	EP0Transfer
000210  2  0040             		ret
000211  2                   ;==============================================================================
000211  2                   RequestVendor:
000211  2  3000 225         		goto	SetupCmdErr
000212  2                   ;==============================================================================
000212  2                   RequestStandard:
000212  2  1F00 41          		movrw	BRequest
000213  2  1C00 f4          		addlw	(256-(SETUP_TBL_END-SETUP_TBL_BEGIN))
000214  2  1400 3,0         		btfsc	Carry
000215  2  3000 225                	 	goto	SetupCmdErr
000216  2                   
000216  2  1F00 41          		movrw	BRequest
000217  2  0700 2,1         		addwf	Pcl,F
000218  2                   	SETUP_TBL_BEGIN:
000218  2  3000 3b1         		goto	GetStatusTask		;(00h)
000219  2  3000 34f         		goto	ClearFeatureTask	;(01h)
00021A  2  3000 225         		goto	SetupCmdErr
00021B  2  3000 386         		goto	SetFeatureTask		;(03h)
00021C  2  3000 225         		goto	SetupCmdErr
00021D  2  3000 319         		goto	SetAddressTask		;(05h)
00021E  2  3000 2a2         		goto	GetDescriptorTask	;(06h)
00021F  2  3000 225         		goto	SetupCmdErr
000220  2  3000 31e         		goto	GetConfigurationTask	;(08h)
000221  2  3000 327         		goto	SetConfigurationTask	;(09h)
000222  2  3000 3f8           		goto	GetInterfaceTask	;(0ah)
000223  2  3000 401         		goto	SetInterfaceTask	;(0bh)
000224  2                   	SETUP_TBL_END:
000224  2  0000             		nop
000225  2                   
000225  2                   SetupCmdErr:
000225  2  1200 14,5        		bsf	Ep0Stall
000226  2  0040             		ret
000227  2                   
000227  2                   
000227  2                   ;==============================================================================
000227  2                   Ep0OutTask:
000227  2  1000 21,6        		bcf	gbOut0Flag
000228  2  1600 24,0        		btfss	DataOutFlag
000229  2  3000 233         		goto	$+10
00022A  2  1400 2d,7        		btfsc	SendFlag
00022B  2  3000 232         		goto	$+7
00022C  2  0A00 38,1        		incf	TEMP1,F
00022D  2  1900 3           		movlw	03h
00022E  2  0600 38,0        		xorwf	TEMP1,W
00022F  2  1400 3,2         		btfsc	Zero
000230  2  1200 2d,7        		bsf	SendFlag
000231  2  3000 233         		goto	$+2
000232  2  2000 25b         		call	DataOutTask
000233  2  2000 10f         		call	NoDataControl
000234  2  2000 236         		call	Commandcheck
000235  2  0040             		ret
000236  2                   		
000236  2                   Commandcheck:		
000236  2  1F00 48          		movrw	48h
000237  2  1D00 a           		xorlw	0ah
000238  2  1600 3,2         		btfss	Zero
000239  2  0040             		ret
00023A  2  1F00 49          		movrw	49h
00023B  2  1D00 b           		xorlw	0bh
00023C  2  1600 3,2         		btfss	Zero
00023D  2  0040             		ret
00023E  2  1F00 4a          		movrw	4ah
00023F  2  1D00 c           		xorlw	0ch
000240  2  1600 3,2         		btfss	Zero
000241  2  0040             		ret
000242  2  1F00 4b          		movrw	4bh
000243  2  1D00 d           		xorlw	0dh
000244  2  1600 3,2         		btfss	Zero
000245  2  0040             		ret
000246  2                   		
000246  2                   ;		movlw	00h
000246  2                   ;		movwf	ReportDataLength
000246  2                   ;		movlw	01h
000246  2                   ;		btfsc	E2PROM512Flag
000246  2                   ;		movlw	02h
000246  2                   ;		movwf	ReportDataLengthH			;re-check your EPROM size
000246  2                   		
000246  2                   ;		clrf	W_I2C_Address
000246  2                   ;		clrf	W_I2C_AddressH	
000246  2  0180 49                  clrf	R_I2C_Address
000247  2  0180 6e            		clrf    ReadI2CAddressH
000248  2                   InputValueTest:
000248  2  1F00 4e          		movrw	4eh		
000249  2  1D00 3           		xorlw	03h
00024A  2  1400 3,2         		btfsc	Zero
00024B  2  1200 2e,2        		bsf	AskROMSizeFlag		;AP wants to ask EPROM size
00024C  2  1400 2e,2        		btfsc	AskROMSizeFlag
00024D  2  0040             		ret;goto	$+6
00024E  2                   
00024E  2  1F00 4e          		movrw	4eh
00024F  2  1D00 1           		xorlw	01h;InputValue
000250  2  1600 3,2         		btfss	Zero
000251  2  3000 254         		goto	OutputValueTest
000252  2  1200 2e,0        		bsf	CMDInFlag
000253  2  0040                     ret
000254  2                     OutputValueTest:
000254  2  1F00 4e          		movrw	4eh
000255  2  1D00 2           		xorlw	02h;OutputValue
000256  2  1600 3,2         		btfss	Zero
000257  2  0040             		ret
000258  2  0000             		nop
000259  2  1200 24,0        		bsf	DataOutFlag
00025A  2  0040             		ret
00025B  2                   		
00025B  2                   
00025B  2                   DataOutTask:
00025B  2  1600 24,0        		btfss	DataOutFlag
00025C  2  0040             		ret
00025D  2                   
00025D  2                   ;  		testz	ReportDataLength
00025D  2                   ;  		btfss	Zero
00025D  2                   ;  		goto	DataInFlash
00025D  2                   ;  		testz	ReportDataLengthH
00025D  2                   ;  		btfsc	Zero
00025D  2                   ;  		goto	EndReceiveData
00025D  2                   ;  DataInFlash:
00025D  2                   ;  		bcf		Out0i			;disable RC0 interrupt enable
00025D  2                   ;  		bcf		Tx0i
00025D  2                   ;  		btfsc   E2PROM512Flag
00025D  2                   ;  		goto    $+3
00025D  2                   ;  		call	I2C_Send_Nbyte 
00025D  2                   ;  		goto    $+2
00025D  2                   ;  		call	I2C_Send_Nbyte_E2PROM512
00025D  2                   ;  		call	Delay5ms
00025D  2                   ;		call	Delay5ms
00025D  2                   ;		call	Delay5ms
00025D  2                   ;		call	Delay5ms
00025D  2                   		
00025D  2                   ;  		movlw	08h
00025D  2                   ;		addwf	W_I2C_Address,F  
00025D  2                   ;		btfsc	Carry
00025D  2                   ;		incf    W_I2C_AddressH,F  
00025D  2                   		
00025D  2                   		;call	Delay5ms
00025D  2                   		;call	Delay5ms
00025D  2                   ;		bsf	Tx0i
00025D  2                   ;		bsf	Out0i
00025D  2                   ;		movlw	08h
00025D  2                   ;		subwf	ReportDataLength,F
00025D  2                   ;		btfss	Carry
00025D  2                   ;		decf	ReportDataLengthH,F
00025D  2                   ;		testz	ReportDataLength
00025D  2                   ;		btfss	Zero
00025D  2                   ;		ret
00025D  2                   ;		testz	ReportDataLengthH
00025D  2                   ;		btfsc	Zero
00025D  2                   ;		goto	EndReceiveData
00025D  2                   ;		ret
00025D  2                   
00025D  2                   
00025D  2                      EndReceiveData:
00025D  2  1000 24,0          		bcf	DataOutFlag
00025E  2  0180 38            		clrf	TEMP1
00025F  2  1000 2d,7          		bcf	SendFlag
000260  2  0040               		ret
000261  2                   		
000261  2                   ;Senddata2host:		
000261  2                   ;		call	DataInTask
000261  2                   ;		call    CheckLength0
000261  2                   ;DataTransfer:
000261  2                   ;		movlw	40h					;toggle
000261  2                   ;		xorwf	Tx0Reg,F
000261  2                   ;		movlw	08h					;length=8
000261  2                   ;		iorwf	Tx0Reg,F
000261  2                   ;  		bsf	Tx0Rdy
000261  2                   ;		bsf	Rc0Rdy
000261  2                   ;		ret
000261  2                   		
000261  2                   		
000261  2                   ;CheckLength0:
000261  2                   ;  		testz	ReportDataLength
000261  2                   ;		btfss	Zero
000261  2                   ;  		ret
000261  2                   ;  		testz	ReportDataLengthH
000261  2                   ;  		btfss	Zero
000261  2                   ;  		ret
000261  2                   
000261  2                   ;DataInTask:
000261  2                   ;		btfsc	Tx0Rdy
000261  2                   ;		ret
000261  2                       	
000261  2                   ;  		clrf	TEMP1;AnyCountTemp
000261  2                   ;  		clrf	TEMP2
000261  2                   		
000261  2                   ;  		testz	ReportDataLength
000261  2                   ;  		btfss	Zero
000261  2                   ;  		goto	SaveData
000261  2                   ;  		testz	ReportDataLengthH
000261  2                   ;  		btfss	Zero
000261  2                   ;  		goto	SaveData
000261  2                   ; 		bsf	Tx0i
000261  2                   ;        ret
000261  2                           
000261  2                   ;SaveData:		
000261  2                   ;		bcf	Tx0i
000261  2                   ;		call	Delay5ms 		  		  		  		
000261  2                     		
000261  2                   ;        movlw	10h
000261  2                   ;        xorwf	R_I2C_Address,0 
000261  2                   ;        btfsc	Zero
000261  2                   ;        nop
000261  2                   ;  		call	I2C_Receive_Nbyte8			;read data from EPROM(AP)
000261  2                   		
000261  2                   ;		movlw	08h
000261  2                   ;		addwf	R_I2C_Address,F
000261  2                   ;		btfsc	Carry
000261  2                   ;		incf    ReadI2CAddressH,F
000261  2                   
000261  2                   ;		movlw	08h
000261  2                   ;		xorwf	R_I2C_Address,W
000261  2                   ;		btfss	Zero
000261  2                   ;		goto	$+3
000261  2                   ;		bcf		CMDInFlag
000261  2                   ;		bsf		SecondCMDInFlag
000261  2                   
000261  2                   ;   SaveInData:
000261  2                   ;  		movlw	40h
000261  2                   ;  		movwf	Fsr
000261  2                   
000261  2                   ;  		movfw	TEMP1;AnyCountTemp
000261  2                   ;  		addwf	Fsr,F
000261  2                   ;		bsf	RamBank
000261  2                   ;		movfw	Indf
000261  2                   ;		bcf	RamBank
000261  2                   ;        movwf	TEMP2;UsbDataTemp
000261  2                   
000261  2                   ;  		movlw	50h
000261  2                   ;     		movwf	Rsr
000261  2                   ;     		movfw	TEMP1;AnyCountTemp
000261  2                   ;     		addwf	Rsr,F
000261  2                   ;     		movfw	TEMP2;UsbDataTemp
000261  2                   ;           		movwr	Indf
000261  2                   				
000261  2                   ;      		incf	TEMP1,F;AnyCountTemp,F
000261  2                   ;  		movlw	08h
000261  2                   ;  		xorwf	TEMP1,W;AnyCountTemp,W
000261  2                   ;  		btfss	Zero
000261  2                   ;  		goto	SaveInData
000261  2                   
000261  2                   ;		movlw	08h
000261  2                   ;		subwf	ReportDataLength,F
000261  2                   ;		btfss	Carry
000261  2                   ;		decf	ReportDataLengthH,F
000261  2                   ;		testz	ReportDataLength
000261  2                   ;		btfss	Zero
000261  2                   ;		ret
000261  2                   ;		testz	ReportDataLengthH
000261  2                   ;		btfsc	Zero
000261  2                   ;		goto	EndSaveData
000261  2                   ;		ret
000261  2                   ;;SendE2PROMSize:
000261  2                   ;		;bcf		AskROMSizeFlag
000261  2                   ;		;btfss	E2PROMFlag
000261  2                   ;		;ret
000261  2                   		
000261  2                   ;		;movlw	55h
000261  2                   ; 		;movwr	Tx0Fifo0
000261  2                   ;		;movlw	01h
000261  2                   ;		;btfsc	E2PROM512Flag
000261  2                   ;		;movlw	02h
000261  2                   ;		;movwr	Tx0Fifo1
000261  2                   ;		;movlw	00h
000261  2                   ; 		;movwr	Tx0Fifo2
000261  2                   ;		;movlw	00h
000261  2                   ; 		;movwr	Tx0Fifo3
000261  2                   ;		;movlw	00h
000261  2                   ; 		;movwr	Tx0Fifo4
000261  2                   ;		;movlw	00h
000261  2                   ; 		;movwr	Tx0Fifo5
000261  2                   ;		;movlw	00h
000261  2                   ; 		;movwr	Tx0Fifo6
000261  2                   ;		;movlw	00h
000261  2                   ; 		;movwr	Tx0Fifo7
000261  2                   		
000261  2                   ;EndSaveData:	
000261  2                   ;		bcf	SecondCMDInFlag;CMDInFlag
000261  2                   ;		bsf	Tx0i
000261  2                   ;		ret
000261  2                   ;==============================================================================
000261  2                   Tx0Task:
000261  2  1000 21,5        		bcf	gbTx0Flag
000262  2                   ;		btfsc	SecondCMDInFlag;CMDInFlag
000262  2                   ;		goto	Senddata2host;ret;
000262  2                     	;---------Check and set New Address----------
000262  2                     	;IMPORTANT : It's here because we have to send NULL to Host by Addr0.
000262  2  1600 23,1        		btfss	gbNewAddrFlag
000263  2  3000 268         		goto	Tx0TransCheck
000264  2                   
000264  2  1F00 42          		movrw	WValue
000265  2  1A00 80          		iorlw	BIT7			;EN_USB bit
000266  2  0080 10          		movwf	UsbAddrReg
000267  2  1000 23,1        		bcf	gbNewAddrFlag
000268  2                   	;-------- Transfer Next Packet --------------
000268  2                   	Tx0TransCheck:
000268  2  0880 40            		testz	gWLengthTemp
000269  2  1600 3,2         		btfss	Zero
00026A  2  3000 26d         		goto	NormalTrans		;Len>0;Send DATA
00026B  2  2000 10f         		call	NoDataControl		;Len=0;Send NULL + WaitNextCommand
00026C  2  0040             		ret
00026D  2                   
00026D  2                   	NormalTrans:
00026D  2  2000 289         		call	Tx0Transfer		;Prepare DATA to transfer
00026E  2  1200 13,0        		bsf	Rc0Rdy			;Transfer
00026F  2  0040             		ret
000270  2                   
000270  2                   ;==============================================================================
000270  2                   RsmTask:
000270  2  1000 22,3        		bcf	gbRsmFlag
000271  2  0040             		ret
000272  2                   ;==============================================================================
000272  2                   Tx3Task:
000272  2  1000 21,1        		bcf	gbTx3Flag
000273  2                   		;btfsc	DataInFlag
000273  2                   		;call	ReadData
000273  2  0040             		ret
000274  2                   ;==============================================================================
000274  2                   Rc4Task:
000274  2  1000 21,0        		bcf	gbRc4Flag
000275  2                   		;XRAM1CPU_XRAM2CPU
000275  2                   		;btfsc	DataOutFlag
000275  2                   		;goto	$+3
000275  2                   		;call	CommandTask
000275  2                   		;goto	$+3
000275  2                   		;clrf	TEMP2
000275  2                   		;call	I2C_Send_Nbyte
000275  2                   		;XRAM1CPU_XRAM2USB
000275  2  1200 18,7        		bsf	Rc4Rdy
000276  2  0040             		ret
000277  2                   ;==============================================================================
000277  2                   CommandTask:
000277  2                   		;movrw	Xram20
000277  2                   		;xorlw	55h
000277  2                   		;btfss	Zero
000277  2                   		;ret
000277  2                   		;movrw	Xram21
000277  2                   		;xorlw	53h
000277  2                   		;btfss	Zero
000277  2                   		;ret
000277  2                   		;movrw	Xram22
000277  2                   		;xorlw	42h
000277  2                   		;btfss	Zero
000277  2                   		;ret
000277  2                   		;movrw	Xram23
000277  2                   		;xorlw	43h
000277  2                   		;btfss	Zero
000277  2                   		;ret
000277  2                   		;movrw	Xram27
000277  2                   		;xorlw	F3h
000277  2                   		;btfsc	Zero
000277  2                   		;goto	ReadPro
000277  2                   		;movrw	Xram27
000277  2                   		;xorlw	F4h
000277  2                   		;btfsc	Zero
000277  2                   		;goto	WritePro
000277  2                   		;movrw	Xram27
000277  2                   		;xorlw	F1h
000277  2                   		;btfss	Zero
000277  2                   		;ret
000277  2                   		;clrf	R_I2C_Address1
000277  2                   		;clrf	W_I2C_Address
000277  2                   	CheckDevice:
000277  2                   		;XRAM1CPU_XRAM2CPU
000277  2                   		;movlw	74h
000277  2                   		;movwr	Xram20
000277  2                   		;movlw	65h
000277  2                   		;movwr	Xram21
000277  2                   		;movlw	6eh
000277  2                   		;movwr	Xram22
000277  2                   		;movlw	78h
000277  2                   		;movwr	Xram23
000277  2                   		;movlw	64h
000277  2                   		;movwr	Xram24
000277  2                   		;movlw	73h
000277  2                   		;movwr	Xram25
000277  2                   		;movlw	6bh
000277  2                   		;movwr	Xram26
000277  2                   		;movlw	00h
000277  2                   		;movwr	Xram27
000277  2                   		;XRAM1CPU_XRAM2USB
000277  2                   		;call	EP3Transfer
000277  2                   		;ret
000277  2                   	WritePro:
000277  2                   		;bsf	DataOutFlag
000277  2                   		;ret
000277  2                   	ReadPro:
000277  2                   		;bsf	DataInFlag
000277  2                   	   ReadData:
000277  2                   	   	;XRAM1CPU_XRAM2CPU
000277  2                   		;call	I2C_Receive_Nbyte8
000277  2                   		;XRAM1CPU_XRAM2USB
000277  2                   		;movlw	40h
000277  2                   		;addwf	R_I2C_Address1,F
000277  2                   		;testz	R_I2C_Address1
000277  2                   		;btfsc	Zero
000277  2                   		;bcf	DataInFlag
000277  2                   		;call	EP3Transfer
000277  2                   		;ret
000277  2                   
000277  2                   ;==============================================================================
000277  2                   CheckLength:
000277  2  0800 43          		movfw	gDatalength		;if WLengthHi > 0
000278  2  0080 40          		movwf	gWLengthTemp		;[gWLengthTemp]=gDataLength
000279  2  1F00 47          		movrw	WLengthHi
00027A  2  1D00 0           		xorlw	0
00027B  2  1600 3,2         		btfss	Zero
00027C  2  0040             		ret
00027D  2                   
00027D  2                   CheckLenTask:
00027D  2  1000 3,0         		bcf	Carry
00027E  2  1F00 46          		movrw	WLength			;W = WLength - gDataLength
00027F  2  0080 31          		movwf	gTempVar1		;if(WLength >= gDataLength)
000280  2  0800 43          		movfw	gDatalength	 	;[gWLengthTemp]=gDataLength
000281  2  0200 31,0        		subwf	gTempVar1,W
000282  2  1400 3,0         		btfsc	Carry
000283  2  0040             		ret
000284  2  1400 25,6        		btfsc	VerTestDoneFlag
000285  2  0040             		ret
000286  2  1F00 46          		movrw	WLength			;if(WLength < gDataLength)
000287  2  0080 40          		movwf	gWLengthTemp		;[gWLengthTemp]=WLength
000288  2  0040             		ret
000289  2                   
000289  2                   
000289  2                   ;==============================================================================
000289  2                   Tx0Transfer:
000289  2  0180 41          		clrf	gLengthCnt		;reset the count of send , gLengthCnt=0
00028A  2  0880 40          		testz	gWLengthTemp
00028B  2  1400 3,2         		btfsc	Zero
00028C  2  3000 29f         		goto	SetTgl
00028D  2                   
00028D  2                   	;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
00028D  2  1900 50          		movlw	Tx0Fifo0
00028E  2  0080 5           		movwf	Rsr
00028F  2  1900 8           		movlw	8
000290  2  0080 31          		movwf	gTempVar1
000291  2                   
000291  2                   	Tx0ByteLoop:
000291  2                   	;-------- Byte n -------
000291  2                   		;btfss	gfUSEinitGetDescriptor		;first time Emuration flag for mac_ver judgement
000291  2                   		;goto	GetStringCase
000291  2                   		;movlw	08h
000291  2                   		;subwf	gTableCnt,W
000291  2                   		;btfss	Carry
000291  2                   		;goto	GetStringCase
000291  2                   		;movlw	0ch
000291  2                   		;subwf	gTableCnt,W
000291  2                   		;btfsc	Carry
000291  2                   		;goto	GetStringCase
000291  2                   		;movlw	ReadBuffer-8	;get VID/PID from last page
000291  2                        		;movwf	Fsr
000291  2                        		;movfw	gTableCnt
000291  2                        		;addwf	Fsr,F
000291  2                        		;bsf	RamBank
000291  2                        		;movfw	Indf
000291  2                        		;bcf	RamBank
000291  2                   		;goto	Tx0BufferWrite
000291  2                   	;GetStringCase:
000291  2                   		;btfsc	gfGetString1
000291  2                   		;goto	$+3
000291  2                   		;btfss	gfGetString2
000291  2                   		;goto	NoE2p
000291  2                   		;movlw	ReadBuffer		;get string descriptor from last page
000291  2                   		;movwf	Fsr
000291  2                        		;movfw	gTableCnt
000291  2                        		;addwf	Fsr,F
000291  2                        		;bsf	RamBank
000291  2                        		;movfw	Indf
000291  2                        		;bcf	RamBank
000291  2                        		;goto	Tx0BufferWrite
000291  2                   	NoE2p:
000291  2  0800 42          		movfw	gTableCnt
000292  2  2000 c00         		call	DeviceDescTable
000293  2                   	Tx0BufferWrite:
000293  2  1E00 0           		movwr	Indf
000294  2  0A00 42,1        		incf	gTableCnt,F		;increase index
000295  2  0A00 41,1        		incf	gLengthCnt,F		;increase count of send			;gLengthCnt=1
000296  2  0300 40,1        		decf	gWLengthTemp,F
000297  2  0A00 5,1         		incf	Rsr,F
000298  2                   
000298  2  0300 31,1        		decf	gTempVar1,F
000299  2  1400 3,2         		btfsc	Zero
00029A  2  3000 29f         		goto	SetTgl
00029B  2                   	;--- end? ----
00029B  2  0880 40          		testz	gWLengthTemp
00029C  2  1600 3,2         		btfss	Zero
00029D  2  3000 291         		goto	Tx0ByteLoop
00029E  2  1000 2b,3        		bcf	gfUSEinitGetDescriptor
00029F  2                   		;bcf	gfGetString1
00029F  2                   		;bcf	gfGetString2
00029F  2                   	SetTgl:
00029F  2  0800 41          		movfw	gLengthCnt
0002A0  2  2000 106         	    	call	EP0Transfer
0002A1  2                   
0002A1  2  0040             		ret
0002A2  2                   
0002A2  2                   ;==============================================================================
0002A2  2                   GetDescriptorTask:
0002A2  2  1F00 40          		movrw	BmRequestType
0002A3  2  1D00 80            		xorlw	DeviceToHost		;80
0002A4  2  1400 3,2           		btfsc	Zero
0002A5  2  3000 2ae           		goto	GetDescriptorType
0002A6  2                   
0002A6  2  1F00 40            		movrw	BmRequestType
0002A7  2  1D00 81            		xorlw	InterfaceToHost	   	;81
0002A8  2  1400 3,2           		btfsc	Zero
0002A9  2  3000 2ae           		goto	GetDescriptorType
0002AA  2                   
0002AA  2  1F00 40          		movrw	BmRequestType
0002AB  2  1D00 82            		xorlw	EndpointToHost		;82
0002AC  2  1600 3,2           		btfss	Zero
0002AD  2                   
0002AD  2  3000 225           		goto	SetupCmdErr
0002AE  2                   
0002AE  2                   	GetDescriptorType:
0002AE  2  1F00 43            		movrw	WValueHi
0002AF  2  1D00 1             		xorlw	Device			;01h
0002B0  2  1400 3,2           		btfsc	Zero
0002B1  2  3000 2c3           		goto	DeviceType		;get decice descriptor
0002B2  2                   
0002B2  2  1F00 43            		movrw	WValueHi
0002B3  2  1D00 2             		xorlw	Configuration		;02h
0002B4  2  1400 3,2           		btfsc	Zero
0002B5  2  3000 2dd           		goto	ConfigurationType	;get config descriptor
0002B6  2                   
0002B6  2  1F00 43            		movrw	WValueHi
0002B7  2  1D00 3           		xorlw	String			;03h
0002B8  2  1400 3,2           		btfsc	Zero
0002B9  2  3000 2e2          		goto	StringType		;get string descriptor
0002BA  2                   
0002BA  2                   
0002BA  2  1F00 43            		movrw	WValueHi
0002BB  2  1D00 21          		xorlw	HidClass		;21h
0002BC  2  1400 3,2           		btfsc	Zero
0002BD  2  3000 300          		goto	HidClassType		;get string descriptor
0002BE  2                   
0002BE  2  1F00 43            		movrw	WValueHi
0002BF  2  1D00 22          		xorlw	HidReport		;22h
0002C0  2  1400 3,2           		btfsc	Zero
0002C1  2  3000 30a          		goto	HidReportType		;get string descriptor
0002C2  2                   
0002C2  2                   
0002C2  2  3000 225           		goto	SetupCmdErr		;others, set Ep0 Stall
0002C3  2                   ;-----------------------
0002C3  2                   	DeviceType:				; init xchange MASK byte
0002C3  2                   	;	btfss	GetInfoFlag
0002C3  2                   	;	call	GetDeviceInfo
0002C3  2  1000 24,4        		bcf	Check_Flag
0002C4  2  1000 24,5        	 	bcf	JudgeSendFlag
0002C5  2  1200 2c,3        		bsf	USB30TestFlag
0002C6  2                   		
0002C6  2  1400 2c,2        		btfsc	USB30TrueFlag
0002C7  2  3000 2d1         		goto	$+10
0002C8  2  1F00 46          		movrw	WLength
0002C9  2  1D00 40              		xorlw	40h
0002CA  2  1400 3,2             		btfsc	Zero
0002CB  2  1200 24,2            		bsf	OSType
0002CC  2  1F00 46              		movrw	WLength
0002CD  2  1D00 8               		xorlw	08h
0002CE  2  1400 3,2             		btfsc	Zero
0002CF  2  1000 24,2            		bcf	OSType
0002D0  2  3000 2d2         		goto	$+2
0002D1  2  1200 24,2        		bsf	OSType
0002D2  2                   		
0002D2  2                   		
0002D2  2                   		;////Save initial device descript length
0002D2  2  1F00 46              	movrw	WLength					;
0002D3  2  1D00 8               	xorlw	08h
0002D4  2  1400 3,2             	btfsc	Zero			
0002D5  2  1200 2f,0        		bsf GetDeviceDspt08Byte
0002D6  2                   		
0002D6  2  1400 2f,0        		btfsc GetDeviceDspt08Byte		;specific MAC PC will re-get device descriptior
0002D7  2  1000 24,2        		bcf OSType
0002D8  2                   		
0002D8  2                   		
0002D8  2  1200 2b,3        		bsf	gfUSEinitGetDescriptor
0002D9  2  0180 42          		clrf	gTableCnt
0002DA  2  1900 12          		movlw	DeviceLen
0002DB  2  0080 43          		movwf	gDatalength
0002DC  2  3000 315         		goto	GetDescriptorTaskSend
0002DD  2                   ;-----------------------
0002DD  2                   	ConfigurationType:
0002DD  2  1900 12          		movlw	ConfigIndex		;Config start rom offset
0002DE  2  0080 42          		movwf	gTableCnt
0002DF  2  1900 22          		movlw	ConfigLen
0002E0  2  0080 43          		movwf	gDatalength
0002E1  2  3000 315         		goto	GetDescriptorTaskSend
0002E2  2                   ;-----------------------
0002E2  2                   	StringType:
0002E2  2  1F00 42            		movrw	WValue
0002E3  2  1D00 0             		xorlw	String0
0002E4  2  1400 3,2         		btfsc	Zero
0002E5  2  3000 2ef         		goto	SendString0
0002E6  2                   
0002E6  2  1F00 42          		movrw	WValue
0002E7  2  1D00 1             		xorlw	String1
0002E8  2  1400 3,2         		btfsc	Zero
0002E9  2  3000 2f4         		goto	SendString1
0002EA  2                   
0002EA  2  1F00 42          		movrw	WValue
0002EB  2  1D00 2             		xorlw	String2
0002EC  2  1400 3,2         		btfsc	Zero
0002ED  2  3000 2fa         		goto	SendString2
0002EE  2                   
0002EE  2                   		;bsf	NewOSFlag
0002EE  2  3000 225         		goto	SetupCmdErr
0002EF  2                   
0002EF  2                   	SendString0:
0002EF  2                   		;incf	getstring0counter,F
0002EF  2  1900 34          	  	movlw	String0Index
0002F0  2  0080 42          	  	movwf	gTableCnt
0002F1  2  1900 4           		movlw	String0Len
0002F2  2  0080 43          		movwf	gDatalength
0002F3  2  3000 315         		goto	GetDescriptorTaskSend
0002F4  2                   
0002F4  2                   	SendString1:
0002F4  2  0A00 3f,1        		incf	getstring1counter,F
0002F5  2                   
0002F5  2                   			
0002F5  2                   		;call	GetDeviceInfo
0002F5  2                   		;movlw	03h
0002F5  2                   		;bsf	RamBank
0002F5  2                   		;xorwf	ReadBuffer5,W
0002F5  2                   		;bcf	RamBank
0002F5  2                   		;btfss	Zero
0002F5  2                   		;goto	$+6
0002F5  2                   		;bsf	RamBank
0002F5  2                   		;movfw	ReadBuffer4
0002F5  2                   		;bcf	RamBank
0002F5  2                   		;movwf	TempReg
0002F5  2                   		;bsf	gfGetString1
0002F5  2  1900 38          	  	movlw	String1Index
0002F6  2                   	  	;btfsc	gfGetString1
0002F6  2                   		;movlw	04h
0002F6  2  0080 42          	  	movwf	gTableCnt
0002F7  2  1900 a           		movlw	String1Len
0002F8  2                   		;btfsc	gfGetString1
0002F8  2                   		;movfw	TempReg
0002F8  2  0080 43          		movwf	gDatalength
0002F9  2  3000 315         		goto	GetDescriptorTaskSend
0002FA  2                   
0002FA  2                   	SendString2:
0002FA  2  0A00 3d,1        		incf	getstring2counter,F
0002FB  2                   			;movlw	02h
0002FB  2                   			;xorwf	getstring2counter,W
0002FB  2                   			;btfsc	Zero
0002FB  2                   			;bsf	FrescoChipFlag
0002FB  2                   			
0002FB  2                   		;movlw	03h
0002FB  2                   		;bsf	RamBank
0002FB  2                   		;xorwf	ReadBuffer23,W
0002FB  2                   		;bcf	RamBank
0002FB  2                   		;btfss	Zero
0002FB  2                   		;goto	$+6
0002FB  2                   		;bsf	RamBank
0002FB  2                   		;movfw	ReadBuffer22
0002FB  2                   		;bcf	RamBank
0002FB  2                   		;movwf	TempReg
0002FB  2                   		;bsf	gfGetString2
0002FB  2  1900 42          	  	movlw	String2Index
0002FC  2                   	  	;btfsc	gfGetString2
0002FC  2                   		;movlw	22d
0002FC  2  0080 42          	  	movwf	gTableCnt			;table content
0002FD  2  1900 1c          		movlw	String2Len
0002FE  2                   		;btfsc	gfGetString2
0002FE  2                   		;movfw	TempReg
0002FE  2  0080 43          		movwf	gDatalength
0002FF  2  3000 315         		goto	GetDescriptorTaskSend
000300  2                   
000300  2                   ;-----------------------
000300  2                   	HidClassType:
000300  2  1F00 42          		movrw	WValue
000301  2  1D00 0             		xorlw	00h
000302  2  1400 3,2         		btfsc	Zero
000303  2  3000 305         		goto	HidClass1
000304  2                   
000304  2                   ;		movrw	WValue
000304  2                   ;  		xorlw	01h
000304  2                   ;		btfsc	Zero
000304  2                   ;		goto	HidClass2
000304  2  3000 225         		goto	SetupCmdErr
000305  2                   	HidClass1:	
000305  2  1900 24          		movlw	HidClass1Index
000306  2  0080 42          		movwf	gTableCnt
000307  2  1900 9           		movlw	HidClassLen
000308  2  0080 43          		movwf	gDatalength
000309  2  3000 315         		goto	GetDescriptorTaskSend
00030A  2                   
00030A  2                   	HidClass2:	
00030A  2                   ;		movlw	HidClass2Index
00030A  2                   ;		movwf	gTableCnt
00030A  2                   ;		movlw	HidClassLen
00030A  2                   ;		movwf	gDatalength
00030A  2                   ;		goto	GetDescriptorTaskSend
00030A  2                   
00030A  2                   ;-----------------------
00030A  2                   	HidReportType:
00030A  2  0A00 7f,1        		incf	Getreportcount,F
00030B  2  1F00 44          		movrw	WIndex
00030C  2  1D00 0             		xorlw	00h
00030D  2  1400 3,2         		btfsc	Zero
00030E  2  3000 310         		goto	HidReport1
00030F  2                   		
00030F  2                   ;		movrw	WIndex
00030F  2                   ;  		xorlw	01h
00030F  2                   ;		btfsc	Zero
00030F  2                   ;		goto	HidReport2
00030F  2  3000 225         		goto	SetupCmdErr
000310  2                   	HidReport1:
000310  2  1900 5e          		movlw	HidReport1Index
000311  2  0080 42          		movwf	gTableCnt
000312  2  1900 62          		movlw	HidReport1Len
000313  2  0080 43          		movwf	gDatalength
000314  2                   		;btfsc	OSType
000314  2  3000 315         		goto	GetDescriptorTaskSend
000315  2                   	HidReport2:
000315  2                   ;		incf	Getreportcount,F
000315  2                   ;		movlw	HidReport2Index
000315  2                   ;		movwf	gTableCnt
000315  2                   ;		movlw	HidReport2Len
000315  2                   ;		movwf	gDatalength
000315  2                   ;		goto	GetDescriptorTaskSend
000315  2                   	
000315  2                   		;movlw	55h
000315  2                   		;xorwf	ResetFlag0,W
000315  2                   		;btfss	Zero
000315  2                   		;goto	JudgeMacOSVer
000315  2                   		;movlw	53h
000315  2                   		;xorwf	ResetFlag1,W
000315  2                   		;btfss	Zero
000315  2                   		;goto	JudgeMacOSVer
000315  2                   		;movlw	42h
000315  2                   		;xorwf	ResetFlag2,W
000315  2                   		;btfss	Zero
000315  2                   		;goto	JudgeMacOSVer
000315  2                   		;movlw	43h
000315  2                   		;xorwf	ResetFlag3,W
000315  2                   		;btfsc	Zero
000315  2                   		;goto	GetDescriptorTaskSend
000315  2                   	;JudgeMacOSVer:
000315  2                   		;movlw	02h
000315  2                   		;xorwf	GetReportCounter,W
000315  2                   		;btfsc	Zero
000315  2                   		;goto	SetMacVerFlags
000315  2                   		;movlw	01h
000315  2                   		;xorwf	GetReportCounter,W
000315  2                   		;btfss	Zero
000315  2                   		;goto	GetDescriptorTaskSend
000315  2                   		;movlw	63d
000315  2                   		;movwf	gDatalength
000315  2                   		;bsf	VerTestDoneFlag
000315  2                   		;goto	GetDescriptorTaskSend
000315  2                   	;SetMacVerFlags:
000315  2                   		;movlw	08h
000315  2                   		;subwf	TimerRollOver,W
000315  2                   		;btfss	Carry
000315  2                   		;goto	GetDescriptorTaskSend
000315  2                   		;movlw	54h
000315  2                   		;movwf	MacVerFlag0
000315  2                   		;movlw	45h
000315  2                   		;movwf	MacVerFlag1
000315  2                   		;movlw	4Eh
000315  2                   		;movwf	MacVerFlag2
000315  2                   		;movlw	58h
000315  2                   		;movwf	MacVerFlag3
000315  2                   	GetDescriptorTaskSend:
000315  2  2000 277         		call	CheckLength		;Decide What Size to send
000316  2  1000 25,6        		bcf	VerTestDoneFlag
000317  2  2000 289         		call	Tx0Transfer		;Prepare data and send it
000318  2                   		;btfsc	OSType
000318  2  0040             		ret
000319  2                   		;movlw	02h
000319  2                   		;xorwf	getstring2counter,W
000319  2                   		;btfss	Zero
000319  2                   		;ret
000319  2                   	
000319  2                   		;bsf	StartScanFlag
000319  2                   		;bsf	Check_Flag
000319  2                   	 	;bsf	JudgeSendFlag
000319  2                   	 	;clrf	TimerRollOver
000319  2                   	 	;movlw	60h			;08h
000319  2                   	 	;movwf	DelayCount
000319  2                   	 	;movlw	00h			;10h
000319  2                   	 	;movwf	DelayCountH
000319  2                   		;ret
000319  2                   
000319  2                   
000319  2                   ;==============================================================================
000319  2                   SetAddressTask:
000319  2  1200 23,1        		bsf	gbNewAddrFlag
00031A  2  1600 2c,3        		btfss	USB30TestFlag
00031B  2  1200 2c,2        		bsf	USB30TrueFlag			;if setAddress tack work before getDeviceDpt, do it.
00031C  2  2000 10f         		call	NoDataControl
00031D  2  0040             		ret
00031E  2                   
00031E  2                   ;==============================================================================
00031E  2                   GetConfigurationTask:
00031E  2  1F00 40          		movrw	BmRequestType
00031F  2  1D00 80          		xorlw	DeviceToHost
000320  2  1600 3,2           		btfss	Zero
000321  2  3000 225           		goto	SetupCmdErr
000322  2                   
000322  2  0800 45            		movfw	gConfigurationStatus	;config status
000323  2  1E00 50            		movwr	Tx0Fifo0
000324  2  1900 c1            		movlw	c1h			;TX0Rdy=1,TX0tgl=1,TX0cnt=1
000325  2  0080 14            		movwf	Tx0Reg
000326  2  0040             		ret
000327  2                   
000327  2                   ;==============================================================================
000327  2                   SetConfigurationTask:
000327  2  1F00 40          		movrw	BmRequestType
000328  2  1D00 0           		xorlw	0
000329  2  1600 3,2           		btfss	Zero
00032A  2  3000 225           		goto	SetupCmdErr
00032B  2                   
00032B  2                   	SetConfigurationType:
00032B  2  1F00 42          		movrw	WValue
00032C  2  1D00 0           		xorlw	0
00032D  2  1600 3,2           		btfss	Zero
00032E  2  3000 338           		goto	ConfigType		;1 is config
00032F  2                   	UnConfigType:  				;0 is unconfig
00032F  2  1F00 42          		movrw	WValue
000330  2  0080 45            		movwf	gConfigurationStatus	;gConfigurationStatus=0
000331  2  1900 e0            		movlw	EN_INT0_UNCONF
000332  2  1E00 11          		movwr	Int0IeReg
000333  2  1900 15          		movlw	EN_INT1_UNCONF
000334  2  1E00 12          		movwr	Int1IeReg
000335  2  1000 24,3        		bcf	StartScanFlag
000336  2  2000 10f            		call	NoDataControl
000337  2  0040             		ret
000338  2                   
000338  2                   	ConfigType:
000338  2  1F00 42             	  	movrw	WValue
000339  2  0080 45            		movwf	gConfigurationStatus
00033A  2                   
00033A  2  1900 7d            		movlw	7dh
00033B  2  0080 4c          		movwf	IdlePeriodStatus
00033C  2  0080 5b          		movwf	IdlePeriodTemp
00033D  2                   
00033D  2  1900 fc           		movlw	EN_INT0_NORMAL
00033E  2  1E00 11          		movwr	Int0IeReg
00033F  2  1900 15          		movlw	EN_INT1_NORMAL
000340  2  1E00 12          		movwr	Int1IeReg
000341  2                   
000341  2  1900 d0          		movlw	d0h
000342  2  0080 17          		movwf	Tx3Reg
000343  2                   
000343  2  1900 90          		movlw	90h
000344  2  0080 18          		movwf	Rc4Reg
000345  2                   
000345  2  1200 13,5        		bsf	Ep1Cfg
000346  2  1000 15,6        		bcf	Tx1Tgl
000347  2  1200 13,4        		bsf	Ep2Cfg
000348  2  1000 16,6        		bcf	Tx2Tgl
000349  2  1200 17,4        		bsf	Ep3Cfg
00034A  2  1200 18,4        		bsf	Ep4Cfg
00034B  2  1200 18,7        		bsf	Rc4Rdy
00034C  2                   
00034C  2                   	;	movlw	c8h
00034C  2                   	;	movwf	Tx1Reg
00034C  2                   	;	movlw	c4h
00034C  2                   	;	movwf	Tx2Reg
00034C  2                   
00034C  2  2000 10f         		call	NoDataControl
00034D  2  2000 47b         		call	CheckE2PROMSize
00034E  2  0040             		ret
00034F  2                   ;==============================================================================
00034F  2                   ClearFeatureTask:
00034F  2  1F00 40          		movrw	BmRequestType
000350  2  1D00 0           		xorlw	HostToDevice		;00h
000351  2  1400 3,2           		btfsc	Zero
000352  2  3000 37e           		goto	ClearRemoteWakeup
000353  2                   
000353  2  1F00 40          		movrw	BmRequestType
000354  2  1D00 2             		xorlw	HostToEndpoint		;02h
000355  2  1600 3,2           		btfss	Zero
000356  2  3000 225           		goto	SetupCmdErr
000357  2                   
000357  2                   	ClearEndpointStall:
000357  2  0880 45          		testz	gConfigurationStatus	;gConfigurationStatus = Config ?
000358  2  1400 3,2         		btfsc	Zero
000359  2  3000 225         		goto	SetupCmdErr
00035A  2                   
00035A  2                   	CheckClrEndpointStall:
00035A  2  1F00 44            		movrw	WIndex
00035B  2  1D00 80            		xorlw	Endpoint0
00035C  2  1400 3,2         		btfsc	Zero
00035D  2  3000 37b         		goto	ClrEp0Stall
00035E  2                   
00035E  2  1F00 44          		movrw	WIndex
00035F  2  1D00 81            		xorlw	Endpoint1
000360  2  1400 3,2         		btfsc	Zero
000361  2  3000 378         		goto	ClrEp1Stall
000362  2                   
000362  2  1F00 44          		movrw	WIndex
000363  2  1D00 82            		xorlw	Endpoint2
000364  2  1400 3,2         		btfsc	Zero
000365  2  3000 375         		goto	ClrEp2Stall
000366  2                   
000366  2  1F00 44          		movrw	WIndex
000367  2  1D00 83            		xorlw	Endpoint3
000368  2  1400 3,2         		btfsc	Zero
000369  2  3000 371         		goto	ClrEp3Stall
00036A  2                   
00036A  2  1F00 44          		movrw	WIndex
00036B  2  1D00 4             		xorlw	Endpoint4
00036C  2  1600 3,2         		btfss	Zero
00036D  2  3000 225         		goto	SetupCmdErr
00036E  2                   
00036E  2                   	ClrEp4Stall:
00036E  2  1000 17,5          		bcf	Ep3Stall
00036F  2  1000 18,5        		bcf	Ep4Stall		;clear Ep4 stall
000370  2                   
000370  2  3000 384         		goto	ClearFeatureTaskSend
000371  2                   	ClrEp3Stall:
000371  2                   
000371  2  1200 17,6        		bsf	Tx3Tgl			;Keep 1, let NEXT packet use DATA0.
000372  2  1000 18,5        	  	bcf	Ep4Stall
000373  2  1000 17,5        		bcf	Ep3Stall		;clear Ep3 Stall
000374  2                   
000374  2  3000 384         		goto	ClearFeatureTaskSend
000375  2                   	ClrEp2Stall:
000375  2  1000 16,5        		bcf	Ep2Stall		;clear Ep2 Stall
000376  2  1000 16,6        		bcf	Tx2Tgl			;clear Rc2 toggle bit
000377  2  3000 384         		goto	ClearFeatureTaskSend
000378  2                   	ClrEp1Stall:
000378  2  1000 15,5        	  	bcf	Ep1Stall		;clear Ep1 Stall
000379  2  1000 15,6        	  	bcf	Tx1Tgl			;clear Tx1 toggle bit
00037A  2  3000 384         		goto	ClearFeatureTaskSend
00037B  2                   	ClrEp0Stall:
00037B  2  1000 14,5        	  	bcf	Ep0Stall		;clear Ep0 Stall
00037C  2  1000 14,6        	  	bcf	Tx0Tgl			;clear Tx0 toggle bit
00037D  2  3000 384         		goto	ClearFeatureTaskSend
00037E  2                   	ClearRemoteWakeup:
00037E  2  1F00 42            		movrw	WValue
00037F  2  1D00 1           		xorlw	Device			;Feature Id=02h
000380  2  1600 3,2         		btfss	Zero
000381  2  3000 225         		goto	SetupCmdErr
000382  2  1900 0           		movlw	DisableRemoteWakeup
000383  2  0080 44          		movwf	gRemoteWakeupStatus
000384  2                   
000384  2                   	ClearFeatureTaskSend:
000384  2  2000 10f         		call	NoDataControl
000385  2  0040             		ret
000386  2                   ;==============================================================================
000386  2                   SetFeatureTask:
000386  2  1F00 40          		movrw	BmRequestType
000387  2  1D00 0           		xorlw	HostToDevice
000388  2  1400 3,2           		btfsc	Zero
000389  2  3000 3a9           		goto	SetRemoteWakeup
00038A  2                   
00038A  2  1F00 40          		movrw	BmRequestType
00038B  2  1D00 2             		xorlw	HostToEndpoint
00038C  2  1600 3,2           		btfss	Zero
00038D  2  3000 225           		goto	SetupCmdErr
00038E  2                   
00038E  2                   	SetEndpointStall:
00038E  2  0880 45          		testz	gConfigurationStatus	;gConfigurationStatus = Config ?
00038F  2  1400 3,2         		btfsc	Zero
000390  2  3000 225         		goto	SetupCmdErr
000391  2                   
000391  2                   	CheckSetEndpointStall:
000391  2  1F00 44            		movrw	WIndex
000392  2  1D00 81          		xorlw	Endpoint1
000393  2  1400 3,2         		btfsc	Zero
000394  2  3000 3a7         		goto	SetEp1Stall
000395  2                   
000395  2  1F00 44          		movrw	WIndex
000396  2  1D00 82          		xorlw	Endpoint2
000397  2  1400 3,2         		btfsc	Zero
000398  2  3000 3a5         		goto	SetEp2Stall
000399  2                   
000399  2  1F00 44          		movrw	WIndex
00039A  2  1D00 83          		xorlw	Endpoint3
00039B  2  1400 3,2         		btfsc	Zero
00039C  2  3000 3a3         		goto	SetEp3Stall
00039D  2                   
00039D  2  1F00 44          		movrw	WIndex
00039E  2  1D00 4           		xorlw	Endpoint4
00039F  2  1600 3,2         		btfss	Zero
0003A0  2  3000 225         		goto	SetupCmdErr
0003A1  2                   	SetEp4Stall:
0003A1  2  1200 18,5        		bsf	Ep4Stall
0003A2  2  3000 3af         		goto	SetFeatureTaskSend
0003A3  2                   
0003A3  2                   	SetEp3Stall:
0003A3  2  1200 17,5        		bsf	Ep3Stall
0003A4  2  3000 3af         		goto	SetFeatureTaskSend
0003A5  2                   
0003A5  2                   	SetEp2Stall:
0003A5  2  1200 16,5        		bsf	Ep2Stall
0003A6  2  3000 3af         		goto	SetFeatureTaskSend
0003A7  2                   
0003A7  2                   	SetEp1Stall:
0003A7  2  1200 15,5        		bsf	Ep1Stall
0003A8  2  3000 3af         		goto	SetFeatureTaskSend
0003A9  2                   
0003A9  2                   	SetRemoteWakeup:
0003A9  2  1F00 42            		movrw	WValue
0003AA  2  1D00 1           		xorlw	Device		;Feature Id=02h
0003AB  2  1600 3,2         		btfss	Zero
0003AC  2  3000 225         		goto	SetupCmdErr
0003AD  2  1900 2           		movlw	EnableRemoteWakeup
0003AE  2  0080 44          		movwf	gRemoteWakeupStatus
0003AF  2                   
0003AF  2                   	SetFeatureTaskSend:
0003AF  2  2000 10f         		call	NoDataControl
0003B0  2  0040             		ret
0003B1  2                   
0003B1  2                   
0003B1  2                   ;==============================================================================
0003B1  2                   GetStatusTask:
0003B1  2  1F00 40          		movrw	BmRequestType
0003B2  2  1D00 80          		xorlw	DeviceToHost
0003B3  2  1400 3,2           		btfsc	Zero
0003B4  2  3000 3ec           		goto	GetDeviceStatus
0003B5  2                   
0003B5  2  1F00 40          		movrw	BmRequestType
0003B6  2  1D00 81            		xorlw	InterfaceToHost
0003B7  2  1400 3,2           		btfsc	Zero
0003B8  2  3000 3f1         		goto	GetInterfaceStatus
0003B9  2                   
0003B9  2  1F00 40          		movrw	BmRequestType
0003BA  2  1D00 82          		xorlw	EndpointToHost
0003BB  2  1600 3,2           		btfss	Zero
0003BC  2  3000 225         		goto	SetupCmdErr
0003BD  2                   
0003BD  2                   	GetEndpointStatus:
0003BD  2  0880 45          		testz	gConfigurationStatus	;gConfigurationStatus = Config ?
0003BE  2  1400 3,2           		btfsc	Zero
0003BF  2  3000 225           		goto	SetupCmdErr
0003C0  2                   
0003C0  2  1F00 44          		movrw	WIndex
0003C1  2  1D00 80            		xorlw	Endpoint0	;00h
0003C2  2  1400 3,2           		btfsc	Zero
0003C3  2  3000 3d9           		goto	GetEp0Status
0003C4  2                   
0003C4  2  1F00 44          		movrw	WIndex
0003C5  2  1D00 81            		xorlw	Endpoint1	;01h
0003C6  2  1400 3,2           		btfsc	Zero
0003C7  2  3000 3dc           		goto	GetEp1Status
0003C8  2                   
0003C8  2  1F00 44          		movrw	WIndex
0003C9  2  1D00 82            		xorlw	Endpoint2
0003CA  2  1400 3,2           		btfsc	Zero
0003CB  2  3000 3e1           		goto	GetEp2Status
0003CC  2                   
0003CC  2  1F00 44          		movrw	WIndex
0003CD  2  1D00 83            		xorlw	Endpoint3	;01h
0003CE  2  1400 3,2           		btfsc	Zero
0003CF  2  3000 3e6           		goto	GetEp3Status
0003D0  2                   
0003D0  2  1F00 44            		movrw	WIndex
0003D1  2  1D00 4             		xorlw	Endpoint4
0003D2  2  1600 3,2           		btfss	Zero
0003D3  2  3000 225           		goto	SetupCmdErr
0003D4  2                   	GetEp4Status:
0003D4  2  1900 0             		movlw	00h
0003D5  2  1E00 50            		movwr	Tx0Fifo0	;clear stauts1
0003D6  2  1400 18,5          		btfsc	Ep4Stall
0003D7  2  1900 1           		movlw	01h
0003D8  2  3000 3ea           		goto	GetEndpointStatusEnd
0003D9  2                   
0003D9  2                   	GetEp0Status:
0003D9  2  1900 0             		movlw	00h
0003DA  2  1E00 51            		movwr	Tx0Fifo1
0003DB  2  3000 3ea           		goto	GetEndpointStatusEnd
0003DC  2                   
0003DC  2                   	GetEp1Status:
0003DC  2  1900 0             		movlw	00h
0003DD  2  1E00 51            		movwr	Tx0Fifo1	;clear stauts1
0003DE  2  1400 15,5          		btfsc	Ep1Stall
0003DF  2  1900 1           		movlw	01h		;if stall set status=1
0003E0  2  3000 3ea         		goto	GetEndpointStatusEnd
0003E1  2                   
0003E1  2                   	GetEp2Status:
0003E1  2  1900 0             		movlw	00h
0003E2  2  1E00 51            		movwr	Tx0Fifo1	;clear stauts1
0003E3  2  1400 16,5          		btfsc	Ep2Stall
0003E4  2  1900 1           		movlw	01h
0003E5  2  3000 3ea         		goto	GetEndpointStatusEnd
0003E6  2                   	GetEp3Status:
0003E6  2  1900 0              		movlw	00h
0003E7  2  1E00 51            		movwr	Tx0Fifo1	;clear stauts1
0003E8  2  1400 17,5          		btfsc	Ep3Stall
0003E9  2  1900 1           		movlw	01h
0003EA  2                   	GetEndpointStatusEnd:
0003EA  2  1E00 50          		movwr	Tx0Fifo0
0003EB  2  3000 3f5         		goto	GetStatusTaskSend
0003EC  2                   
0003EC  2                   	GetDeviceStatus:
0003EC  2  0800 44            		movfw	gRemoteWakeupStatus
0003ED  2  1E00 50            		movwr	Tx0Fifo0
0003EE  2  1900 0             		movlw	00h
0003EF  2  1E00 51            		movwr	Tx0Fifo1
0003F0  2  3000 3f5           		goto	GetStatusTaskSend
0003F1  2                   
0003F1  2                   	GetInterfaceStatus:
0003F1  2  0800 46            		movfw	gCurAlternate
0003F2  2  1E00 50            		movwr	Tx0Fifo0
0003F3  2  1900 0             		movlw   00h
0003F4  2  1E00 51            		movwr	Tx0Fifo1
0003F5  2                   
0003F5  2                   	GetStatusTaskSend:
0003F5  2  1900 c2            		movlw	c2h		;TX0rdy=1,TX0tgl=1,TX0cnt=2
0003F6  2  0080 14            		movwf	Tx0Reg
0003F7  2  0040             		ret
0003F8  2                   
0003F8  2                   ;==============================================================================
0003F8  2                   GetInterfaceTask:
0003F8  2  1F00 40          		movrw	BmRequestType
0003F9  2  1D00 81          		xorlw	InterfaceToHost
0003FA  2  1600 3,2           		btfss	Zero
0003FB  2  3000 225           		goto	SetupCmdErr
0003FC  2                   
0003FC  2                   	;GetInterface:
0003FC  2  0800 46             		movfw	gCurAlternate
0003FD  2  1E00 50             		movwr	Tx0Fifo0
0003FE  2  1900 c1             		movlw	c1h		;TX0rdy=1,TX0tgl=1,TX0cnt=1
0003FF  2  0080 14            		movwf	Tx0Reg
000400  2  0040             		ret
000401  2                   
000401  2                   ;==============================================================================
000401  2                   SetInterfaceTask:
000401  2  1F00 40          		movrw	BmRequestType
000402  2  1D00 1           		xorlw	HostToInterface	;(HostToDevice|Standard|Interface)
000403  2  1600 3,2           		btfss	Zero
000404  2  3000 225           		goto	SetupCmdErr
000405  2                   
000405  2  1F00 42             		movrw	WValue
000406  2  0080 46             		movwf   gCurAlternate   ;keep the gCurAlternate setting
000407  2                   
000407  2  1F00 44          		movrw	WIndex
000408  2  1D00 0             		xorlw	Interface0	;check interface 0?
000409  2  1400 3,2           		btfsc	Zero
00040A  2  3000 424           		goto	SetInterface0
00040B  2                   
00040B  2  1F00 44            		movrw	WIndex
00040C  2  1D00 1             		xorlw	Interface1	;check interface 1
00040D  2  1400 3,2           		btfsc	Zero
00040E  2  3000 41d           		goto	SetInterface1
00040F  2                   
00040F  2  1F00 44            		movrw	WIndex
000410  2  1D00 2             		xorlw	Interface2	;check interface 2
000411  2  1600 3,2           		btfss	Zero
000412  2  3000 225           		goto	SetupCmdErr	;
000413  2                   
000413  2                   	SetInterface2:
000413  2  1F00 42          		movrw	WValue
000414  2  1D00 0           		xorlw	0
000415  2  1600 3,2         		btfss   Zero
000416  2  3000 41a            		goto	SIT2_SetNewAlternate
000417  2  1000 13,4           		bcf	Ep2Cfg
000418  2  2000 10f         		call	NoDataControl
000419  2  0040             		ret
00041A  2                   	SIT2_SetNewAlternate:
00041A  2  1200 13,4        		bsf	Ep2Cfg
00041B  2  2000 10f         		call	NoDataControl
00041C  2  0040             		ret
00041D  2                   
00041D  2                   	SetInterface1:			;set interface 1
00041D  2  1F00 42          		movrw	WValue
00041E  2  1D00 0           		xorlw	0
00041F  2  3000 423            		goto	SetNewAlternate
000420  2  1000 13,5           		bcf	Ep1Cfg
000421  2  2000 10f         		call	NoDataControl
000422  2  0040             		ret
000423  2                   	SetNewAlternate:
000423  2  1200 13,5        		bsf	Ep1Cfg
000424  2                   
000424  2                   	SetInterface0:			;set interface 0
000424  2  2000 10f         		call	NoDataControl
000425  2  0040             		ret
000426  2                   
000426  2                   ;==============================================================================
000426  2                   IntCheck:
000426  2                   	;	btfsc   gbTx3Flag
000426  2                   	;	goto	Tx3Task
000426  2                           ;
000426  2                   	;	btfsc   gbRc4Flag
000426  2                   	;	goto	Rc4Task
000426  2                   
000426  2  1400 21,7        		btfsc   gbRc0Flag
000427  2  3000 113         		goto	Rc0Task		;setup token
000428  2                   
000428  2  1400 21,6        		btfsc   gbOut0Flag
000429  2  3000 227         		goto	Ep0OutTask	;control write
00042A  2                   
00042A  2  1400 21,5        		btfsc	gbTx0Flag
00042B  2  3000 261         		goto	Tx0Task
00042C  2                   
00042C  2                   		;~~~~~~~ WARNING:Keep Status ~~~~~~~
00042C  2  1400 21,2        		btfsc	gbSuspendFlag
00042D  2  3000 f5          		goto	SuspendTask
00042E  2                   
00042E  2                   	;	btfsc	gbRsmFlag
00042E  2                   	;	goto	RsmTask
00042E  2                   
00042E  2  0040             		ret
00042F  2                   
00042F  2                   
00042F  2                   
00042F  2                   KeepDelay:
00042F  2                   	;	movlw	160
00042F  2  0080 36          		movwf	gTempVar6
000430  2                   	KeepLoopDelay:
000430  2  2000 435         		call	KeepDelay62us
000431  2  1E04             		clrwdt
000432  2  0B00 36,1        		decfsz	gTempVar6,F
000433  2  3000 430         		goto	KeepLoopDelay
000434  2  0040             		ret
000435  2                   
000435  2                   KeepDelay62us:
000435  2  1900 7d          		movlw	125		;220
000436  2  0080 35          		movwf	gTempVar5
000437  2                   	LoopDelay:
000437  2  0B00 35,1        		decfsz	gTempVar5,F
000438  2  3000 437         		goto	LoopDelay
000439  2  0040             		ret
00043A  2                   
00043A  2                   ChkUsbAttach:
00043A  2  1000 3,2         		bcf	Zero
00043B  2  0040             		ret
00043C  2                   
00043C  2                   ;==============================================================
00043C  2                   
00043C  2                   SendResumeSignal:
00043C  2  1600 21,2        		btfss	gbSuspendFlag
00043D  2  0040             		ret
00043E  2                   
00043E  2  1200 13,6        		bsf	Resume		;RESUME signal ON
00043F  2  1900 a0          		movlw	160d		;10ms
000440  2  2000 42f         		call	KeepDelay
000441  2  1000 13,6        		bcf	Resume		;RESUME signal OFF
000442  2  0060             		reti
000443  2                   ;====================================================
000443  2                   Start:
000443  2                   		;bcf	DeviceR
000443  2                   		;call	ICinitdelay
000443  2                   		
000443  2  1200 a,1         		bsf	LED1
000444  2  1000 a,2         		bcf	LED2
000445  2  2000 bd          		call	SystemReset
000446  2  1900 c           		movlw	0ch				;Try Pb2/Pb3 pull-up;TestV7
000447  2  1E00 26          		movwr	PBPU
000448  2  1900 ff          		movlw	ffh
000449  2  0080 7           		movwf	PbReg			;avoid DM unexpected error, PB.2/PB.3 must set high
00044A  2                   
00044A  2  1000 2f,0        		bcf GetDeviceDspt08Byte
00044B  2  1000 2a,0        		bcf	gbResetPath
00044C  2  2000 e1          		call	UsbReset
00044D  2  1200 25,7        		bsf	MacVerFlag
00044E  2                   		
00044E  2                   	ATTACH_LOOP:	
00044E  2  2000 426         		call	IntCheck
00044F  2  1E04             		clrwdt
000450  2  1600 24,3        		btfss	StartScanFlag		;when setconfiguration this flag is 0, then be set 1 at setidle 
000451  2  3000 44e         		goto	ATTACH_LOOP
000452  2                   		
000452  2                   		;btfss	gSendEnterOver
000452  2                   		;goto	SendNormalURL
000452  2                   		;btfss	gEnterDelayOver
000452  2                   		;call 	DelayforSecurity
000452  2                   		;btfss	gRegisterInitOver
000452  2                   		;call	InitforSecurityKey
000452  2                   		;call	SendSecurityKey
000452  2                   ;SendNormalURL:
000452  2                   
000452  2                   		;btfsc	SendSecurityEnd
000452  2                   		;goto	ATTACH_LOOP
000452  2                   		
000452  2  1600 24,5        		btfss	JudgeSendFlag		
000453  2  3000 470         		goto	Continue			;windows go there first
000454  2                   		
000454  2  1400 2e,5        		btfsc AndroidOSFlag
000455  2  3000 462         		goto PulgInDataPre
000456  2                   
000456  2  0800 6a          		movfw	DelayCount			;mac go there first		;delay time from get report
000457  2  0200 3e,0        		subwf	TimerRollOver,W
000458  2  1600 3,0         		btfss	Carry
000459  2  3000 44e         		goto	ATTACH_LOOP
00045A  2  0880 6b          		testz	DelayCountH
00045B  2  1400 3,2         		btfsc	Zero
00045C  2  3000 462         		goto	$+6
00045D  2  0180 3e          		clrf	TimerRollOver
00045E  2  0300 6b,1        		decf	DelayCountH,F
00045F  2  1900 8a          		movlw	8ah
000460  2  0080 6a          		movwf	DelayCount
000461  2  3000 44e         		goto	ATTACH_LOOP
000462  2                   
000462  2                   	PulgInDataPre:
000462  2  0180 3e          		clrf	TimerRollOver
000463  2  1000 24,5        		bcf	JudgeSendFlag
000464  2  0180 3f          		clrf	getstring1counter
000465  2                   		;clrf	getstring2counter
000465  2  2000 49e         		call	PlugInTask_E2PROM
000466  2                   	SendPreData:
000466  2                   	
000466  2  1400 2e,5        		btfsc	AndroidOSFlag
000467  2  3000 46d         		goto	$+6;$+4
000468  2                   		;movlw 09h
000468  2  1000 2f,2        		bcf setting0x51addrFlag
000469  2  0180 30          		clrf gTempVar0
00046A  2  2000 4d2         		call	PrepareDataTask1
00046B  2  2000 6ec         		call	DataTransfer1
00046C  2  3000 44e         		goto	ATTACH_LOOP
00046D  2  2000 a21         		call	PrepareData_Android
00046E  2  2000 ac0         		call	DataTransfer1_android		
00046F  2  3000 44e         		goto	ATTACH_LOOP
000470  2                   	Continue:
000470  2  2000 483         		call	KeyscanTask
000471  2  1400 25,0        		btfsc	GUIFlag
000472  2  3000 466         		goto	SendPreData
000473  2  1400 2f,1        		btfsc AndroidURLDoneFlag
000474  2  3000 478         		goto	ThirdStage
000475  2  2000 767         		call	PrepareDataTask
000476  2  2000 893         		call	ReportTask
000477  2                   		;btfss AndroidURLDoneFlag
000477  2  3000 44e         		goto	ATTACH_LOOP
000478  2                   	ThirdStage:
000478  2  2000 a21         		call	PrepareData_Android
000479  2  2000 ac0         		call	DataTransfer1_android
00047A  2  3000 44e         		goto	ATTACH_LOOP
00047B  2                   ;==============================================================================
00047B  2                   ;function:check e2prom size
00047B  2                   ;==============================================================================
00047B  2                   CheckE2PROMSize:
00047B  2                   		;bcf		E2PROMFlag		
00047B  2                           ;bcf		E2PROM512Flag
00047B  2                   		;bcf		RamBank	
00047B  2                   
00047B  2                   		
00047B  2                           ;read E2PROM(0ffh) and save the value in 0ffh
00047B  2                           ;movlw	02h
00047B  2                   		;movwf	DataBuffer0
00047B  2                   		;movlw	feh
00047B  2                   		;movwf	R_I2C_Address1;ReadI2CAddress
00047B  2                   		;movlw	00h
00047B  2                   		;movwf	ReadI2CAddressH
00047B  2                   		;call	I2C_Receive_byte1_CKE2PROM
00047B  2                   		;call	Delay5ms
00047B  2                   		;movfw	WorkReg
00047B  2                   		;bsf		RamBank
00047B  2                   		;movwf	Check0FF								
00047B  2                   		
00047B  2                   		;btfsc	E2PCheckFlag
00047B  2                   		;goto	ReturnToOriginal
00047B  2                   		
00047B  2                           ;read E2PROM(1ffh) and save the value in 1ffh
00047B  2                   		;bcf		RamBank
00047B  2                   		
00047B  2                           ;movlw	02h
00047B  2                   		;movwf	DataBuffer0
00047B  2                   		;movlw	feh
00047B  2                   		;movwf	R_I2C_Address1;ReadI2CAddress
00047B  2                   		;movlw	01h
00047B  2                   		;movwf	ReadI2CAddressH
00047B  2                   		;call	I2C_Receive_byte1_CKE2PROM
00047B  2                   		;movfw	WorkReg
00047B  2                   		;bsf		RamBank
00047B  2                   		;movwf	Check1FF								
00047B  2                   		;call	Delay5ms
00047B  2                   		;bcf		RamBank
00047B  2                   		
00047B  2                   		;movlw	aah
00047B  2                   		;movwf	DataBuffer0
00047B  2                   		;movlw	ffh
00047B  2                   		;movwf	W_I2C_Address
00047B  2                   		;movlw	00h
00047B  2                   		;movwf	W_I2C_AddressH 
00047B  2                   		;call	I2C_Send_byte1_E2PROM512
00047B  2                   		;call	Delay5ms
00047B  2                   		;call	Delay5ms
00047B  2                   		;call	Delay5ms
00047B  2                   		;call	Delay5ms
00047B  2                   	
00047B  2                   
00047B  2                   		;movlw	cch
00047B  2                   		;movwf	DataBuffer0
00047B  2                   		;movlw	ffh
00047B  2                   		;movwf	W_I2C_Address
00047B  2                   		;movlw	01h
00047B  2                   		;movwf	W_I2C_AddressH 
00047B  2                   		;call	I2C_Send_byte1_E2PROM512
00047B  2                   		;call	Delay5ms
00047B  2                   		;call	Delay5ms	
00047B  2                   		;call	Delay5ms
00047B  2                   		;call	Delay5ms
00047B  2                   		
00047B  2                   		
00047B  2                   		;movlw	02h
00047B  2                   		;movwf	DataBuffer0
00047B  2                   		;movlw	feh
00047B  2                   		;movwf	R_I2C_Address1;ReadI2CAddress
00047B  2                   		;movlw	00h
00047B  2                   		;movwf	ReadI2CAddressH
00047B  2                   		;call	I2C_Receive_byte1_CKE2PROM							
00047B  2                   		;call	Delay5ms
00047B  2                   		
00047B  2                   		;bsf		RamBank
00047B  2                   		;movlw	41h
00047B  2                        	;movwf	Fsr
00047B  2                        	;movfw	Indf
00047B  2                   		;bcf		RamBank
00047B  2                   		;xorlw	aah
00047B  2                   		;btfsc	Zero
00047B  2                   		;bsf		E2PROMFlag
00047B  2                   		
00047B  2                   		;movlw	02h
00047B  2                   		;movwf	DataBuffer0
00047B  2                   		;movlw	feh
00047B  2                   		;movwf	R_I2C_Address1;ReadI2CAddress
00047B  2                   		;movlw	01h
00047B  2                   		;movwf	ReadI2CAddressH
00047B  2                   		;call	I2C_Receive_byte1_CKE2PROM
00047B  2                   		;call	Delay5ms
00047B  2                   		
00047B  2                   		;bsf		RamBank
00047B  2                   		;movlw	41h
00047B  2                        	;movwf	Fsr
00047B  2                        	;movfw	Indf
00047B  2                   		;bcf		RamBank
00047B  2                   		;xorlw	cch
00047B  2                   		;btfsc	Zero				
00047B  2                   		;bsf		E2PROM512Flag   
00047B  2                   		
00047B  2                   		;restore the original value in
00047B  2                   		;bsf		RamBank
00047B  2                   		;movfw	Check0FF
00047B  2                   		;bcf		RamBank									
00047B  2                   		;movwf	DataBuffer0
00047B  2                   		;movlw	ffh
00047B  2                   		;movwf	W_I2C_Address
00047B  2                   		;movlw	00h
00047B  2                   		;movwf	W_I2C_AddressH 
00047B  2                   		;call	I2C_Send_byte1_E2PROM512
00047B  2                   		;call	Delay5ms
00047B  2                   		;call	Delay5ms
00047B  2                   		;call	Delay5ms
00047B  2                   		;call	Delay5ms		
00047B  2                   		;restore the original value in
00047B  2                   		;bsf		RamBank
00047B  2                   		;movfw	Check1FF
00047B  2                   		;bcf		RamBank									
00047B  2                   		;movwf	DataBuffer0
00047B  2                   		;movlw	ffh
00047B  2                   		;movwf	W_I2C_Address
00047B  2                   		;movlw	01h
00047B  2                   		;movwf	W_I2C_AddressH 
00047B  2                   		;call	I2C_Send_byte1_E2PROM512
00047B  2                   		;call	Delay5ms
00047B  2                   		;call	Delay5ms
00047B  2                   		;call	Delay5ms
00047B  2                   		;call	Delay5ms
00047B  2                   ReturnToOriginal:
00047B  2  1000 3,5         		bcf		RamBank
00047C  2  1900 0           		movlw	00h
00047D  2                   		;movwf	Check0FF
00047D  2                   		;movwf	Check1FF
00047D  2  0080 4a          		movwf	R_I2C_Address1
00047E  2  0080 47          		movwf	TempReg
00047F  2  0080 3c          		movwf	WorkReg
000480  2  0080 70          		movwf	DataBuffer0
000481  2  0080 6e          		movwf	ReadI2CAddressH
000482  2  0040                     ret
000483  2                   		
000483  2                   		
000483  2                   ;==============================================================================
000483  2                   ;function:check e2prom exist or not
000483  2                   ;==============================================================================
000483  2                   ;E2PROMCheck:
000483  2                   	 	;clrf	R_I2C_Address
000483  2                   		;call	I2C_Receive_64byte
000483  2                   		;bsf	RamBank
000483  2                   		;movfw	ReadBuffer0
000483  2                   		;bcf	RamBank
000483  2                   		;movwf	TEMPE2PDATA
000483  2                   		;testz	TEMPE2PDATA
000483  2                   		;btfsc	Zero
000483  2                   		;goto	NoE2PROM
000483  2                   		;movlw	ffh
000483  2                   		;xorwf	TEMPE2PDATA,W
000483  2                   		;btfsc	Zero
000483  2                   		;goto	NoE2PROM
000483  2                   		;bsf	E2PROMFlag
000483  2                   		;ret
000483  2                   	;NoE2PROM:
000483  2                   		;bcf	E2PROMFlag
000483  2                   		;clrf	R_I2C_Address
000483  2                   		;call	Get64ByteInfo
000483  2                   		;ret
000483  2                   ;==============================================================================
000483  2                   ;function:Get device information
000483  2                   ;==============================================================================
000483  2                   ;GetDeviceInfo:
000483  2                   		;bsf	GetInfoFlag
000483  2                   		;clrf	R_I2C_Address
000483  2                   		;btfsc	E2PROMFlag
000483  2                   		;goto	$+3
000483  2                   		;call	Get64ByteInfo
000483  2                   		;ret
000483  2                   		;clrf	R_I2C_Address
000483  2                   		;call	I2C_Receive_64byte
000483  2                   		;ret
000483  2                   ;==============================================================================
000483  2                   ;function:PB0 option and PD4~PD7 scan key
000483  2                   ;==============================================================================
000483  2                   KeyscanTask:
000483  2  1600 7,0         		btfss	PbReg,0
000484  2  3000 487         		goto	$+3
000485  2  1000 2b,7        		bcf	KeyPressedFlag
000486  2  1000 2b,6        		bcf	PressToggleFlag
000487  2  1400 2b,7        		btfsc	KeyPressedFlag
000488  2  0040             		ret
000489  2                   
000489  2  1400 23,4        		btfsc	DataOKFlag
00048A  2  0040             		ret
00048B  2                   
00048B  2  0900 7,0         		comf	PbReg,W
00048C  2  1B00 1           		andlw	01h
00048D  2  1400 3,2         		btfsc	Zero
00048E  2  0040             		ret
00048F  2  2000 435         		call	KeepDelay62us
000490  2  0900 7,0         		comf	PbReg,W
000491  2  1B00 1           		andlw	01h
000492  2  1400 3,2         		btfsc	Zero
000493  2  0040             		ret
000494  2  1400 2b,6        		btfsc	PressToggleFlag
000495  2  3000 499         		goto	$+4
000496  2  1200 2b,6        		bsf	PressToggleFlag
000497  2  0180 3e          		clrf	TimerRollOver
000498  2  0040             		ret
000499  2  1900 a           		movlw	0ah
00049A  2  0200 3e,0        		subwf	TimerRollOver,W
00049B  2  1600 3,0         		btfss	Carry
00049C  2  0040             		ret
00049D  2  1200 2b,7        		bsf	KeyPressedFlag
00049E  2                   
00049E  2                   PlugInTask_E2PROM:
00049E  2                   	;	btfsc	DataOKFlag
00049E  2                   	;	ret				;data transmiting
00049E  2                   		
00049E  2  1000 2a,1        		bcf	EndTransFlag
00049F  2                   		;movlw	199d
00049F  2                   		;btfsc	E2PROMFlag
00049F  2                   		;movlw	192d
00049F  2                   		;movwf	MaxURLLength				;none used
00049F  2  1200 2b,2        		bsf	DataInFlag1
0004A0  2  1000 2a,2        		bcf	OneFlag
0004A1  2  1900 0           		movlw	00h
0004A2  2  0080 50          		movwf	ScanNumber
0004A3  2                   ;		movlw	DeviceIDIndex				;clear R_I2C_Address to get info from URL table
0004A3  2                   		;btfsc	E2PROMFlag
0004A3  2                   		;movlw	00h
0004A3  2  0080 49          		movwf	R_I2C_Address
0004A4  2  0180 51          		clrf	TempCount
0004A5  2  0180 52          		clrf	EndMaxURL40h
0004A6  2                   
0004A6  2                   		;btfss	E2PROMFlag
0004A6  2                   		;goto	$+3
0004A6  2                   		;call	I2C_Receive_64byte			;get 64 bytes data from I2C
0004A6  2                   		;goto	$+2
0004A6  2                   		
0004A6  2                   ;		call	GetTagInfo					;get 64 bytes data from URL which in last page
0004A6  2  2000 54d         		call	GetWindowsInfo
0004A7  2  2000 561         		call	GetMACInfo
0004A8  2  2000 56e         		call	GetAndroidInfo
0004A9  2                   
0004A9  2                   		;check language	if 2 or 10 for MAC and Android
0004A9  2                   		;bsf		RamBank 			;check language for mac	
0004A9  2  1900 10          		movlw	10h 
0004AA  2  0600 64,0        		xorwf	LanguageType,W;ReadBuffer1,W
0004AB  2  1400 3,2         		btfsc	Zero 
0004AC  2  3000 4b1         		goto	$+5
0004AD  2  1900 2           		movlw	02h 
0004AE  2  0600 64,0        		xorwf	LanguageType,W;ReadBuffer1,W
0004AF  2  1600 3,2         		btfss	Zero 
0004B0  2  3000 4b2         		goto	$+2
0004B1  2                   		;bcf		RamBank 
0004B1  2  1200 2d,1        		bsf		CheckLanguage
0004B2  2                   				
0004B2  2                   ;		bsf	RamBank					;read encry type
0004B2  2                   ;		movfw	42h
0004B2  2                   ;		bcf	RamBank
0004B2  2                   ;		movwf	EncryptionValue
0004B2  2                   		
0004B2  2                   ;		bsf	RamBank					;read windows url index, althouth 2 bytes reserved, but high byte doesn't use
0004B2  2                   ;		movfw	44h
0004B2  2                   ;		bcf	RamBank				
0004B2  2                   ;		movwf	URLAddressIndex
0004B2  2                   		
0004B2  2                   ;		bsf	RamBank					;read windows url length
0004B2  2                   ;		movfw	45h
0004B2  2                   ;		bcf	RamBank		
0004B2  2                   ;		movwf	URLAddressLen
0004B2  2                   ;		incf	URLAddressLen,F		;send key judge, necessary
0004B2  2                   		
0004B2  2                   ;		bsf	RamBank					;read mac url index
0004B2  2                   ;		movfw	47h
0004B2  2                   ;		bcf	RamBank		
0004B2  2                   ;		movwf	MacURLAddressIndex
0004B2  2                   		
0004B2  2                   ;		bsf	RamBank					;read mac url length
0004B2  2                   ;		movfw	48h
0004B2  2                   ;		bcf	RamBank		
0004B2  2                   ;		movwf	MacURLAddressLen	
0004B2  2                   ;		addwf	MacURLAddressLen,F
0004B2  2                   ;		movlw	02h
0004B2  2                   ;		addwf	MacURLAddressLen,F
0004B2  2                   		
0004B2  2                   ;		bsf	RamBank					;read security key index
0004B2  2                   ;		movfw	4ah
0004B2  2                   ;		bcf	RamBank		
0004B2  2                   ;		movwf	SecurityKeyIndex
0004B2  2                   		
0004B2  2                   ;		bsf	RamBank					;read security delay time
0004B2  2                   ;		movfw	4ch
0004B2  2                   ;		bcf	RamBank
0004B2  2                   ;		movwf	SecurityDelayTime
0004B2  2                   		
0004B2  2                   ;		bsf	RamBank					;read send key type, specific
0004B2  2                   ;		movfw	4dh
0004B2  2                   ;		bcf	RamBank
0004B2  2                   ;		movwf	CtrlCmdSpace			;0=ctrl, 1=command
0004B2  2                   		
0004B2  2  0800 7a          		movfw	URLAddressIndex			;refresh url starting address
0004B3  2  1600 24,2        		btfss	OSType
0004B4  2  0800 7c          		movfw	MacURLAddressIndex
0004B5  2  1400 2e,5        			btfsc	AndroidOSFlag		;if OS is android
0004B6  2  0800 4e          			movfw	AndroidURLIndex
0004B7  2  0080 49          		movwf	R_I2C_Address
0004B8  2                   		
0004B8  2  1400 3,2         		btfsc	Zero
0004B9  2                   	E2PROMEmpty:
0004B9  2  2000 4c1         		call	ChangeBufferData		;Change Data for open a vacant web
0004BA  2  1200 23,4        		bsf	DataOKFlag
0004BB  2  1900 5           		movlw	05h
0004BC  2  1400 2d,5        		btfsc	E2PROM512Flag
0004BD  2  1900 a           		movlw	0ah
0004BE  2  0080 53          		movwf	ReadURLTime
0004BF  2  1200 25,0        		bsf	GUIFlag			;transmit GUI/R at first
0004C0  2  0040             		ret
0004C1  2                   
0004C1  2                   ;=====================================================================
0004C1  2                   ChangeBufferData:
0004C1  2  1200 3,5         		bsf	RamBank
0004C2  2  1900 68          		movlw	68h
0004C3  2  0080 40          		movwf	ReadBuffer0
0004C4  2  1900 74          		movlw	74h
0004C5  2  0080 41          		movwf	ReadBuffer1
0004C6  2  0080 42          		movwf	ReadBuffer2
0004C7  2  1900 70          		movlw	70h
0004C8  2  0080 43          		movwf	ReadBuffer3
0004C9  2  1900 3a          		movlw	3ah
0004CA  2  0080 44          		movwf	ReadBuffer4
0004CB  2  1900 2f          		movlw	2fh
0004CC  2  0080 45          		movwf	ReadBuffer5
0004CD  2  0080 46          		movwf	ReadBuffer6
0004CE  2  1900 0           		movlw	00h
0004CF  2  0080 47          		movwf	ReadBuffer7
0004D0  2  1000 3,5         		bcf	RamBank
0004D1  2  0040             		ret
0004D2  2                   ;=============================================================================
0004D2  2                   PrepareDataTask1:
0004D2  2  1400 24,2        		btfsc	OSType
0004D3  2  3000 656         		goto	PrepareData_Win
0004D4  2                       PrepareData_Mac:
0004D4  2  1600 2b,2        		btfss	DataInFlag1
0004D5  2  0040             		ret
0004D6  2  1400 2a,2        		btfsc	OneFlag
0004D7  2  0040             		ret
0004D8  2  1200 2a,3        		bsf	TransFlag
0004D9  2  1200 2a,2        		bsf	OneFlag
0004DA  2  1400 2a,4        		btfsc	PlugFlag
0004DB  2  0040             		ret
0004DC  2  0800 50          		movfw	ScanNumber
0004DD  2                   		;btfss	MacVerFlag
0004DD  2                   		;goto	$+3
0004DD  2  2000 600         		call	GetKeyValuePro_Mac
0004DE  2                   		;goto	$+2
0004DE  2                   		;call	GetKeyValuePro_Mac1
0004DE  2  0080 55          		movwf	UsbKeyBuffer2
0004DF  2  1900 e1          		movlw	E1h
0004E0  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
0004E1  2  1600 3,2         		btfss	Zero
0004E2  2  3000 4e9         		goto	NormalKeyValue0
0004E3  2  1900 0           		movlw	00h						
0004E4  2  0080 54          		movwf	UsbKeyBuffer0
0004E5  2                   		;movlw	01h
0004E5  2                   		;xorwf	CtrlCmdSpace,W
0004E5  2                   		;btfss	Zero
0004E5  2                   		;goto	$+3
0004E5  2                   		;movlw	08h
0004E5  2                   		;movwf	UsbKeyBuffer0
0004E5  2                   		;btfss	MacVerFlag;CtrlCmdSpace,0;MacVerFlag
0004E5  2                   		;movlw	01h					;; ctrl
0004E5  2                   		;movwf	UsbKeyBuffer0
0004E5  2  1900 91          		movlw	91h					;switch to single char country language for mac
0004E6  2                   		;btfss	MacVerFlag
0004E6  2                   		;movlw	3bh
0004E6  2  0080 55          		movwf	UsbKeyBuffer2
0004E7  2  0A00 50,1        		incf	ScanNumber,F
0004E8  2  0040             		ret
0004E9  2                   	NormalKeyValue0:				;multi-language, a<->q
0004E9  2  1900 e2          		movlw	E2h
0004EA  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
0004EB  2  1600 3,2         		btfss	Zero
0004EC  2  3000 4f7         		goto	NormalKeyValue01
0004ED  2  1900 a           		movlw	0ah 		
0004EE  2  0080 54          		movwf	UsbKeyBuffer0		
0004EF  2  1600 2d,1        		btfss	CheckLanguage
0004F0  2  3000 4f3         		goto	$+3
0004F1  2  1900 14          		movlw	14h
0004F2  2  3000 4f4         		goto	$+2	
0004F3  2  1900 4           		movlw	04h    				
0004F4  2  0080 55          		movwf	UsbKeyBuffer2
0004F5  2  0A00 50,1        		incf	ScanNumber,F 
0004F6  2  0040             		ret
0004F7  2                   		;movlw	E2h					;gui+'L'
0004F7  2                   		;xorwf	UsbKeyBuffer2,W
0004F7  2                   		;btfss	Zero
0004F7  2                   		;goto	NormalKeyValue01	;NormalKeyValue01
0004F7  2                   		;movlw	08h
0004F7  2                   		;movwf	UsbKeyBuffer0
0004F7  2                   		;movlw	0fh
0004F7  2                   		;movwf	UsbKeyBuffer2
0004F7  2                   		;incf	ScanNumber,F
0004F7  2                   		;ret
0004F7  2                   	NormalKeyValue01:				;ctrl space		
0004F7  2  1900 e3          		movlw	E3h
0004F8  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
0004F9  2  1600 3,2         		btfss	Zero
0004FA  2  3000 507         		goto	NormalKeyValue02
0004FB  2                   
0004FB  2  1900 0           		movlw	00h
0004FC  2  0180 55          		clrf	UsbKeyBuffer2
0004FD  2                   		
0004FD  2  1900 1           		movlw	01h
0004FE  2  0500 72,0        		andwf	CtrlCmdSpace,W
0004FF  2  1400 3,2         		btfsc	Zero
000500  2  3000 505         		goto	$+5
000501  2                   		
000501  2  1900 1           		movlw	01h;08h
000502  2  0080 54          		movwf	UsbKeyBuffer0
000503  2  1900 2c          		movlw	2ch;12h
000504  2  0080 55          		movwf	UsbKeyBuffer2
000505  2  0A00 50,1        		incf	ScanNumber,F  
000506  2  0040             		ret
000507  2                   
000507  2                   	NormalKeyValue02:
000507  2  1900 e4          		movlw	E4h
000508  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000509  2  1600 3,2         		btfss	Zero
00050A  2  3000 50e         		goto	NormalKeyValue03
00050B  2                   		;call	LockLedState
00050B  2                   		;call	DelaySendKeyRoutine
00050B  2  2000 5a1         		call	WaitforLangSwitch
00050C  2  0180 55          		clrf	UsbKeyBuffer2			;remember clrf UsbKeyBuffer2
00050D  2                   		;incf	ScanNumber,F 
00050D  2                   			
00050D  2  0040             		ret
00050E  2                   	
00050E  2                   		;movlw	E4h					;gui+'O'
00050E  2                   		;xorwf	UsbKeyBuffer2,W
00050E  2                   		;btfss	Zero
00050E  2                   		;goto	NormalKeyValue03
00050E  2                   		;movlw	08h
00050E  2                   		;movwf	UsbKeyBuffer0
00050E  2                   		;movlw	12h
00050E  2                   		;movwf	UsbKeyBuffer2
00050E  2                   		;incf	ScanNumber,F
00050E  2                   		;ret
00050E  2                   	NormalKeyValue03:
00050E  2  1900 e5          		movlw	E5h
00050F  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000510  2  1600 3,2         		btfss	Zero
000511  2  3000 518         		goto	NormalKeyValue04
000512  2  1900 8           		movlw	08h
000513  2  0080 54          		movwf	UsbKeyBuffer0
000514  2  1900 f           		movlw	0fh
000515  2  0080 55          		movwf	UsbKeyBuffer2
000516  2  0A00 50,1        		incf	ScanNumber,F
000517  2  0040             		ret
000518  2                   
000518  2                   	NormalKeyValue04:			;command space
000518  2  1900 e6          		movlw	E6h
000519  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
00051A  2  1600 3,2         		btfss	Zero
00051B  2  3000 528         		goto	NormalKeyValue05
00051C  2                   
00051C  2  1900 0           		movlw	00h
00051D  2  0180 55          		clrf	UsbKeyBuffer2
00051E  2                   		
00051E  2  1900 2           		movlw	02h
00051F  2  0500 72,0        		andwf	CtrlCmdSpace,W
000520  2  1400 3,2         		btfsc	Zero
000521  2  3000 526         		goto	$+5
000522  2                   		
000522  2  1900 8           		movlw	08h
000523  2  0080 54          		movwf	UsbKeyBuffer0
000524  2  1900 2c          		movlw	2ch
000525  2  0080 55          		movwf	UsbKeyBuffer2
000526  2  0A00 50,1        		incf	ScanNumber,F 		
000527  2  0040             		ret
000528  2                   
000528  2                   	NormalKeyValue05:			;command+Q
000528  2  1900 e7          		movlw	E7h
000529  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
00052A  2  1600 3,2         		btfss	Zero
00052B  2  3000 532         		goto	NormalKeyValue06
00052C  2  1900 8           		movlw	08h;02h
00052D  2  0080 54          		movwf	UsbKeyBuffer0
00052E  2  1900 14          		movlw	14h;24h
00052F  2  0080 55          		movwf	UsbKeyBuffer2
000530  2  0A00 50,1        		incf	ScanNumber,F
000531  2  0040             		ret
000532  2                   		
000532  2                   	NormalKeyValue06:
000532  2  0180 54          		clrf	UsbKeyBuffer0
000533  2  0A00 50,1        		incf	ScanNumber,F
000534  2  1900 55          		movlw	MacWebLength
000535  2                   		;btfss	MacVerFlag
000535  2                   		;movlw	MacWebLength1
000535  2  0200 50,0        		subwf	ScanNumber,W
000536  2  1600 3,0         		btfss	Carry
000537  2  0040             		ret
000538  2  0180 50          		clrf	ScanNumber
000539  2  1000 2a,1        		bcf	EndTransFlag
00053A  2  1000 2b,2        		bcf	DataInFlag1
00053B  2  1000 25,0        		bcf	GUIFlag
00053C  2  1000 2a,2        		bcf	OneFlag
00053D  2  0040             		ret
00053E  2                   		
00053E  2                   ;MoreSendCapsLock:
00053E  2                   ;  		movfw	39h;CapsLock
00053E  2                   ;  		movwr	Tx1FifoReg0
00053E  2                   
00053E  2                   ;  		movlw	00h
00053E  2                   ;  		movwr	Tx1FifoReg1
00053E  2                   ;  		movwr	Tx1FifoReg5
00053E  2                   ;  		movwr	Tx1FifoReg6
00053E  2                   ;  		movwr	Tx1FifoReg7
00053E  2                   ;  		movwf	UsbKeyBuffer3
00053E  2                   ;  		movwf	UsbKeyBuffer4
00053E  2                   
00053E  2                   ; 		movlw	f0h
00053E  2                   ; 		andwf	Tx1Reg,F
00053E  2                   ; 		movlw	08h
00053E  2                   ;		iorwf	Tx1Reg,F
00053E  2                   ;		movlw	40h
00053E  2                   ;		xorwf	Tx1Reg,F
00053E  2                   ;		bsf	Tx1Rdy
00053E  2                   ;		ret
00053E  2                     Delay5ms:
00053E  2  0180 6d          		clrf	DelayCount_us		;Used for a 5 ms delay at write
00053F  2                     Delay5_ms:
00053F  2  3000 540           		Delay_us	8
000540  2  3000 541         
000541  2  3000 542         
000542  2  3000 543         
000543  2  3000 544         
000544  2  3000 545         
000545  2  3000 546         
000546  2  3000 547         
000547  2  3000 548         
000548  2  3000 549         
000549  2  3000 54a         
00054A  2  0B00 6d,1        		decfsz	DelayCount_us,F
00054B  2  3000 53f         		goto	Delay5_ms
00054C  2  0040             		ret
00054D  2                   
00054D  2                   
00054D  2                   ;============================================================================
00054D  2                   		;org	0600h
00054D  2                   ;InitforSecurityKey:
00054D  2                   		;clrf	EndMaxURL40h
00054D  2                   		;movfw	SecurityKeyIndex
00054D  2                   		;movwf	R_I2C_Address
00054D  2                   		;call	GetSecurityInfo
00054D  2                   		;bsf		gRegisterInitOver
00054D  2                   		;ret	
00054D  2                   ;SendSecurityKey:
00054D  2                   		;btfss	gEnterDelayOver
00054D  2                   		;ret
00054D  2                   		
00054D  2                   		;bsf		StartScanFlag
00054D  2                   		;btfsc	Tx1Rdy			;is ready to prepare to send packet?
00054D  2                   		;ret 
00054D  2                   
00054D  2                   		;movfw	SendSecuritytimes
00054D  2                   		;xorlw	03h
00054D  2                   		;btfss   Zero
00054D  2                   		;goto    $+2 
00054D  2                   		;goto	sendzerodata
00054D  2                   
00054D  2                   		;movlw	ReadBuffer
00054D  2                        		;movwf	Fsr
00054D  2                        		;movfw	EndMaxURL40h
00054D  2                   
00054D  2                        		;addwf	Fsr,F
00054D  2                        		;bsf	RamBank
00054D  2                        		;movfw	Indf
00054D  2                        		;bcf	RamBank
00054D  2                        		;movwf	UsbKeyBuffer0;WorkReg
00054D  2                        		;incf	EndMaxURL40h,F		;transmit 64 times data
00054D  2                   
00054D  2                   		;movlw	ReadBuffer
00054D  2                        		;movwf	Fsr
00054D  2                        		;movfw	EndMaxURL40h
00054D  2                   
00054D  2                        		;addwf	Fsr,F
00054D  2                        		;bsf	RamBank
00054D  2                        		;movfw	Indf
00054D  2                        		;bcf	RamBank
00054D  2                        		;movwf	UsbKeyBuffer2;WorkReg
00054D  2                        		;incf	EndMaxURL40h,F		;transmit 64 times data
00054D  2                   			
00054D  2                   
00054D  2                   		;movfw	UsbKeyBuffer2
00054D  2                   		;xorlw	20h
00054D  2                   		;btfss	Zero
00054D  2                   		;goto	$+4
00054D  2                   		;incf	SendSecuritytimes,F
00054D  2                   		;clrf	EndMaxURL40h
00054D  2                   		;bcf		DataOKFlag
00054D  2                   		
00054D  2                   		;movfw	UsbKeyBuffer2
00054D  2                     		;movwr	Tx1FifoReg2
00054D  2                   		
00054D  2                     		;movfw	UsbKeyBuffer0	;02h
00054D  2                     		;movwr	Tx1FifoReg0
00054D  2                     		;movlw	00h
00054D  2                     		;movwr	Tx1FifoReg3
00054D  2                     		;movwr	Tx1FifoReg4
00054D  2                          		
00054D  2                   		;movlw	f0h
00054D  2                   		;andwf	Tx1Reg,F
00054D  2                   		;movlw	08h
00054D  2                   		;iorwf	Tx1Reg,F		;Endpoint1 transmit 8 byte
00054D  2                   		;movlw	40h
00054D  2                   		;xorwf	Tx1Reg,F
00054D  2                   		;bsf	Tx1Rdy 	
00054D  2                   		;ret
00054D  2                   		
00054D  2                   ;sendzerodata:
00054D  2                   		;btfsc	Tx1Rdy			;is ready to prepare to send packet?
00054D  2                   		;ret 
00054D  2                   		;movlw	00h 
00054D  2                   		;movwr	Tx1FifoReg0
00054D  2                     		;movwr	Tx1FifoReg1
00054D  2                     		;movwr	Tx1FifoReg2
00054D  2                     		;movlw	f0h
00054D  2                   		;andwf	Tx1Reg,F
00054D  2                   		;movlw	08h
00054D  2                   		;iorwf	Tx1Reg,F		;Endpoint1 transmit 8 byte
00054D  2                   		;movlw	40h
00054D  2                   		;xorwf	Tx1Reg,F		
00054D  2                   		;bsf	Tx1Rdy  
00054D  2                   		;bcf		DataOKFlag
00054D  2                   		;bsf	SendSecurityEnd
00054D  2                   		;ret
00054D  2                   		
00054D  2                   ;DelayforSecurity:
00054D  2                   		;movfw	TimerRollOver			
00054D  2                   		;xorlw	17h
00054D  2                   		;btfss	Zero
00054D  2                   		;ret
00054D  2                   		;movlw	01h
00054D  2                   		;subwf	SecurityDelayTime,W
00054D  2                   		;btfss	Carry
00054D  2                   		;goto	$+7		
00054D  2                   		;clrf	TimerRollOver
00054D  2                   		;incf	TimeBuffer,F
00054D  2                   		;movfw	SecurityDelayTime
00054D  2                   		;xorwf	TimeBuffer,W
00054D  2                   		;btfss	Zero
00054D  2                   		;ret
00054D  2                   		;bsf	gEnterDelayOver
00054D  2                   		;ret
00054D  2                   		
00054D  2                   ;============================================================================	
00054D  2                   GetWindowsInfo:	
00054D  2  1900 1           		movlw	LanguageNumber
00054E  2  2000 d78         		call	WindowsURLTable
00054F  2  0080 64          		movwf	LanguageType
000550  2                   		
000550  2  1900 2           		movlw	EncryptionType
000551  2  2000 d78         		call	WindowsURLTable
000552  2  0080 73          		movwf	EncryptionValue
000553  2                   			
000553  2  1900 4           		movlw	WindowsURLaddrStartLow
000554  2  2000 d78         		call	WindowsURLTable
000555  2  0080 7a          		movwf	URLAddressIndex
000556  2                   		
000556  2  1900 5           		movlw	WindowsURLaddrLength
000557  2  2000 d78         		call	WindowsURLTable
000558  2  0080 7b          		movwf	URLAddressLen
000559  2  0A00 7b,1        		incf	URLAddressLen,F		;send key judge, necessary			
00055A  2                   		
00055A  2  1900 7           		movlw	WindowsURLaddrEndtLow
00055B  2  2000 d78         		call	WindowsURLTable
00055C  2  0080 48          		movwf	WindowsURLEnd
00055D  2                   		
00055D  2  1900 d           		movlw	CtrlCmdSpaceType
00055E  2  2000 d78         		call	WindowsURLTable
00055F  2  0080 72          		movwf	CtrlCmdSpace		
000560  2                   		
000560  2  0040             		ret
000561  2                   ;============================================================================
000561  2                   GetMACInfo:				
000561  2  1900 4           		movlw	MACURLaddrStartLow
000562  2  2000 e00         		call	MACURLTable
000563  2  0080 7c          		movwf	MacURLAddressIndex;AndroidURLIndex
000564  2                   		
000564  2  1900 5           		movlw	MACURLaddrLength
000565  2  2000 e00         		call	MACURLTable
000566  2  0080 7d          		movwf	MacURLAddressLen	
000567  2  0700 7d,1        		addwf	MacURLAddressLen,F
000568  2  1900 2           		movlw	02h
000569  2  0700 7d,1        		addwf	MacURLAddressLen,F		
00056A  2                   		
00056A  2  1900 7           		movlw	MACURLaddrEndtLow
00056B  2  2000 e00         		call	MACURLTable
00056C  2  0080 75          		movwf	MACURLEnd	
00056D  2  0040             		ret		
00056E  2                   ;============================================================================	
00056E  2                   GetAndroidInfo:				
00056E  2  1900 4           		movlw	AndroidURLaddrStartLow
00056F  2  2000 f00         		call	AndroidURLTable
000570  2  0080 4e          		movwf	AndroidURLIndex
000571  2                   		
000571  2  1900 5           		movlw	AndroidURLaddrLength
000572  2  2000 f00         		call	AndroidURLTable
000573  2  0080 4f          		movwf	AndroidURLLength	
000574  2  0700 4f,1        		addwf	AndroidURLLength,F
000575  2  1900 2           		movlw	02h
000576  2  0700 4f,1        		addwf	AndroidURLLength,F		
000577  2                   		
000577  2  1900 7           		movlw	AndroidURLaddrEndtLow
000578  2  2000 f00         		call	AndroidURLTable
000579  2  0080 65          		movwf	AndroidURLEnd	
00057A  2  0040             		ret
00057B  2                   ;============================================================================
00057B  2                   ;GetTagInfo:				;get 64bytes data from last page
00057B  2                   ;		movlw	00h
00057B  2                   ;		movwf	TempReg
00057B  2                   ;	GetNextTagByte:
00057B  2                   ;		movfw	R_I2C_Address
00057B  2                   ;		call	DeviceInfoTable
00057B  2                   ;		movwf	WorkReg
00057B  2                   ;		call	StoreReceiveData1
00057B  2                   ;		incf	R_I2C_Address,F
00057B  2                   ;		incf	TempReg,F
00057B  2                   
00057B  2                   ;		movlw	40h
00057B  2                   ;		subwf	TempReg,W
00057B  2                   ;		btfss	Carry
00057B  2                   ;		goto	GetNextTagByte
00057B  2                   ;		ret
00057B  2                   ;=======================================================
00057B  2                   StoreReceiveNoEncrytion:
00057B  2  1900 40          		movlw	ReadBuffer
00057C  2  0080 4                		movwf	Fsr
00057D  2  0800 47               		movfw	TempReg
00057E  2  0700 4,1              		addwf	Fsr,F
00057F  2  0800 3c               		movfw	WorkReg
000580  2  1200 3,5              		bsf	RamBank
000581  2  0080 0                		movwf	Indf
000582  2  1000 3,5              		bcf	RamBank
000583  2  0040             		ret
000584  2                   ;=======================================================
000584  2                   ChooseLanguageKey:
000584  2  1400 2d,1        		btfsc	CheckLanguage
000585  2  1800 14          		retlw	14h	
000586  2  1800 4           		retlw	04h	
000587  2                   ;=======================================================
000587  2                   
000587  2                   
000587  2                   WaitSendNextURL:		
000587  2  1400 2e,3        		btfsc	langSwitchDelayFlag
000588  2  3000 58c         		goto	WaitSendNextURL_sub		
000589  2  0180 3e          		clrf	TimerRollOver
00058A  2  1900 1           		movlw	01h;02h
00058B  2  0080 70          		movwf	TimerCountH
00058C  2                   	WaitSendNextURL_sub:
00058C  2  1200 2e,3        		bsf		langSwitchDelayFlag
00058D  2  1900 3           		movlw	03h
00058E  2  1400 2e,5        		btfsc	AndroidOSFlag
00058F  2  1900 2           		movlw	02h;05h;10h
000590  2  0200 3e,0        		subwf	TimerRollOver,W
000591  2  1600 3,0         		btfss	Carry		
000592  2  3000 59b         		goto	clrUsbBuffer_android
000593  2  0880 70          		testz	TimerCountH
000594  2  1600 3,2         		btfss	Zero
000595  2  3000 59a         		goto	$+5
000596  2                   		;incf	ScanNumber,F
000596  2  1000 2e,7        		bcf		SendKeyNotYetFlag
000597  2  0180 3e          		clrf	TimerRollOver
000598  2                   		;clrf	UsbKeyBuffer2
000598  2  1000 2e,3        		bcf		langSwitchDelayFlag
000599  2  0040             		ret
00059A  2  0300 70,1        		decf	TimerCountH
00059B  2                   	clrUsbBuffer_android:
00059B  2  1200 2e,7        		bsf		SendKeyNotYetFlag
00059C  2  0300 52,1        		decf	EndMaxURL40h,F
00059D  2  0300 52,1        		decf	EndMaxURL40h,F
00059E  2  0180 54          		clrf	UsbKeyBuffer0
00059F  2  0180 55          		clrf	UsbKeyBuffer2
0005A0  2  0040             		ret		
0005A1  2                   
0005A1  2                   ;=======================================================
0005A1  2                   WaitforLangSwitch:
0005A1  2  1400 2e,3        		btfsc	langSwitchDelayFlag
0005A2  2  3000 5a6         		goto	WaitforLangSwitch_sub
0005A3  2  0180 3e          		clrf	TimerRollOver
0005A4  2  1900 20          		movlw	20h
0005A5  2  0080 70          		movwf	TimerCountH
0005A6  2                   	WaitforLangSwitch_sub:
0005A6  2  1200 2e,3        		bsf		langSwitchDelayFlag
0005A7  2  1900 10          		movlw	10h
0005A8  2  1400 2e,5        		btfsc	AndroidOSFlag
0005A9  2  1900 30          		movlw	30h;50h
0005AA  2  0200 3e,0        		subwf	TimerRollOver,W
0005AB  2  1600 3,0         		btfss	Carry		
0005AC  2  3000 5b6         		goto	clrUsbBuffer
0005AD  2  0880 70          		testz	TimerCountH
0005AE  2  1600 3,2         		btfss	Zero
0005AF  2  3000 5b5         		goto	$+6
0005B0  2  0A00 50,1        		incf	ScanNumber,F
0005B1  2  0180 3e          		clrf	TimerRollOver
0005B2  2  0180 55          		clrf	UsbKeyBuffer2
0005B3  2  1000 2e,3        		bcf		langSwitchDelayFlag
0005B4  2  0040             		ret
0005B5  2  0300 70,1        		decf	TimerCountH
0005B6  2                   	clrUsbBuffer:
0005B6  2  0180 54          		clrf	UsbKeyBuffer0
0005B7  2  0180 55          		clrf	UsbKeyBuffer2
0005B8  2  0040             		ret
0005B9  2                   		
0005B9  2                   ;=======================================================
0005B9  2                   GetAndroid64URL:				;get security data from last page
0005B9  2  1900 0           		movlw	00h
0005BA  2  0080 47          		movwf	TempReg
0005BB  2                   	GetNextAndroid:
0005BB  2  0800 49          		movfw	R_I2C_Address
0005BC  2  2000 f00         		call	AndroidURLTable
0005BD  2  0080 3c          		movwf	WorkReg
0005BE  2  2000 9fc         		call	StoreReceiveData1
0005BF  2  0A00 49,1        		incf	R_I2C_Address,F
0005C0  2  0A00 47,1        		incf	TempReg,F
0005C1  2                   		
0005C1  2  0800 65          		movfw	AndroidURLEnd				;the lastest URL address
0005C2  2  0200 49,0        		subwf	R_I2C_Address,W
0005C3  2  1400 3,0         		btfsc	Carry
0005C4  2  0040             		ret
0005C5  2  1900 40          		movlw	40h			
0005C6  2  0200 47,0        		subwf	TempReg,W
0005C7  2  1600 3,0         		btfss	Carry
0005C8  2  3000 5bb         		goto	GetNextAndroid
0005C9  2  0040             		ret	
0005CA  2                   ;--------------ic initial delay-------------------------
0005CA  2                   ;ICinitdelay:
0005CA  2                   		;movlw	04h
0005CA  2                   		;movwf	TEMPE2PDATA
0005CA  2                   		;movlw	ffh
0005CA  2                   		;movwf	DelayCount
0005CA  2                   		;movwf	DelayCountH
0005CA  2                   		;movwf	TempCount
0005CA  2                   	;InitWaiting:
0005CA  2                   		;decf	DelayCount,F
0005CA  2                   		;testz	DelayCount
0005CA  2                   		;btfsc	Zero
0005CA  2                   		;decf	DelayCountH,F
0005CA  2                   		;testz	DelayCountH
0005CA  2                   		;btfsc	Zero
0005CA  2                   		;decf	TempCount,F
0005CA  2                   		;testz	TempCount
0005CA  2                   		;btfsc	Zero
0005CA  2                   		;decf	TEMPE2PDATA,F
0005CA  2                   		;testz	TEMPE2PDATA
0005CA  2                   		;btfss	Zero
0005CA  2                   		;goto	InitWaiting
0005CA  2                   		;clrf	DelayCount
0005CA  2                   		;clrf	DelayCountH
0005CA  2                   		;clrf	TempCount
0005CA  2                   		;clrf	TEMPE2PDATA
0005CA  2                   		;ret		
0005CA  2                   ;=======================================================
0005CA  2                   ;WaitforLangSwitch_win:
0005CA  2                   		;movlw	02h
0005CA  2                   		;xorwf	Setreportcount,W
0005CA  2                   		;btfss	Zero
0005CA  2                   		;goto 	$+4
0005CA  2                   		;clrf	UsbKeyBuffer2
0005CA  2                   		;incf	ScanNumber,F
0005CA  2                   		;ret
0005CA  2                   
0005CA  2                   		;btfsc	langSwitchDelayFlag
0005CA  2                   		;goto	WaitforLangSwitch_sub_win
0005CA  2                   		;clrf	TimerRollOver
0005CA  2                   		;movlw	08h
0005CA  2                   		;movwf	TimerCountH
0005CA  2                   	;WaitforLangSwitch_sub_win:
0005CA  2                   		;bsf		langSwitchDelayFlag
0005CA  2                   		;movlw	08h
0005CA  2                   		;subwf	TimerRollOver,W
0005CA  2                   		;btfss	Carry		
0005CA  2                   		;goto	clrUsbBuffer_win
0005CA  2                   		;testz	TimerCountH
0005CA  2                   		;btfss	Zero
0005CA  2                   		;goto	$+5
0005CA  2                   		;incf	ScanNumber,F
0005CA  2                   		;clrf	TimerRollOver
0005CA  2                   		;bcf		langSwitchDelayFlag
0005CA  2                   		;ret
0005CA  2                   		;decf	TimerCountH
0005CA  2                   	;clrUsbBuffer_win:
0005CA  2                   		;clrf	UsbKeyBuffer0
0005CA  2                   		;clrf	UsbKeyBuffer2
0005CA  2                   		;ret
0005CA  2                   ;============================================================================		
0005CA  2                   		org	0600h	;org	0700h
000600  2                   .TABLE
000600  2                   GetKeyValuePro_Mac:
000600  2  0700 2,1         		addwf	Pcl,F
000601  2                   	MacArray_start:
000601  2  1800 0           		retlw	00h
000602  2  1800 e4          		retlw	E4h			
000603  2  1800 0           		retlw	00h		
000604  2  1800 0           		retlw	00h			
000605  2  1800 0           		retlw	00h 
000606  2  1800 e4          		retlw	E4h;E3h			;	check ctrl space
000607  2  1800 0           		retlw	00h
000608  2  1800 0           		retlw	00h
000609  2  1800 0           		retlw	00h
00060A  2  1800 e3          		retlw	E3h;E6h			;	check command space
00060B  2  1800 0           		retlw	00h
00060C  2  1800 0           		retlw	00h									
00060D  2  1800 0           		retlw	00h
00060E  2  1800 e6          		retlw	E6h	;00h
00060F  2  1800 0           		retlw	00h
000610  2  1800 0           		retlw	00h		 	 
000611  2  1800 0           		retlw	00h
000612  2  1800 0           		retlw	00h
000613  2  1800 0           		retlw	00h
000614  2  1800 0           		retlw	00h
000615  2  1800 0           		retlw	00h
000616  2  1800 e1          		retlw	E1h		;	switch to single char country lang
000617  2  1800 0           		retlw	00h
000618  2  1800 0           		retlw	00h
000619  2  1800 0           		retlw	00h
00061A  2  1800 e4          		retlw	E4h	;00h	;delay
00061B  2  1800 0           		retlw	00h
00061C  2  1800 0           		retlw	00h
00061D  2  1800 0           		retlw	00h
00061E  2  1800 0           		retlw	00h
00061F  2  1800 16          		retlw	16h	;	's'
000620  2  1800 0           		retlw	00h
000621  2  1800 0           		retlw	00h
000622  2  1800 0           		retlw	00h;E4h;00h
000623  2  1800 0           		retlw	00h
000624  2  1800 0           		retlw	00h		
000625  2  3000 584         		goto	ChooseLanguageKey    
000626  2  1800 0           		retlw	00h
000627  2  1800 0           		retlw	00h
000628  2  1800 0           		retlw	00h;E4h;00h
000629  2  1800 0           		retlw	00h
00062A  2  1800 0           		retlw	00h
00062B  2  1800 9           		retlw	09h	;	'f'
00062C  2  1800 0           		retlw	00h
00062D  2  1800 0           		retlw	00h
00062E  2  1800 0           		retlw	00h;E4h;00h
00062F  2  1800 0           		retlw	00h
000630  2  1800 0           		retlw	00h
000631  2  3000 584         		goto	ChooseLanguageKey
000632  2  1800 0           		retlw	00h
000633  2  1800 0           		retlw	00h
000634  2  1800 0           		retlw	00h;E4h;00h
000635  2  1800 0           		retlw	00h
000636  2  1800 0           		retlw	00h
000637  2  1800 15          		retlw	15h ;	'r'
000638  2  1800 0           		retlw	00h
000639  2  1800 0           		retlw	00h
00063A  2  1800 0           		retlw	00h;E4h;00h
00063B  2  1800 0           		retlw	00h
00063C  2  1800 0           		retlw	00h
00063D  2  1800 c           		retlw	0ch	;	'i'
00063E  2  1800 0           		retlw	00h	
00063F  2  1800 0           		retlw	00h
000640  2  1800 e4          		retlw	E4h;00h
000641  2  1800 0           		retlw	00h
000642  2  1800 0           		retlw	00h			 
000643  2  1800 0           		retlw	00h;28h	;	enter							
000644  2  1800 0           		retlw	00h
000645  2  1800 e4          		retlw	E4h;00h
000646  2  1800 0           		retlw	00h		
000647  2  1800 0           		retlw	00h
000648  2  1800 0           		retlw	00h
000649  2  1800 0           		retlw	00h		
00064A  2  1800 28          		retlw	28h;00h
00064B  2  1800 0           		retlw	00h
00064C  2  1800 0           		retlw	00h
00064D  2  1800 0           		retlw	00h	
00064E  2  1800 e4          		retlw	E4h;00h
00064F  2  1800 0           		retlw	00h
000650  2  1800 0           		retlw	00h		
000651  2                   		;retlw	00h
000651  2                   		;retlw	00h
000651  2                   		;retlw	00h
000651  2                   		;retlw	00h
000651  2                   		;retlw	00h			
000651  2                   		;retlw	00h		
000651  2                   		;retlw	00h
000651  2                   		;retlw	00h
000651  2                   		;retlw	00h		
000651  2                   		;retlw	00h		
000651  2  1800 e5          		retlw	E5h ;	safari bar selection		
000652  2  1800 0           		retlw	00h
000653  2  1800 e5          		retlw	E5h	;	safari bar selection
000654  2  1800 0           		retlw	00h
000655  2  1800 0           		retlw	00h		
000656  2                   		;retlw	E4h	;lock leds 				 		
000656  2                   		;retlw	00h
000656  2                   	
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	E1h	;Control+Space
000656  2                   		;retlw	E4h
000656  2                   		;retlw	00h
000656  2                   		;retlw	16h	;s
000656  2                   		;retlw	E4h
000656  2                   		;retlw	00h
000656  2                   		;goto	ChooseLanguageKey;retlw	04h	;a
000656  2                   		;retlw	E4h
000656  2                   		;retlw	00h
000656  2                   		;retlw	09h	;f
000656  2                   		;retlw	E4h
000656  2                   		;retlw	00h
000656  2                   		;goto	ChooseLanguageKey;retlw	04h	;a
000656  2                   		;retlw	E4h
000656  2                   		;retlw	00h
000656  2                   		;retlw	15h	;r
000656  2                   		;retlw	E4h
000656  2                   		;retlw	00h
000656  2                   		;retlw	0ch	;i
000656  2                   		;retlw	E4h
000656  2                   		;retlw	00h
000656  2                   		;retlw	28h
000656  2                   		;retlw	E4h
000656  2                   		;retlw	00h
000656  2                   		;retlw	E4h
000656  2                   		;retlw	00h
000656  2                   		;retlw	E4h
000656  2                   		;retlw	00h		
000656  2                   		;retlw	00h			
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	E4h
000656  2                   		;retlw	00h
000656  2                   		;retlw	E2h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	E4h
000656  2                   		;retlw	00h
000656  2                   		;retlw	2ch
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   	MacArray_end:
000656  2                   .ENDTABLE
000656  2                   
000656  2                   ;.TABLE
000656  2                   ;GetKeyValuePro_Mac1:
000656  2                   ;		addwf	Pcl,F
000656  2                   ;	MacArray_start1:
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   		;retlw	00h
000656  2                   ;		retlw	E1h
000656  2                   ;		retlw	00h
000656  2                   ;		retlw	51h
000656  2                   ;		retlw	00h
000656  2                   		;retlw	51h
000656  2                   		;retlw	00h
000656  2                   ;		retlw	52h
000656  2                   ;		retlw	00h
000656  2                   		;retlw	52h
000656  2                   		;retlw	00h
000656  2                   ;		retlw	51h
000656  2                   ;		retlw	00h
000656  2                   ;		retlw	51h
000656  2                   ;		retlw	28h
000656  2                   ;		retlw	00h
000656  2                   		;retlw	29h
000656  2                   		;retlw	00h
000656  2                   		;retlw	29h
000656  2                   		;retlw	00h
000656  2                   ;		retlw	29h
000656  2                   ;		retlw	00h
000656  2                   ;		retlw	29h
000656  2                   ;		retlw	00h
000656  2                   ;		retlw	29h
000656  2                   ;		retlw	00h
000656  2                   ;		retlw	29h
000656  2                   ;		retlw	00h
000656  2                   ;		retlw	E2h
000656  2                   ;		retlw	00h
000656  2                   ;		retlw	E2h
000656  2                   ;		retlw	00h
000656  2                   ;		retlw	2ch
000656  2                   ;		retlw	00h
000656  2                   ;	MacArray_end1:
000656  2                   ;.ENDTABLE
000656  2                   ;================================================================================
000656  2                   PrepareData_Win:
000656  2  1600 2b,2        		btfss	DataInFlag1
000657  2  0040             		ret
000658  2  1400 2a,2        		btfsc	OneFlag
000659  2  0040             		ret
00065A  2  1200 2a,3        		bsf	TransFlag
00065B  2  1200 2a,2        		bsf	OneFlag
00065C  2  1400 2a,4        		btfsc	PlugFlag
00065D  2  0040             		ret
00065E  2  0800 50          		movfw	ScanNumber
00065F  2  2000 69d         		call	GetKeyValuePro_WinA
000660  2  0080 55          		movwf	UsbKeyBuffer2
000661  2  1900 e1          		movlw	E1h
000662  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000663  2  1600 3,2         		btfss	Zero
000664  2  3000 668         		goto	NormalKeyValue1_Win
000665  2  2000 6bc         		call	Get_LedState
000666  2  0A00 50,1        		incf	ScanNumber,F
000667  2  0040             		ret
000668  2                   	NormalKeyValue1_Win:
000668  2  1900 e2          		movlw	E2h					;gui+'R'
000669  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
00066A  2  1600 3,2         		btfss	Zero
00066B  2  3000 672         		goto	NormalKeyValue2_Win
00066C  2  1900 8           		movlw	08h
00066D  2  0080 54          		movwf	UsbKeyBuffer0
00066E  2  1900 15          		movlw	15h
00066F  2  0080 55          		movwf	UsbKeyBuffer2
000670  2  0A00 50,1        		incf	ScanNumber,F
000671  2  0040             		ret
000672  2                   	NormalKeyValue2_Win:
000672  2  1900 e3          		movlw	E3h					;shift+end
000673  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000674  2  1600 3,2         		btfss	Zero
000675  2  3000 67c         		goto	NormalKeyValue02_Win
000676  2  1900 2           		movlw	02h;08h;
000677  2  0080 54          		movwf	UsbKeyBuffer0
000678  2  1900 4d          		movlw	4dh;00h;
000679  2  0080 55          		movwf	UsbKeyBuffer2
00067A  2  0A00 50,1        		incf	ScanNumber,F
00067B  2  0040             		ret
00067C  2                   	NormalKeyValue02_Win:
00067C  2  1900 e5          		movlw	E5h
00067D  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
00067E  2  1600 3,2         		btfss	Zero
00067F  2  3000 683         		goto	NormalKeyValue03_Win
000680  2  2000 6c3         		call	Set_LedState			;detect led status and let NumLock and CapsLock on
000681  2  0A00 50,1        		incf	ScanNumber,F
000682  2  0040             		ret
000683  2                   	NormalKeyValue03_Win:
000683  2  1900 e6          		movlw	E6h
000684  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000685  2  1600 3,2         		btfss	Zero
000686  2  3000 691         		goto	NormalKeyValue04_Win
000687  2  1900 c           		movlw	0ch
000688  2  0600 3d,0        		xorwf	getstring2counter,W
000689  2  1600 3,2         		btfss	Zero
00068A  2  3000 68e         		goto	$+4						;if getstring2counter!=0ch, incf and ret
00068B  2  1900 2           		movlw	02h
00068C  2  0200 7e,0        		subwf	Setreportcount,W
00068D  2  1400 3,0         		btfsc	Carry
00068E  2                   		;goto	WaitforLangSwitch_win
00068E  2                   		
00068E  2                   		;movfw   UsbLedDataTemp
00068E  2                   		;andlw   02h
00068E  2                   		;btfss	Zero		
00068E  2  0A00 50,1        		incf	ScanNumber,F		
00068F  2  0180 55          		clrf	UsbKeyBuffer2			;remember use specific char like 'E6', must be clear value before sent
000690  2  0040             		ret		
000691  2                   	NormalKeyValue04_Win:
000691  2  0180 54          		clrf	UsbKeyBuffer0
000692  2  0A00 50,1        		incf	ScanNumber,F
000693  2  1900 1e          		movlw	WinWebLength
000694  2  0200 50,0        		subwf	ScanNumber,W
000695  2  1600 3,0         		btfss	Carry
000696  2  0040             		ret
000697  2  0180 50          		clrf	ScanNumber
000698  2  1000 25,0        		bcf	GUIFlag
000699  2  1000 2a,1        		bcf	EndTransFlag
00069A  2  1000 2b,2        		bcf	DataInFlag1
00069B  2  1000 2a,2        		bcf	OneFlag
00069C  2  0040             		ret
00069D  2                   
00069D  2                   ;==================================================================================
00069D  2                   .TABLE
00069D  2                   GetKeyValuePro_WinA:
00069D  2  0700 2,1         		addwf	Pcl,F
00069E  2                   	WinArray_startA:
00069E  2                   		;retlw	E1h	;get leds state
00069E  2  1800 0           		retlw	00h	;ICH6 specific
00069F  2  1800 0           		retlw	00h	;checking point
0006A0  2  1800 0           		retlw	00h
0006A1  2  1800 0           		retlw	00h
0006A2  2  1800 0           		retlw	00h
0006A3  2  1800 0           		retlw	00h
0006A4  2  1800 0           		retlw	00h
0006A5  2  1800 0           		retlw	00h
0006A6  2  1800 0           		retlw	00h
0006A7  2  1800 0           		retlw	00h
0006A8  2  1800 0           		retlw	00h
0006A9  2  1800 e6          		retlw	E6h	;ICH6 specific
0006AA  2  1800 0           		retlw	00h
0006AB  2  1800 0           		retlw	00h
0006AC  2  1800 0           		retlw	00h	
0006AD  2  1800 0           		retlw	00h
0006AE  2  1800 0           		retlw	00h
0006AF  2  1800 e5          		retlw	E5h	;set leds state
0006B0  2  1800 0           		retlw	00h
0006B1  2  1800 0           		retlw	00h
0006B2  2  1800 0           		retlw	00h	;E3h
0006B3  2  1800 e2          		retlw	E2h	;win+r
0006B4  2  1800 0           		retlw	00h	;E3h;
0006B5  2  1800 4a          		retlw	4Ah	;homeE2h;
0006B6  2  1800 0           		retlw	00h	;E3h;
0006B7  2  1800 e3          		retlw	E3h	;shift+end E2h;
0006B8  2  1800 0           		retlw	00h	
0006B9  2  1800 2a          		retlw	2Ah	;back space
0006BA  2  1800 0           		retlw	00h
0006BB  2  1800 0           		retlw	00h
0006BC  2                   
0006BC  2                   	WinArray_endA:
0006BC  2                   .ENDTABLE
0006BC  2                   ;==============================================================================
0006BC  2                   ;Function:Get_LedState
0006BC  2                   ;Get leds state
0006BC  2                   ;==============================================================================
0006BC  2                   Get_LedState:
0006BC  2  1900 0           		movlw	00h
0006BD  2  0080 54          		movwf	UsbKeyBuffer0
0006BE  2  0080 55          		movwf	UsbKeyBuffer2
0006BF  2  0080 57          		movwf	UsbKeyBuffer4
0006C0  2  1900 39          		movlw	39h				;CapsLock
0006C1  2  0080 56          		movwf	UsbKeyBuffer3
0006C2  2  0040             		ret
0006C3  2                   ;==============================================================================
0006C3  2                   ;Function:Set_LedState
0006C3  2                   ;Enable capslock&numlock
0006C3  2                   ;==============================================================================
0006C3  2                   Set_LedState:
0006C3  2  1900 0           		movlw	00h
0006C4  2  0080 58          		movwf	KeyPress0
0006C5  2  0080 59          		movwf	KeyPress1
0006C6  2  0080 5a          		movwf	KeyPress2
0006C7  2  0080 54          		movwf   UsbKeyBuffer0
0006C8  2  0080 55          		movwf   UsbKeyBuffer2
0006C9  2  0080 56          		movwf   UsbKeyBuffer3
0006CA  2  0080 57          		movwf   UsbKeyBuffer4
0006CB  2  0080 69          		movwf	UsbKeyBuffer5
0006CC  2                   
0006CC  2  0800 3b          		movfw   UsbLedDataTemp
0006CD  2  1B00 1           		andlw   01h
0006CE  2  1600 3,2         		btfss	Zero
0006CF  2  3000 6d3         		goto	LockState2
0006D0  2  1900 53          		movlw   53h				;NumLock
0006D1  2  0080 58          		movwf	KeyPress0
0006D2  2  0080 56          		movwf	UsbKeyBuffer3
0006D3  2                   	LockState2:
0006D3  2  0800 3b          		movfw   UsbLedDataTemp
0006D4  2  1B00 2           		andlw   02h
0006D5  2  1600 3,2         		btfss	Zero
0006D6  2  3000 6dc         		goto	LockState3
0006D7  2  1900 39          		movlw   39h				;CapsLock
0006D8  2  1400 2e,5        		btfsc AndroidOSFlag		;URL must use with lower case letter in Android
0006D9  2  1900 0           		movlw	00h
0006DA  2  0080 59          		movwf	KeyPress1
0006DB  2  0080 57          		movwf	UsbKeyBuffer4
0006DC  2                   	LockState3:
0006DC  2  0800 3b          		movfw   UsbLedDataTemp
0006DD  2  1B00 4           		andlw   04h
0006DE  2  1400 3,2         		btfsc	Zero
0006DF  2  3000 6e3         		goto	LockState4
0006E0  2  1900 47          		movlw   47h				;Scroll Lock
0006E1  2  0080 5a          		movwf	KeyPress2
0006E2  2  0080 69          		movwf	UsbKeyBuffer5
0006E3  2                   	LockState4:
0006E3  2  0040             		ret
0006E4  2                   
0006E4  2                   ;==============================================================================
0006E4  2                   ;Function:Restore_LedState
0006E4  2                   ;restore leds state
0006E4  2                   ;==============================================================================
0006E4  2                   Restore_LedState:
0006E4  2  0180 54          		clrf    UsbKeyBuffer0
0006E5  2  0800 58          		movfw   KeyPress0
0006E6  2  0080 55          		movwf	UsbKeyBuffer2
0006E7  2                   	;	movlw	00h
0006E7  2                   	;	testz   KeyPress1
0006E7  2                   	;	btfsc	Zero
0006E7  2                   	;	movlw	39h
0006E7  2  0800 59          		movfw	KeyPress1
0006E8  2  0080 56          		movwf	UsbKeyBuffer3
0006E9  2  0800 5a          		movfw   KeyPress2
0006EA  2  0080 57          		movwf	UsbKeyBuffer4
0006EB  2  0040                  		ret
0006EC  2                   
0006EC  2                   ;==============================================================================
0006EC  2                   ;Function:LockLedState
0006EC  2                   ;Lock leds state
0006EC  2                   ;==============================================================================
0006EC  2                   ;LockLedState:
0006EC  2                   		;btfsc	RestorLedsFlag
0006EC  2                   		;bcf	DataOKFlag
0006EC  2                   		;bcf	RestorLedsFlag
0006EC  2                   		;clrf    UsbKeyBuffer0
0006EC  2                   		;clrf    UsbKeyBuffer4
0006EC  2                   		;movlw   53h
0006EC  2                   		;movwf	UsbKeyBuffer2
0006EC  2                   		;movlw   39h
0006EC  2                   		;movwf	UsbKeyBuffer3
0006EC  2                   		;ret
0006EC  2                   ;==============================================================================
0006EC  2                   ;Function:DataTransfer
0006EC  2                   ;Transfer data from the buffer to bus
0006EC  2                   ;==============================================================================
0006EC  2                   
0006EC  2                   DataTransfer1:
0006EC  2  1400 2a,3        		btfsc	TransFlag
0006ED  2  3000 6ef         		goto	SendDataReport
0006EE  2  0040             		ret
0006EF  2                     SendDataReport:
0006EF  2  1400 15,7          		btfsc	Tx1Rdy
0006F0  2  0040               		ret
0006F1  2                   		
0006F1  2  1900 1           		movlw	01h
0006F2  2  1E00 58          		movwr	Tx1FifoReg0
0006F3  2                   		
0006F3  2  0800 54            		movfw	UsbKeyBuffer0
0006F4  2  1E00 59            		movwr	Tx1FifoReg1;Tx1FifoReg0
0006F5  2  0800 55            		movfw	UsbKeyBuffer2
0006F6  2  1E00 5b            		movwr	Tx1FifoReg3;Tx1FifoReg2
0006F7  2  0800 56            		movfw	UsbKeyBuffer3
0006F8  2  1E00 5c            		movwr	Tx1FifoReg4;Tx1FifoReg3
0006F9  2  0800 57            		movfw	UsbKeyBuffer4
0006FA  2  1E00 5d            		movwr	Tx1FifoReg5;Tx1FifoReg4
0006FB  2  1900 0             		movlw	00h
0006FC  2                     		;movwr	Tx1FifoReg1
0006FC  2                     		;movwr	Tx1FifoReg5
0006FC  2  1E00 5e            		movwr	Tx1FifoReg6
0006FD  2  1E00 5f            		movwr	Tx1FifoReg7
0006FE  2  0080 56            		movwf	UsbKeyBuffer3
0006FF  2  0080 57            		movwf	UsbKeyBuffer4
000700  2                   
000700  2  1900 f0           		movlw	f0h
000701  2  0500 15,1         		andwf	Tx1Reg,F
000702  2  1900 8            		movlw	08h
000703  2  0400 15,1        		iorwf	Tx1Reg,F
000704  2  1900 40          		movlw	40h
000705  2  0600 15,1        		xorwf	Tx1Reg,F
000706  2  1200 15,7        		bsf	Tx1Rdy
000707  2                   
000707  2                   		;call	DelaySendKeyRoutine
000707  2                   		
000707  2  1000 2a,2        		bcf	OneFlag
000708  2  1000 2a,3          		bcf	TransFlag
000709  2  1400 2a,7          		btfsc	WinRFlag
00070A  2  3000 756           		goto	EnterDelay200ms
00070B  2  1400 2b,0          		btfsc	EnterFlag
00070C  2  3000 756           		goto	EnterDelay200ms
00070D  2                   
00070D  2  1900 28          		movlw	28h
00070E  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
00070F  2  1600 3,2         		btfss	Zero
000710  2  3000 716         		goto	JudgeDelay
000711  2  1400 2a,1        		btfsc	EndTransFlag
000712  2  3000 715         		goto	$+3
000713  2  1200 2a,1        		bsf	EndTransFlag
000714  2  3000 74d         		goto	EnterDelay
000715  2  1000 23,4        		bcf	DataOKFlag
000716  2                   	JudgeDelay:
000716  2  1900 8           		movlw	08h
000717  2  0600 54,0        		xorwf	UsbKeyBuffer0,W
000718  2  1600 3,2         		btfss	Zero
000719  2  3000 72d         		goto	JudgeCtrlF3
00071A  2  1900 15          		movlw	15h				;'R'
00071B  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
00071C  2  1400 3,2         		btfsc	Zero
00071D  2  3000 72a         		goto	DelayPro
00071E  2  1900 f           		movlw	0fh				;'L'
00071F  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000720  2  1400 3,2         		btfsc	Zero
000721  2  3000 72a         		goto	DelayPro
000722  2  1900 2b          		movlw	2bh				;'tab'
000723  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000724  2  1400 3,2         		btfsc	Zero
000725  2  3000 72a         		goto	DelayPro
000726  2  1900 1a          		movlw	1ah				;'W'
000727  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000728  2  1600 3,2         		btfss	Zero
000729  2  3000 72d         		goto	JudgeCtrlF3
00072A  2                   	DelayPro:
00072A  2  1200 2a,7        		bsf	WinRFlag
00072B  2  0180 3e          		clrf	TimerRollOver
00072C  2  3000 74a         		goto	NoEnterOrWinL
00072D  2                   JudgeCtrlF3:
00072D  2  1900 1           		movlw	01h
00072E  2  0600 54,0        		xorwf	UsbKeyBuffer0,W
00072F  2  1600 3,2         		btfss	Zero
000730  2  3000 734         		goto	JudgeCommShiftA
000731  2  1200 2a,7        		bsf	WinRFlag
000732  2  0180 3e          		clrf	TimerRollOver
000733  2  3000 74a         		goto	NoEnterOrWinL
000734  2                   JudgeCommShiftA:
000734  2  1900 a           		movlw	0ah
000735  2  0600 54,0        		xorwf	UsbKeyBuffer0,W
000736  2  1600 3,2         		btfss	Zero
000737  2  3000 73f         		goto	JudgeEnter
000738  2  1900 4           		movlw	04h
000739  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
00073A  2  1600 3,2         		btfss	Zero
00073B  2  3000 73f         		goto	JudgeEnter
00073C  2  1200 2a,7        		bsf	WinRFlag
00073D  2  0180 3e          		clrf	TimerRollOver
00073E  2  3000 74a         		goto	NoEnterOrWinL
00073F  2                   JudgeEnter:
00073F  2  1900 0           		movlw	00h
000740  2  0600 54,0        		xorwf	UsbKeyBuffer0,W
000741  2  1600 3,2         		btfss	Zero
000742  2  3000 74a         		goto	NoEnterOrWinL
000743  2  1900 fe          		movlw	FEh
000744  2  0500 55,0        		andwf	UsbKeyBuffer2,W
000745  2  1D00 28          		xorlw	28h
000746  2  1600 3,2         		btfss	Zero
000747  2  3000 74a         		goto	NoEnterOrWinL
000748  2  1200 2a,7        		bsf	WinRFlag
000749  2  0180 3e          		clrf	TimerRollOver
00074A  2                   NoEnterOrWinL:
00074A  2  0180 54          		clrf	UsbKeyBuffer0
00074B  2  0180 55            		clrf	UsbKeyBuffer2
00074C  2  0040               		ret
00074D  2                   EnterDelay:
00074D  2  1400 24,2        		btfsc	OSType
00074E  2  0040             		ret
00074F  2  1200 2b,0        		bsf	EnterFlag
000750  2  0180 3e          		clrf	TimerRollOver
000751  2  1900 2           		movlw	02h
000752  2  1600 25,7        		btfss	MacVerFlag
000753  2  1900 0           		movlw	00h
000754  2  0080 70          		movwf	TimerCountH
000755  2  0040             		ret
000756  2                   	EnterDelay200ms:
000756  2  1200 2a,4        		bsf	PlugFlag
000757  2  1900 40          		movlw	40h;f0h
000758  2  1400 2a,7        		btfsc	WinRFlag
000759  2  1900 20          		movlw	20h;34h
00075A  2  0200 3e,0        		subwf	TimerRollOver,W
00075B  2  1600 3,0         		btfss	Carry
00075C  2  0040             		ret
00075D  2  0880 70          		testz	TimerCountH
00075E  2  1600 3,2         		btfss	Zero
00075F  2  3000 764         		goto	$+5
000760  2  1000 2b,0        		bcf	EnterFlag
000761  2  1000 2a,7        		bcf	WinRFlag
000762  2  1000 2a,4        		bcf	PlugFlag
000763  2  0040             		ret
000764  2  0300 70,1        		decf	TimerCountH,F
000765  2  0180 3e          		clrf	TimerRollOver
000766  2  0040             		ret
000767  2                   ;==============================================================================
000767  2                   ;Function:PrepareDataTask
000767  2                   ;  1.Prepare data to usb buffer
000767  2                   ;  2.judge key press or release
000767  2                   ;==============================================================================
000767  2                   PrepareDataTask:
000767  2                   
000767  2  1600 24,2        		btfss	OSType
000768  2  3000 7e0         		goto	PrepareDataTask_Mac
000769  2                   
000769  2                   	PrepareDataTask_Win:
000769  2                   		;btfsc	MoreOnceAltFlag
000769  2                   		;ret
000769  2  1600 23,4        		btfss	DataOKFlag
00076A  2  0040             		ret						;no key press
00076B  2  1400 2a,2        		btfsc	OneFlag			;if this flag is 1, send alt+key, else send alt only
00076C  2  0040             		ret
00076D  2                   
00076D  2  1900 2           		movlw	UsbReport
00076E  2  0080 5c          		movwf	UsbRequireState
00076F  2  1200 2a,2        		bsf	OneFlag
000770  2                   
000770  2  1400 2a,5        		btfsc	WinTransAscII
000771  2  3000 7ce         		goto	PrepareData_Ascii
000772  2  1400 2a,6        		btfsc	RestorLedsFlag
000773  2  3000 7db         		goto	PrepareData_Leds
000774  2                   
000774  2  0880 53          		testz	ReadURLTime
000775  2  1600 3,2         		btfss	Zero
000776  2  2000 814         		call	ReceiveNtimeData	;receive 64 data (URL)
000777  2                   
000777  2  1900 40          		movlw	ReadBuffer
000778  2  0080 4                		movwf	Fsr
000779  2  0800 52               		movfw	EndMaxURL40h
00077A  2                   
00077A  2  0700 4,1              		addwf	Fsr,F
00077B  2  1200 3,5              		bsf	RamBank
00077C  2  0800 0                		movfw	Indf
00077D  2  1000 3,5              		bcf	RamBank
00077E  2  0080 3c               		movwf	WorkReg
00077F  2  0A00 52,1             		incf	EndMaxURL40h,F		;transmit 64 times data
000780  2                   
000780  2  1900 1                		movlw	01h
000781  2  0700 51,1        		addwf	TempCount,F
000782  2                   
000782  2                   NormalKeyValuePro_Win:
000782  2  0800 3c               		movfw	WorkReg
000783  2  0080 5d               		movwf	WorkRegTemp
000784  2  0080 55               		movwf	UsbKeyBuffer2
000785  2                   
000785  2  1900 0           		movlw	00h
000786  2  0080 5e          		movwf	AsciiMSC
000787  2  0080 5f          		movwf	AsciiMID
000788  2  0080 60          		movwf	AsciiLSC
000789  2                   
000789  2  1900 2           		movlw	02h
00078A  2  0080 5e          		movwf	AsciiMSC
00078B  2  1900 c8          		movlw	200d
00078C  2  0200 5d,0        		subwf	WorkRegTemp,W
00078D  2  0080 3c          		movwf	WorkReg
00078E  2  1400 3,0         		btfsc	Carry
00078F  2  3000 79b         		goto	NormalKeyValue_Win
000790  2  1900 1           		movlw	01h
000791  2  0080 5e          		movwf	AsciiMSC
000792  2  1900 64          		movlw	100d
000793  2  0200 5d,0        		subwf	WorkRegTemp,W
000794  2  0080 3c          		movwf	WorkReg
000795  2  1400 3,0         		btfsc	Carry
000796  2  3000 79b         		goto	NormalKeyValue_Win
000797  2  0800 5d          		movfw	WorkRegTemp
000798  2  0080 3c          		movwf	WorkReg
000799  2  1900 0           		movlw	00h
00079A  2  0080 5e          		movwf	AsciiMSC
00079B  2                   
00079B  2                   	NormalKeyValue_Win:
00079B  2  0800 3c          		movfw	WorkReg
00079C  2  2000 980         		call	HexToDecTable
00079D  2  0080 5d          		movwf	WorkRegTemp
00079E  2  1900 f           		movlw	0fh
00079F  2  0500 5d,0        		andwf	WorkRegTemp,W
0007A0  2  0080 60          		movwf	AsciiLSC
0007A1  2  0E00 5d,1        		swapf	WorkRegTemp,F
0007A2  2  1900 f           		movlw	0fh
0007A3  2  0500 5d,0        		andwf	WorkRegTemp,W
0007A4  2  0080 5f          		movwf	AsciiMID
0007A5  2                   
0007A5  2  0800 5e          		movfw	AsciiMSC
0007A6  2  2000 7c3         		call	KeypadTable
0007A7  2  0080 5e          		movwf	AsciiMSC
0007A8  2  0800 5f          		movfw	AsciiMID
0007A9  2  2000 7c3         		call	KeypadTable
0007AA  2  0080 5f          		movwf	AsciiMID
0007AB  2  0800 60          		movfw	AsciiLSC
0007AC  2  2000 7c3         		call	KeypadTable
0007AD  2  0080 60          		movwf	AsciiLSC
0007AE  2                   
0007AE  2  1900 4           		movlw	04h
0007AF  2  0080 54          		movwf	UsbKeyBuffer0
0007B0  2  1900 1           		movlw	01h
0007B1  2  0080 50          		movwf	ScanNumber
0007B2  2  1200 2a,5        		bsf	WinTransAscII
0007B3  2                   ExitPreDataPro_Win:
0007B3  2                   		;movfw	TempCount
0007B3  2                   		;movwf	TempReg
0007B3  2                   
0007B3  2                   		;movfw	MaxURLLength
0007B3  2  0800 7b          		movfw	URLAddressLen
0007B4  2  1600 2c,4        		btfss	urladd1forenter
0007B5  2  0080 76          		movwf	URLLenTemp
0007B6  2  1200 2c,4        		bsf		urladd1forenter
0007B7  2  0300 76,1        		decf	URLLenTemp,F
0007B8  2                   		;subwf	TempReg,W
0007B8  2  1400 3,2         		btfsc	Zero
0007B9  2  3000 7bd         		goto	TransmitENTERData_Win
0007BA  2  0800 5e          		movfw	AsciiMSC		;send MSC of the transfered data
0007BB  2  0080 55          		movwf	UsbKeyBuffer2
0007BC  2  0040             		ret
0007BD  2                   		
0007BD  2                   
0007BD  2                   	JudgeTransmitLength_Win:
0007BD  2                   		;btfsc	Zero
0007BD  2                   		;goto	DetectDataISZero_Win
0007BD  2                   		;btfss	Carry
0007BD  2                   		;goto	DetectDataISZero_Win
0007BD  2                   		;goto	TransmitENTERData_Win
0007BD  2                   
0007BD  2                   DetectDataISZero_Win:
0007BD  2                   		;testz	UsbKeyBuffer2
0007BD  2                   		;btfsc	Zero			;if 0,send enter key
0007BD  2                   		;goto	TransmitENTERData_Win
0007BD  2                   		;movlw	ffh
0007BD  2                   		;xorwf	UsbKeyBuffer2,W
0007BD  2                   		;btfsc	Zero
0007BD  2                   		;goto	TransmitENTERData_Win
0007BD  2                   		
0007BD  2                   		;movfw	AsciiMSC		;send MSC of the transfered data
0007BD  2                   		;movwf	UsbKeyBuffer2
0007BD  2                   		;ret
0007BD  2                   
0007BD  2                   TransmitENTERData_Win:
0007BD  2  1900 0           		movlw	00h
0007BE  2  0080 54          		movwf	UsbKeyBuffer0
0007BF  2  1900 28          		movlw	28h
0007C0  2  0080 55          		movwf	UsbKeyBuffer2
0007C1  2  1000 2a,5        		bcf	WinTransAscII
0007C2  2  0040             		ret
0007C3  2                   
0007C3  2                   KeypadTable:
0007C3  2  0700 2,1         		addwf	Pcl,F
0007C4  2  1800 62          		retlw	62h
0007C5  2  1800 59          		retlw	59h
0007C6  2  1800 5a          		retlw	5ah
0007C7  2  1800 5b          		retlw	5bh
0007C8  2  1800 5c          		retlw	5ch
0007C9  2  1800 5d          		retlw	5dh
0007CA  2  1800 5e          		retlw	5eh
0007CB  2  1800 5f          		retlw	5fh
0007CC  2  1800 60          		retlw	60h
0007CD  2  1800 61          		retlw	61h
0007CE  2                   PrepareData_Ascii:
0007CE  2  1900 4           		movlw	04h			
0007CF  2  0080 54          		movwf	UsbKeyBuffer0
0007D0  2  0A00 50,1        		incf	ScanNumber,F
0007D1  2  0800 5f          		movfw	AsciiMID		;send MID of the transfered data
0007D2  2  0080 55          		movwf	UsbKeyBuffer2
0007D3  2  1900 2           		movlw	02h
0007D4  2  0600 50,0        		xorwf	ScanNumber,W
0007D5  2  1400 3,2         		btfsc	Zero
0007D6  2  0040             		ret
0007D7  2  1000 2a,5        		bcf	WinTransAscII
0007D8  2                   		;bsf	MoreOnceAltFlag
0007D8  2  0800 60          		movfw	AsciiLSC		;send LSC of the transfered data
0007D9  2  0080 55          		movwf	UsbKeyBuffer2
0007DA  2  0040             		ret
0007DB  2                   PrepareData_Leds:
0007DB  2  1000 2a,1        		bcf	EndTransFlag
0007DC  2  1000 2a,6        		bcf	RestorLedsFlag
0007DD  2  2000 6e4         		call	Restore_LedState
0007DE  2  1000 23,4        		bcf	DataOKFlag
0007DF  2  0040             		ret
0007E0  2                   ;==================================================================
0007E0  2                   PrepareDataTask_Mac:
0007E0  2  1400 2a,7        		btfsc	WinRFlag
0007E1  2  0040             		ret
0007E2  2  1600 23,4        		btfss	DataOKFlag
0007E3  2  0040             		ret				;no key press
0007E4  2  1400 2a,2        		btfsc	OneFlag
0007E5  2  0040             		ret
0007E6  2                   
0007E6  2  1900 2           		movlw	UsbReport
0007E7  2  0080 5c          		movwf	UsbRequireState
0007E8  2  1200 2a,2        		bsf	OneFlag
0007E9  2                   
0007E9  2  0880 53          		testz	ReadURLTime
0007EA  2  1600 3,2         		btfss	Zero
0007EB  2  2000 814         		call	ReceiveNtimeData	;receive 64 data from 24C02
0007EC  2                   		
0007EC  2                   		
0007EC  2  1900 40          		movlw	ReadBuffer
0007ED  2  0080 4                		movwf	Fsr
0007EE  2  0800 52               		movfw	EndMaxURL40h
0007EF  2                   
0007EF  2                   
0007EF  2  0700 4,1              		addwf	Fsr,F
0007F0  2  1200 3,5              		bsf	RamBank
0007F1  2  0800 0                		movfw	Indf
0007F2  2  1000 3,5              		bcf	RamBank
0007F3  2  0080 3c               		movwf	WorkReg
0007F4  2  0080 54          			movwf	UsbKeyBuffer0
0007F5  2  0A00 52,1             		incf	EndMaxURL40h,F		;transmit 64 times data
0007F6  2                   
0007F6  2  1900 40          		movlw	ReadBuffer
0007F7  2  0080 4                		movwf	Fsr
0007F8  2  0800 52               		movfw	EndMaxURL40h
0007F9  2                   
0007F9  2  0700 4,1              		addwf	Fsr,F
0007FA  2  1200 3,5              		bsf	RamBank
0007FB  2  0800 0                		movfw	Indf
0007FC  2  1000 3,5              		bcf	RamBank
0007FD  2  0080 3c               		movwf	WorkReg
0007FE  2  0080 55          			movwf	UsbKeyBuffer2
0007FF  2  0A00 52,1             		incf	EndMaxURL40h,F		;transmit 64 times data
000800  2                   
000800  2  2000 587         		call	WaitSendNextURL
000801  2  1400 2e,7        		btfsc	SendKeyNotYetFlag
000802  2  0040             		ret
000803  2  1000 2e,7        		bcf		SendKeyNotYetFlag	
000804  2                   		
000804  2                   			;movlw	00h
000804  2                   			;movwf	UsbKeyBuffer0
000804  2                   			;movlw	1ah
000804  2                   			;movwf	UsbKeyBuffer2
000804  2                   			
000804  2                        	;	movlw	01h
000804  2                   		;addwf	TempCount,F
000804  2                   
000804  2                   		;call	Judge_CapitalPro
000804  2                   		;call	Judge_SymbolPro
000804  2                   
000804  2                   ;NormalKeyValuePro:
000804  2                        	;	movfw	WorkReg
000804  2                        	;	call	ASCIIChangeToUSBCode_US
000804  2                   		;movwf	UsbKeyBuffer2
000804  2                   
000804  2                   	;NormalKeyValue:
000804  2                   		;movlw	02h			;left shift
000804  2                   		;movwf	UsbKeyBuffer0
000804  2                   		;testz	Judge_Capital
000804  2                   		;btfsc	Zero
000804  2                   		;clrf	UsbKeyBuffer0
000804  2                   
000804  2                   ExitPreDataPro:
000804  2                   		;movfw	TempCount
000804  2                   		;movwf	TempReg
000804  2                   
000804  2                   		;movfw	MaxURLLength
000804  2                   		;subwf	TempReg,F
000804  2                   		
000804  2  0800 7d          		movfw	MacURLAddressLen
000805  2  1400 2e,5        			btfsc	AndroidOSFlag		;if OS is android
000806  2  0800 4f          			movfw	AndroidURLLength
000807  2  1600 2c,4        		btfss	urladd1forenter
000808  2  0080 76          		movwf	URLLenTemp
000809  2  1200 2c,4        		bsf		urladd1forenter
00080A  2  0300 76,1        		decf	URLLenTemp,F
00080B  2  0300 76,1        		decf	URLLenTemp,F
00080C  2  1400 3,2         		btfsc	Zero
00080D  2  3000 80f         		goto	TransmitENTERData
00080E  2  0040             		ret
00080F  2                   
00080F  2                   	JudgeTransmitLength:
00080F  2                   		;btfsc	Zero
00080F  2                   		;goto	DetectDataISZero
00080F  2                   		;btfss	Carry
00080F  2                   		;goto	DetectDataISZero
00080F  2                   		;goto	TransmitENTERData
00080F  2                   
00080F  2                   DetectDataISZero:
00080F  2                   		;testz	UsbKeyBuffer2
00080F  2                   		;btfsc	Zero			;if 0,send enter key
00080F  2                   		;goto	TransmitENTERData
00080F  2                   		;movlw	ffh
00080F  2                   		;xorwf	UsbKeyBuffer2,W
00080F  2                   		;btfss	Zero
00080F  2                   		;ret
00080F  2                   
00080F  2                   TransmitENTERData:
00080F  2  1900 0           		movlw	00h
000810  2  0080 54          		movwf	UsbKeyBuffer0
000811  2  1900 28          		movlw	28h
000812  2  0080 55          		movwf	UsbKeyBuffer2
000813  2  0040             		ret
000814  2                   ;_______________________________________________________________
000814  2                   
000814  2                   ReceiveNtimeData:		
000814  2  1900 1           		movlw	01h
000815  2  0600 6e,0        		xorwf	ReadI2CAddressH,W
000816  2  1400 3,2         		btfsc	Zero
000817  2  3000 820         		goto	Each64Loop;$+9;$+7
000818  2  0800 7a          		movfw	URLAddressIndex		;basically, beside first get 64 bytes data, every loop should not entry this branch
000819  2  1600 24,2        		btfss	OSType
00081A  2  0800 7c          		movfw	MacURLAddressIndex
00081B  2  1400 2e,5        			btfsc	AndroidOSFlag	;if OS is android
00081C  2  0800 4e          			movfw	AndroidURLIndex
00081D  2  0600 49,0        		xorwf	R_I2C_Address,W
00081E  2  1400 3,2         		btfsc	Zero
00081F  2  3000 826         		goto	ActualGet64;$+7
000820  2                   	Each64Loop:
000820  2  1900 40          		movlw	40h					;check 64 bytes/each read loop
000821  2  0600 52,0        		xorwf	EndMaxURL40h,W
000822  2  1600 3,2         		btfss	Zero
000823  2  0040             		ret
000824  2                   
000824  2                   
000824  2  0180 52          		clrf	EndMaxURL40h		;every 64 bytes, clear it for next 64bytes
000825  2  0300 53,1        		decf	ReadURLTime,F
000826  2                   		
000826  2                   
000826  2                   	ActualGet64:
000826  2                   ;		btfss	E2PROMFlag
000826  2                   ;		goto	$+8
000826  2                   ;		call	I2C_Receive_Nbyte_E2PROM512
000826  2                   ;		bcf		Carry
000826  2                   ;		movlw	40h
000826  2                   ;		addwf	R_I2C_Address,F
000826  2                   ;		btfsc	Carry
000826  2                   ;		incf	ReadI2CAddressH,F		
000826  2                   ;		ret	;goto	$+2
000826  2  1400 2e,5        		btfsc	AndroidOSFlag	;if OS is android
000827  2  3000 82a         		goto	 $+3
000828  2  2000 9e5         		call	Get64ByteInfo
000829  2  3000 82b         		goto	 $+2
00082A  2  2000 5b9         		call 	GetAndroid64URL
00082B  2                   		
00082B  2  0040             		ret
00082C  2                   ;_______________________________________________________________
00082C  2                   Judge_CapitalPro:
00082C  2  0180 61          		clrf	Judge_Capital		;small letter flag
00082D  2  1900 41          		movlw	41h
00082E  2  0200 3c,0        		subwf	WorkReg,W
00082F  2  1600 3,0         		btfss	Carry
000830  2  0040             		ret
000831  2                   
000831  2  1900 5b          		movlw	05ah+1
000832  2  0200 3c,0        		subwf	WorkReg,W
000833  2  1400 3,0         		btfsc	Carry
000834  2  0040             		ret
000835  2                   
000835  2  1900 1           		movlw	01h			;[41h~5ah] is capital
000836  2  0080 61          		movwf	Judge_Capital		;capital flag,must press SHIFT key
000837  2  0040             		ret
000838  2                   ;_______________________________________________________________
000838  2                   Judge_SymbolPro:
000838  2  0880 61          		testz	Judge_Capital
000839  2  1600 3,2         		btfss	Zero
00083A  2  0040             		ret
00083B  2                   
00083B  2  1900 7e               		movlw	7eh			;'~'
00083C  2  0600 3c,0             		xorwf	WorkReg,W
00083D  2  1400 3,2              		btfsc	Zero
00083E  2  3000 890         		goto	PressShiftKey
00083F  2                   
00083F  2  1900 21               		movlw	21h			;'!'
000840  2  0600 3c,0             		xorwf	WorkReg,W
000841  2  1400 3,2              		btfsc	Zero
000842  2  3000 890         		goto	PressShiftKey
000843  2                   
000843  2  1900 40               		movlw	40h			;'@'
000844  2  0600 3c,0             		xorwf	WorkReg,W
000845  2  1400 3,2              		btfsc	Zero
000846  2  3000 890         		goto	PressShiftKey
000847  2                   
000847  2  1900 23          		movlw	23h			;'#'
000848  2  0600 3c,0             		xorwf	WorkReg,W
000849  2  1400 3,2              		btfsc	Zero
00084A  2  3000 890         		goto	PressShiftKey
00084B  2                   
00084B  2  1900 24          		movlw	24h			;'$'
00084C  2  0600 3c,0             		xorwf	WorkReg,W
00084D  2  1400 3,2              		btfsc	Zero
00084E  2  3000 890         		goto	PressShiftKey
00084F  2                   
00084F  2  1900 25          		movlw	25h			;'%'
000850  2  0600 3c,0             		xorwf	WorkReg,W
000851  2  1400 3,2              		btfsc	Zero
000852  2  3000 890         		goto	PressShiftKey
000853  2                   
000853  2  1900 5e               		movlw	5eh			;'^'
000854  2  0600 3c,0             		xorwf	WorkReg,W
000855  2  1400 3,2              		btfsc	Zero
000856  2  3000 890         		goto	PressShiftKey
000857  2                   
000857  2  1900 26               		movlw	26h			;'&'
000858  2  0600 3c,0             		xorwf	WorkReg,W
000859  2  1400 3,2              		btfsc	Zero
00085A  2  3000 890         		goto	PressShiftKey
00085B  2                   
00085B  2  1900 2a          		movlw	2ah			;'*'
00085C  2  0600 3c,0             		xorwf	WorkReg,W
00085D  2  1400 3,2              		btfsc	Zero
00085E  2  3000 890         		goto	PressShiftKey
00085F  2                   
00085F  2  1900 28          		movlw	28h			;'('
000860  2  0600 3c,0             		xorwf	WorkReg,W
000861  2  1400 3,2              		btfsc	Zero
000862  2  3000 890         		goto	PressShiftKey
000863  2                   
000863  2  1900 29          		movlw	29h			;')'
000864  2  0600 3c,0             		xorwf	WorkReg,W
000865  2  1400 3,2              		btfsc	Zero
000866  2  3000 890         		goto	PressShiftKey
000867  2                   
000867  2  1900 5f               		movlw	5fh			;'_'
000868  2  0600 3c,0             		xorwf	WorkReg,W
000869  2  1400 3,2              		btfsc	Zero
00086A  2  3000 890         		goto	PressShiftKey
00086B  2                   
00086B  2  1900 2b               		movlw	2bh			;'+'
00086C  2  0600 3c,0             		xorwf	WorkReg,W
00086D  2  1400 3,2              		btfsc	Zero
00086E  2  3000 890         		goto	PressShiftKey
00086F  2                   
00086F  2  1900 7b          		movlw	7bh			;'{'
000870  2  0600 3c,0             		xorwf	WorkReg,W
000871  2  1400 3,2              		btfsc	Zero
000872  2  3000 890         		goto	PressShiftKey
000873  2                   
000873  2  1900 7d          		movlw	7dh			;'}'
000874  2  0600 3c,0             		xorwf	WorkReg,W
000875  2  1400 3,2              		btfsc	Zero
000876  2  3000 890         		goto	PressShiftKey
000877  2                   
000877  2  1900 3a          		movlw	3ah			;':'
000878  2  0600 3c,0             		xorwf	WorkReg,W
000879  2  1400 3,2              		btfsc	Zero
00087A  2  3000 890         		goto	PressShiftKey
00087B  2                   
00087B  2  1900 22               		movlw	22h			;'"'
00087C  2  0600 3c,0             		xorwf	WorkReg,W
00087D  2  1400 3,2              		btfsc	Zero
00087E  2  3000 890         		goto	PressShiftKey
00087F  2                   
00087F  2  1900 3c               		movlw	3ch			;'<'
000880  2  0600 3c,0             		xorwf	WorkReg,W
000881  2  1400 3,2              		btfsc	Zero
000882  2  3000 890         		goto	PressShiftKey
000883  2                   
000883  2  1900 3e          		movlw	3eh			;'>'
000884  2  0600 3c,0             		xorwf	WorkReg,W
000885  2  1400 3,2              		btfsc	Zero
000886  2  3000 890         		goto	PressShiftKey
000887  2                   
000887  2  1900 3f          		movlw	3fh			;'?'
000888  2  0600 3c,0             		xorwf	WorkReg,W
000889  2  1400 3,2              		btfsc	Zero
00088A  2  3000 890         		goto	PressShiftKey
00088B  2                   
00088B  2  1900 7c          		movlw	7ch			;'|'
00088C  2  0600 3c,0             		xorwf	WorkReg,W
00088D  2  1400 3,2              		btfsc	Zero
00088E  2  3000 890         		goto	PressShiftKey
00088F  2  0040             		ret
000890  2                   
000890  2                   	PressShiftKey:
000890  2  1900 1           		movlw	01h
000891  2  0080 61          		movwf	Judge_Capital
000892  2  0040             		ret
000893  2                   ;==============================================================================
000893  2                   ;Function:ReportTask
000893  2                   ;Send InOutBuffer data to Tx1FifoReg
000893  2                   ;==============================================================================
000893  2                   ReportTask:
000893  2  1900 0           		movlw	UsbNoReport				;send alt only or send clear txfifo
000894  2  0200 5c,0        		subwf	UsbRequireState,W
000895  2  1400 3,2         		btfsc	Zero
000896  2  3000 89c         		goto	SendstoppacketNow
000897  2                   
000897  2  1900 2           		movlw	UsbReport				;send alt+key
000898  2  0200 5c,0        		subwf	UsbRequireState,W		
000899  2  1400 3,2         		btfsc	Zero
00089A  2  3000 8b0         		goto	SendpacketNow
00089B  2  0040             		ret
00089C  2                   SendstoppacketNow:
00089C  2  1600 2b,1        		btfss	BreakFlag
00089D  2  0040             		ret
00089E  2                   
00089E  2  1400 15,7        		btfsc	Tx1Rdy			;is ready to prepare to send packet?
00089F  2  0040             		ret
0008A0  2                   		
0008A0  2  1900 1           		movlw	01h				;report id(1)
0008A1  2  1E00 58          		movwr	Tx1FifoReg0
0008A2  2                   		
0008A2  2  1900 0           		movlw	00h
0008A3  2  1400 2a,5        		btfsc	WinTransAscII		
0008A4  2  1900 4           		movlw	04h	
0008A5  2  1E00 59          		movwr	Tx1FifoReg1;Tx1FifoReg0		
0008A6  2  1900 0           		movlw	00h
0008A7  2                   		;movwr	Tx1FifoReg1
0008A7  2  1E00 5a          		movwr	Tx1FifoReg2
0008A8  2  1E00 5b          		movwr	Tx1FifoReg3
0008A9  2  1E00 5c          		movwr	Tx1FifoReg4
0008AA  2  1E00 5d          		movwr	Tx1FifoReg5
0008AB  2  1E00 5e          		movwr	Tx1FifoReg6
0008AC  2  1E00 5f          		movwr	Tx1FifoReg7
0008AD  2  1000 2b,1        		bcf	BreakFlag
0008AE  2  1000 2a,2        		bcf	OneFlag
0008AF  2  3000 8c0         		goto	SendReportNow
0008B0  2                   SendpacketNow:
0008B0  2  1400 15,7        		btfsc	Tx1Rdy			;is ready to prepare to send packet?
0008B1  2  0040             		ret
0008B2  2                   		
0008B2  2  1900 1           		movlw	01h
0008B3  2  1E00 58          		movwr	Tx1FifoReg0
0008B4  2                   		
0008B4  2  0800 54            		movfw	UsbKeyBuffer0
0008B5  2  1E00 59           		movwr	Tx1FifoReg1;Tx1FifoReg0
0008B6  2  0800 55            		movfw	UsbKeyBuffer2
0008B7  2  1E00 5b            		movwr	Tx1FifoReg3;Tx1FifoReg2
0008B8  2  0800 56            		movfw	UsbKeyBuffer3
0008B9  2  1E00 5c            		movwr	Tx1FifoReg4;Tx1FifoReg3
0008BA  2  0800 57            		movfw	UsbKeyBuffer4
0008BB  2  1E00 5d            		movwr	Tx1FifoReg5;Tx1FifoReg4
0008BC  2  1900 0             		movlw	00h
0008BD  2                     		;movwr	Tx1FifoReg1
0008BD  2                     		;movwr	Tx1FifoReg5
0008BD  2                     		;movwr	Tx1FifoReg6
0008BD  2                     		;movwr	Tx1FifoReg7
0008BD  2  0080 56            		movwf	UsbKeyBuffer3
0008BE  2  0080 57            		movwf	UsbKeyBuffer4
0008BF  2  1200 2b,1          		bsf	BreakFlag			;set 1 for send alt only between twice alt+key
0008C0  2                   
0008C0  2                   SendReportNow:
0008C0  2  1900 f0          		movlw	f0h
0008C1  2  0500 15,1        		andwf	Tx1Reg,F
0008C2  2  1900 8           		movlw	08h
0008C3  2  0400 15,1        		iorwf	Tx1Reg,F		;Endpoint1 transmit 8 byte
0008C4  2  1900 40          		movlw	40h
0008C5  2  0600 15,1        		xorwf	Tx1Reg,F
0008C6  2  1200 15,7        		bsf	Tx1Rdy
0008C7  2                   
0008C7  2                   		;call	DelaySendKeyRoutine
0008C7  2                   		
0008C7  2  1900 0           		movlw	UsbNoReport
0008C8  2                   		;btfsc	MoreOnceAltFlag
0008C8  2                   		;movlw	03h
0008C8  2  0080 5c          		movwf	UsbRequireState
0008C9  2                   
0008C9  2  1600 2a,1        		btfss	EndTransFlag
0008CA  2  3000 8d0         		goto	$+6
0008CB  2  1600 24,2        		btfss	OSType
0008CC  2  3000 8cf         		goto	$+3
0008CD  2  1200 2a,6        		bsf	RestorLedsFlag
0008CE  2  3000 8d0         		goto	$+2
0008CF  2  1000 23,4        		bcf	DataOKFlag
0008D0  2                   
0008D0  2  1900 28          		movlw	28h
0008D1  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
0008D2  2  1600 3,2         		btfss	Zero
0008D3  2  3000 8e0         		goto	clrbuff;$+7
0008D4  2                   		
0008D4  2  1200 2a,1        		bsf	EndTransFlag
0008D5  2  2000 af0         		call DelaySendKeyRoutine	;wait enter transfer out
0008D6  2  1400 24,2        		btfsc OSType
0008D7  2  3000 8e0         		goto clrbuff;$+4
0008D8  2                   		
0008D8  2  1000 2f,1        		bcf AndroidURLDoneFlag
0008D9  2  1600 2e,5        		btfss	AndroidOSFlag
0008DA  2  3000 8dd         		goto $+3	
0008DB  2  1200 2f,1        		bsf AndroidURLDoneFlag
0008DC  2  3000 8e0         		goto clrbuff	;ready to send third key
0008DD  2                   		
0008DD  2                   		
0008DD  2  1000 13,3        		bcf	DeviceR
0008DE  2  1E03             		sleep
0008DF  2  3000 8de         		goto $-1
0008E0  2                   clrbuff:
0008E0  2  0180 54          	  	clrf	UsbKeyBuffer0
0008E1  2  0180 55          		clrf	UsbKeyBuffer2
0008E2  2  0040             		ret
0008E3  2                   		
0008E3  2                   
0008E3  2                   
0008E3  2                   ;========================================================================
0008E3  2                   ;  This is the ASCII change to usb code
0008E3  2                   ;========================================================================
0008E3  2                   		org	0900h;org	0a00h
000900  2                   ;========================================================================
000900  2                   ASCIIChangeToUSBCode_US:
000900  2  0700 2,1         		addwf	Pcl,F
000901  2  1800 0           		retlw	00h	; //" " 000	NUL    (Null char.)
000902  2  1800 0           		retlw	00h	; //" " 001        SOH    (. of Header)
000903  2  1800 0           		retlw	00h	; //" " 002        STX    (Start of Text)
000904  2  1800 0           		retlw	00h	; //" " 003        ETX    (End of Text)
000905  2  1800 0           		retlw	00h	; //" " 004        EOT    (End of Transmission)
000906  2  1800 0           		retlw	00h	; //" " 005        ENQ    (Enquiry)
000907  2  1800 0           		retlw	00h	; //" " 006        ACK    (Acknowledgment)
000908  2  1800 0           		retlw	00h	; //" " 007        BEL    (Bell)
000909  2  1800 0           		retlw	00h	; //" " 008         BS    (Backspace)
00090A  2  1800 0           		retlw	00h	; //" " 009         HT    (Horizontal Tab)
00090B  2  1800 0           		retlw	00h	; //" " 00A         LF    (Line Feed)
00090C  2  1800 0           		retlw	00h	; //" " 00B         VT    (Vertical Tab)
00090D  2  1800 0           		retlw	00h	; //" " 00C         FF    (Form Feed)
00090E  2  1800 0           		retlw	00h	; //" " 00D         CR    (Carriage Return)
00090F  2  1800 0           		retlw	00h	; //" " 00E         SO    (Shift Out)
000910  2  1800 0           		retlw	00h	; //" " 00F         SI    (Shift In)
000911  2  1800 0           		retlw	00h	; //" " 010	DLE    (Data Link Escape)
000912  2  1800 0           		retlw	00h	; //" " 011        DC1 (XON) (Device Control 1)
000913  2  1800 0           		retlw	00h	; //" " 012        DC2       (Device Control 2)
000914  2  1800 0           		retlw	00h	; //" " 013        DC3 (XOFF)(Device Control 3)
000915  2  1800 0           		retlw	00h	; //" " 014        DC4       (Device Control 4)
000916  2  1800 0           		retlw	00h	; //" " 015        NAK    (Negative Acknowledgement)
000917  2  1800 0           		retlw	00h	; //" " 016        SYN    (Synchronous Idle)
000918  2  1800 0           		retlw	00h	; //" " 017        ETB    (End of Trans. Block)
000919  2  1800 0           		retlw	00h	; //" " 018        CAN    (Cancel)
00091A  2  1800 0           		retlw	00h	; //" " 019         EM    (End of Medium)
00091B  2  1800 0           		retlw	00h	; //" " 01A        SUB    (Substitute)
00091C  2  1800 0           		retlw	00h	; //" " 01B        ESC    (Escape)
00091D  2  1800 0           		retlw	00h	; //" " 01C         FS    (File Separator)
00091E  2  1800 0           		retlw	00h	; //" " 01D         GS    (Group Separator)
00091F  2  1800 0           		retlw	00h	; //" " 01E         RS    (Request to Send)(Record Separator)
000920  2  1800 0           		retlw	00h	; //" " 01F         US    (Unit Separator)
000921  2  1800 2c          		retlw	2ch	; //" " 020
000922  2  1800 1e          		retlw	1eh	; //"!" 021
000923  2  1800 34          		retlw	34h	; //""" 022
000924  2  1800 20          		retlw	20h	; //"#" 023
000925  2  1800 21          		retlw	21h	; //"$" 024
000926  2  1800 22          		retlw	22h	; //"%" 025
000927  2  1800 24          		retlw	24h	; //"&" 026
000928  2  1800 34          		retlw	34h	; //"'" 027
000929  2  1800 26          		retlw	26h	; //"(" 028
00092A  2  1800 27          		retlw	27h	; //")" 029
00092B  2  1800 25          		retlw	25h	; //"*" 02A
00092C  2  1800 2e          		retlw	2eh	; //"+" 02B
00092D  2  1800 36          		retlw	36h	; //"," 02C
00092E  2  1800 2d          		retlw	2dh	; //"-" 02D
00092F  2  1800 37          		retlw	37h	; //"." 02E
000930  2  1800 38          		retlw	38h	; //"/" 02F
000931  2  1800 27          		retlw	27h	; //"0" 030
000932  2  1800 1e          		retlw	1eh	; //"1" 031
000933  2  1800 1f          		retlw	1fh	; //"2" 032
000934  2  1800 20          		retlw	20h	; //"3" 033
000935  2  1800 21          		retlw	21h	; //"4" 034
000936  2  1800 22          		retlw	22h	; //"5" 035
000937  2  1800 23          		retlw	23h	; //"6" 036
000938  2  1800 24          		retlw	24h	; //"7" 037
000939  2  1800 25          		retlw	25h	; //"8" 038
00093A  2  1800 26          		retlw	26h	; //"9" 039
00093B  2  1800 33          		retlw	33h	; //":" 03A
00093C  2  1800 33          		retlw	33h	; //";" 03B
00093D  2  1800 36          		retlw	36h	; //"<" 03C
00093E  2  1800 2e          		retlw	2eh	; //"=" 03D
00093F  2  1800 37          		retlw	37h	; //">" 03E
000940  2  1800 38          		retlw	38h	; //"?" 03F
000941  2  1800 1f          		retlw	1fh	; //"@" 040
000942  2  1800 4           		retlw	04h	; //"A" 041
000943  2  1800 5           		retlw	05h	; //"B" 042
000944  2  1800 6           		retlw	06h	; //"C" 043
000945  2  1800 7           		retlw	07h	; //"D" 044
000946  2  1800 8           		retlw	08h	; //"E" 045
000947  2  1800 9           		retlw	09h	; //"F" 046
000948  2  1800 a           		retlw	0ah	; //"G" 047
000949  2  1800 b           		retlw	0bh	; //"H" 048
00094A  2  1800 c           		retlw	0ch	; //"I" 049
00094B  2  1800 d           		retlw	0dh	; //"J" 04A
00094C  2  1800 e           		retlw	0eh	; //"K" 04B
00094D  2  1800 f           		retlw	0fh	; //"L" 04C
00094E  2  1800 10          		retlw	10h	; //"M" 04D
00094F  2  1800 11          		retlw	11h	; //"N" 04E
000950  2  1800 12          		retlw	12h	; //"O" 04F
000951  2  1800 13          		retlw	13h	; //"P" 050
000952  2  1800 14          		retlw	14h	; //"Q" 051
000953  2  1800 15          		retlw	15h	; //"R" 052
000954  2  1800 16          		retlw	16h	; //"S" 053
000955  2  1800 17          		retlw	17h	; //"T" 054
000956  2  1800 18          		retlw	18h	; //"U" 055
000957  2  1800 19          		retlw	19h	; //"V" 056
000958  2  1800 1a          		retlw	1ah	; //"W" 057
000959  2  1800 1b          		retlw	1bh	; //"X" 058
00095A  2  1800 1c          		retlw	1ch	; //"Y" 059
00095B  2  1800 1d          		retlw	1dh	; //"Z" 05A
00095C  2  1800 2f          		retlw	2fh	; //"[" 05B
00095D  2  1800 31          		retlw	31h	; //"\" 05C
00095E  2  1800 30          		retlw	30h	; //"]" 05D
00095F  2  1800 23          		retlw	23h	; //"^" 05E
000960  2  1800 2d          		retlw	2dh	; //"_" 05F
000961  2  1800 35          		retlw	35h	;32h	; //"'" 060
000962  2  1800 4           		retlw	04h	; //"a" 061
000963  2  1800 5           		retlw	05h	; //"b" 062
000964  2  1800 6           		retlw	06h	; //"c" 063
000965  2  1800 7           		retlw	07h	; //"d" 064
000966  2  1800 8           		retlw	08h	; //"e" 065
000967  2  1800 9           		retlw	09h	; //"f" 066
000968  2  1800 a           		retlw	0ah	; //"g" 067
000969  2  1800 b           		retlw	0bh	; //"h" 068
00096A  2  1800 c           		retlw	0ch	; //"i" 069
00096B  2  1800 d           		retlw	0dh	; //"j" 06A
00096C  2  1800 e           		retlw	0eh	; //"k" 06B
00096D  2  1800 f           		retlw	0fh	; //"l" 06C
00096E  2  1800 10          		retlw	10h	; //"m" 06D
00096F  2  1800 11          		retlw	11h	; //"n" 06E
000970  2  1800 12          		retlw	12h	; //"o" 06F
000971  2  1800 13          		retlw	13h	; //"p" 070
000972  2  1800 14          		retlw	14h	; //"q" 071
000973  2  1800 15          		retlw	15h	; //"r" 072
000974  2  1800 16          		retlw	16h	; //"s" 073
000975  2  1800 17          		retlw	17h	; //"t" 074
000976  2  1800 18          		retlw	18h	; //"u" 075
000977  2  1800 19          		retlw	19h	; //"v" 076
000978  2  1800 1a          		retlw	1ah	; //"w" 077
000979  2  1800 1b          		retlw	1bh	; //"x" 078
00097A  2  1800 1c          		retlw	1ch	; //"y" 079
00097B  2  1800 1d          		retlw	1dh	; //"z" 07A
00097C  2  1800 2f          		retlw	2fh	; //"{" 07B
00097D  2  1800 31          		retlw	31h	; //"|" 07C
00097E  2  1800 30          		retlw	30h	; //"}" 07D
00097F  2  1800 35          		retlw	35h	;32h	; //"~" 07E
000980  2                   
000980  2                   ;////////////////////////////////////////////////////////////////////////
000980  2                   ;7eh(~/`)32h
000980  2                   ;21h(!/1)1eh
000980  2                   ;40h(@/2)1fh
000980  2                   ;23h(#/3)20h
000980  2                   ;24h($/4)21h
000980  2                   ;25h(%/5)22h
000980  2                   ;5eh(^/6)23h
000980  2                   ;26h(&/7)24h
000980  2                   ;2ah(*/8)25h
000980  2                   ;28h((/9)26h
000980  2                   ;29h()/0)27h
000980  2                   ;5fh(_/-)2dh
000980  2                   ;2bh(+/=)2eh
000980  2                   ;7bh({/[)2fh
000980  2                   ;7dh(}/])30h
000980  2                   ;3ah(:/;)33h
000980  2                   ;22h("/')34h
000980  2                   ;3ch(</,)36h
000980  2                   ;3eh(>/.)37h
000980  2                   ;3fh(?//)38h
000980  2                   ;7ch(|/\)31h
000980  2                   ;must press shift key
000980  2                   ;========================================================================
000980  2                   ;========================================================================
000980  2                   HexToDecTable:
000980  2  0700 2,1         	addwf	Pcl,F
000981  2  1800 0           	retlw	00h
000982  2  1800 1           	retlw	01h
000983  2  1800 2           	retlw	02h
000984  2  1800 3           	retlw	03h
000985  2  1800 4           	retlw	04h
000986  2  1800 5           	retlw	05h
000987  2  1800 6           	retlw	06h
000988  2  1800 7           	retlw	07h
000989  2  1800 8           	retlw	08h
00098A  2  1800 9           	retlw	09h
00098B  2  1800 10          	retlw	10h
00098C  2  1800 11          	retlw	11h
00098D  2  1800 12          	retlw	12h
00098E  2  1800 13          	retlw	13h
00098F  2  1800 14          	retlw	14h
000990  2  1800 15          	retlw	15h
000991  2  1800 16          	retlw	16h
000992  2  1800 17          	retlw	17h
000993  2  1800 18          	retlw	18h
000994  2  1800 19          	retlw	19h
000995  2  1800 20          	retlw	20h
000996  2  1800 21          	retlw	21h
000997  2  1800 22          	retlw	22h
000998  2  1800 23          	retlw	23h
000999  2  1800 24          	retlw	24h
00099A  2  1800 25          	retlw	25h
00099B  2  1800 26          	retlw	26h
00099C  2  1800 27          	retlw	27h
00099D  2  1800 28          	retlw	28h
00099E  2  1800 29          	retlw	29h
00099F  2  1800 30          	retlw	30h
0009A0  2  1800 31          	retlw	31h
0009A1  2  1800 32          	retlw	32h
0009A2  2  1800 33          	retlw	33h
0009A3  2  1800 34          	retlw	34h
0009A4  2  1800 35          	retlw	35h
0009A5  2  1800 36          	retlw	36h
0009A6  2  1800 37          	retlw	37h
0009A7  2  1800 38          	retlw	38h
0009A8  2  1800 39          	retlw	39h
0009A9  2  1800 40          	retlw	40h
0009AA  2  1800 41          	retlw	41h
0009AB  2  1800 42          	retlw	42h
0009AC  2  1800 43          	retlw	43h
0009AD  2  1800 44          	retlw	44h
0009AE  2  1800 45          	retlw	45h
0009AF  2  1800 46          	retlw	46h
0009B0  2  1800 47          	retlw	47h
0009B1  2  1800 48          	retlw	48h
0009B2  2  1800 49          	retlw	49h
0009B3  2  1800 50          	retlw	50h
0009B4  2  1800 51          	retlw	51h
0009B5  2  1800 52          	retlw	52h
0009B6  2  1800 53          	retlw	53h
0009B7  2  1800 54          	retlw	54h
0009B8  2  1800 55          	retlw	55h
0009B9  2  1800 56          	retlw	56h
0009BA  2  1800 57          	retlw	57h
0009BB  2  1800 58          	retlw	58h
0009BC  2  1800 59          	retlw	59h
0009BD  2  1800 60          	retlw	60h
0009BE  2  1800 61          	retlw	61h
0009BF  2  1800 62          	retlw	62h
0009C0  2  1800 63          	retlw	63h
0009C1  2  1800 64          	retlw	64h
0009C2  2  1800 65          	retlw	65h
0009C3  2  1800 66          	retlw	66h
0009C4  2  1800 67          	retlw	67h
0009C5  2  1800 68          	retlw	68h
0009C6  2  1800 69          	retlw	69h
0009C7  2  1800 70          	retlw	70h
0009C8  2  1800 71          	retlw	71h
0009C9  2  1800 72          	retlw	72h
0009CA  2  1800 73          	retlw	73h
0009CB  2  1800 74          	retlw	74h
0009CC  2  1800 75          	retlw	75h
0009CD  2  1800 76          	retlw	76h
0009CE  2  1800 77          	retlw	77h
0009CF  2  1800 78          	retlw	78h
0009D0  2  1800 79          	retlw	79h
0009D1  2  1800 80          	retlw	80h
0009D2  2  1800 81          	retlw	81h
0009D3  2  1800 82          	retlw	82h
0009D4  2  1800 83          	retlw	83h
0009D5  2  1800 84          	retlw	84h
0009D6  2  1800 85          	retlw	85h
0009D7  2  1800 86          	retlw	86h
0009D8  2  1800 87          	retlw	87h
0009D9  2  1800 88          	retlw	88h
0009DA  2  1800 89          	retlw	89h
0009DB  2  1800 90          	retlw	90h
0009DC  2  1800 91          	retlw	91h
0009DD  2  1800 92          	retlw	92h
0009DE  2  1800 93          	retlw	93h
0009DF  2  1800 94          	retlw	94h
0009E0  2  1800 95          	retlw	95h
0009E1  2  1800 96          	retlw	96h
0009E2  2  1800 97          	retlw	97h
0009E3  2  1800 98          	retlw	98h
0009E4  2  1800 99          	retlw	99h
0009E5  2                   
0009E5  2                   ;=======================================================
0009E5  2                   Get64ByteInfo:				;get 64bytes data from last page
0009E5  2  1900 0           		movlw	00h
0009E6  2  0080 47          		movwf	TempReg
0009E7  2                   	GetNextByte:
0009E7  2  0800 49          		movfw	R_I2C_Address			
0009E8  2                   		;call	DeviceInfoTable
0009E8  2                   		
0009E8  2  1400 24,2        		btfsc	OSType	
0009E9  2  3000 9ec         		goto	 $+3
0009EA  2  2000 e00         		call	MACURLTable;DeviceInfoTable
0009EB  2  3000 9ed         		goto	 $+2
0009EC  2  2000 d78         		call 	WindowsURLTable		
0009ED  2                   		
0009ED  2  0080 3c          		movwf	WorkReg
0009EE  2  2000 9fc         		call	StoreReceiveData1
0009EF  2  0A00 49,1        		incf	R_I2C_Address,F
0009F0  2  0A00 47,1        		incf	TempReg,F
0009F1  2  0800 48          		movfw	WindowsURLEnd;MacURLAddressIndex
0009F2  2  1600 24,2        		btfss	OSType
0009F3  2  0800 75          		movfw	MACURLEnd;SecurityKeyIndex				;the lastest URL address
0009F4  2  0200 49,0        		subwf	R_I2C_Address,W
0009F5  2  1400 3,0         		btfsc	Carry
0009F6  2  0040             		ret
0009F7  2                   		;movlw	40h;URLAddressLenMinus1			;a loop which take data till URL done
0009F7  2                   		;btfss	OSType
0009F7  2                   		;movlw	MacURLAddressLenMinus1
0009F7  2  1900 40          		movlw	40h
0009F8  2  0200 47,0        		subwf	TempReg,W
0009F9  2  1600 3,0         		btfss	Carry
0009FA  2  3000 9e7         		goto	GetNextByte
0009FB  2  0040             		ret
0009FC  2                   ;=======================================================
0009FC  2                   StoreReceiveData1:
0009FC  2  1900 40          		movlw	ReadBuffer
0009FD  2  0080 4                		movwf	Fsr
0009FE  2  0800 47               		movfw	TempReg
0009FF  2  0700 4,1              		addwf	Fsr,F
000A00  2  0800 3c               		movfw	WorkReg
000A01  2  1200 3,5              		bsf	RamBank
000A02  2  0080 0                		movwf	Indf
000A03  2  1000 3,5              		bcf	RamBank
000A04  2                   		
000A04  2  0880 73          		testz	EncryptionValue
000A05  2  1400 3,2         		btfsc	Zero
000A06  2  0040             		ret
000A07  2                   		
000A07  2  0A00 74,1        		incf	PitchXor,1
000A08  2  0880 3c               	testz   WorkReg
000A09  2  1400 3,2              	btfsc	Zero
000A0A  2  0040             		ret
000A0B  2  1900 1           		movlw	01h
000A0C  2  0600 73,0             	xorwf	EncryptionValue,W
000A0D  2  1600 3,2         		btfss	Zero
000A0E  2  3000 a14              	goto    EncryptionCode2
000A0F  2                   EncryptionCode1:
000A0F  2  1900 1           		movlw	01h
000A10  2  0500 74,0        		andwf	PitchXor,W
000A11  2  1600 3,2         		btfss   Zero
000A12  2  3000 a18                 goto    XorEncryption
000A13  2  0040                     ret
000A14  2                   EncryptionCode2:
000A14  2  1900 1           		movlw	01h
000A15  2  0500 74,0        		andwf	PitchXor,W
000A16  2  1600 3,2         		btfss   Zero		
000A17  2  0040                  	ret
000A18  2                   XorEncryption:   
000A18  2  0800 47                  movfw	TempReg
000A19  2  1D00 1           		xorlw	01h
000A1A  2  1400 3,2         		btfsc	Zero
000A1B  2  0000             		nop
000A1C  2                     	
000A1C  2  1200 3,5              	bsf	RamBank
000A1D  2  1900 80               	movlw	80h
000A1E  2  0600 0,1         		xorwf	Indf,F
000A1F  2  1000 3,5              	bcf	RamBank 
000A20  2                   	     			
000A20  2  0040             		ret	
000A21  2                   	
000A21  2                   
000A21  1                   ;#include	FMD24C02.inc
000A21  1                   #include	Androidpath.asm
000A21  2                   
000A21  2                   
000A21  2                   PrepareData_Android:
000A21  2  1400 2f,1        		btfsc	AndroidURLDoneFlag
000A22  2  3000 a36         		goto	ThirdSendKey
000A23  2                   		
000A23  2  1600 2b,2        		btfss	DataInFlag1
000A24  2  0040             		ret
000A25  2  1400 2a,2        		btfsc	OneFlag
000A26  2  0040             		ret
000A27  2  1200 2a,3        		bsf	TransFlag
000A28  2  1200 2a,2        		bsf	OneFlag
000A29  2  1400 2a,4        		btfsc	PlugFlag
000A2A  2  0040             		ret
000A2B  2                   		
000A2B  2  0800 50          		movfw	ScanNumber
000A2C  2  2000 b00         		call	GetKeyValuePro_Android
000A2D  2  0080 55          		movwf	UsbKeyBuffer2
000A2E  2  1900 e1          		movlw	E1h
000A2F  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000A30  2  1600 3,2         		btfss	Zero
000A31  2  3000 a55         		goto	NormalKeyValue0_android
000A32  2                   
000A32  2  1900 2           		movlw	02h					;AC Home
000A33  2  0080 55          		movwf	UsbKeyBuffer2
000A34  2  0A00 50,1        		incf	ScanNumber,F
000A35  2  0040             		ret
000A36  2                   		
000A36  2                   ThirdSendKey:
000A36  2  0800 50          		movfw	ScanNumber
000A37  2  0600 35,0        		xorwf	table0x51addr_add5,W
000A38  2  1600 3,2         		btfss	Zero
000A39  2  3000 a40         		goto	No0x51LOOP
000A3A  2                   		
000A3A  2  1900 9           		movlw 09h
000A3B  2  0200 30,0        		subwf gTempVar0,W
000A3C  2  1400 3,0         		btfsc Carry
000A3D  2                   		
000A3D  2                   		;yes bigger
000A3D  2  3000 a40         		goto No0x51LOOP
000A3E  2                   		
000A3E  2                   		;no smaller
000A3E  2  0800 32          		movfw table0x51addr
000A3F  2  0080 50          		movwf 	ScanNumber
000A40  2                   No0x51LOOP:		
000A40  2  0800 50          		movfw	ScanNumber
000A41  2  2000 b3c         		call	GetThirdKeyValue_Android
000A42  2  0080 55          		movwf	UsbKeyBuffer2
000A43  2  1900 eb          		movlw	EBh
000A44  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000A45  2  1600 3,2         		btfss	Zero
000A46  2  3000 a55         		goto	NormalKeyValue0_android
000A47  2                   
000A47  2  1400 2f,2        		btfsc setting0x51addrFlag
000A48  2  3000 a4f         		goto $+7
000A49  2  0800 50          		movfw 	ScanNumber
000A4A  2  0080 32          		movwf	table0x51addr
000A4B  2  0080 35          		movwf	table0x51addr_add5
000A4C  2  1900 6           		movlw	06h
000A4D  2  0700 35,1        		addwf	table0x51addr_add5,F
000A4E  2  1200 2f,2        		bsf setting0x51addrFlag
000A4F  2                   		
000A4F  2  0A00 30,1        		incf gTempVar0,F
000A50  2  0180 55          		clrf	UsbKeyBuffer2
000A51  2  1900 51          		movlw	51h					;0x51 'down arrow key'
000A52  2  0080 56          		movwf	UsbKeyBuffer3		
000A53  2  0A00 50,1        		incf	ScanNumber,F
000A54  2  0040             		ret	
000A55  2                   		
000A55  2                   	NormalKeyValue0_android:
000A55  2  1900 e2          		movlw	E2h
000A56  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000A57  2  1600 3,2         		btfss	Zero
000A58  2  3000 a60         		goto	NormalKeyValue01_android
000A59  2                   		;movlw	01h    				;AC Search	
000A59  2                   		;movwf	UsbKeyBuffer2
000A59  2  1200 2e,6        		bsf	ReportIDFlag
000A5A  2                   			
000A5A  2  1900 8           		movlw	08h    				;gui	
000A5B  2  0080 55          		movwf	UsbKeyBuffer2
000A5C  2  1900 5           		movlw	05h    				;B	
000A5D  2  0080 56          		movwf	UsbKeyBuffer3	
000A5E  2  0A00 50,1        		incf	ScanNumber,F 
000A5F  2  0040             		ret		
000A60  2                   	NormalKeyValue01_android:						
000A60  2  1900 e3          		movlw	E3h
000A61  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000A62  2  1600 3,2         		btfss	Zero
000A63  2  3000 a69         		goto	NormalKeyValue02_android
000A64  2  1200 2e,6        		bsf		ReportIDFlag
000A65  2  2000 5a1         		call	WaitforLangSwitch
000A66  2  0180 55          		clrf	UsbKeyBuffer2			;remember clrf UsbKeyBuffer2
000A67  2  0180 56          		clrf	UsbKeyBuffer3	
000A68  2  0040             		ret
000A69  2                   	NormalKeyValue02_android:						
000A69  2  1900 e4          		movlw	E4h
000A6A  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000A6B  2  1600 3,2         		btfss	Zero
000A6C  2  3000 a72         		goto	NormalKeyValue03_android
000A6D  2                   		;bsf	ReportIDFlag
000A6D  2  0180 55          		clrf	UsbKeyBuffer2
000A6E  2  1900 28          		movlw	28h					;enter
000A6F  2  0080 56          		movwf	UsbKeyBuffer3
000A70  2  0A00 50,1        		incf	ScanNumber,F
000A71  2  0040             		ret		
000A72  2                   	NormalKeyValue03_android:						
000A72  2  1900 e5          		movlw	E5h
000A73  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000A74  2  1600 3,2         		btfss	Zero
000A75  2  3000 a7b         		goto	NormalKeyValue04_android
000A76  2  1000 2e,6        		bcf	ReportIDFlag
000A77  2  1900 1           		movlw	01h    				;AC Search	
000A78  2  0080 55          		movwf	UsbKeyBuffer2
000A79  2                   
000A79  2  0A00 50,1        		incf	ScanNumber,F		
000A7A  2  0040             		ret
000A7B  2                   
000A7B  2                   	NormalKeyValue04_android:						
000A7B  2  1900 e6          		movlw	E6h
000A7C  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000A7D  2  1600 3,2         		btfss	Zero
000A7E  2  3000 a85         		goto	NormalKeyValue05_android
000A7F  2                   				
000A7F  2  1900 4           		movlw	04h    				;alt	
000A80  2  0080 55          		movwf	UsbKeyBuffer2
000A81  2  1900 7           		movlw	07h    				;D	
000A82  2  0080 56          		movwf	UsbKeyBuffer3	
000A83  2  0A00 50,1        		incf	ScanNumber,F	
000A84  2  0040             		ret	
000A85  2                   	NormalKeyValue05_android:						
000A85  2  1900 e7          		movlw	E7h
000A86  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000A87  2  1600 3,2         		btfss	Zero
000A88  2  3000 a8d         		goto	NormalKeyValue06_android
000A89  2                   		;bsf	ReportIDFlag
000A89  2  0180 55          		clrf	UsbKeyBuffer2
000A8A  2                   		;movlw	4fh					;right
000A8A  2                   		;movwf	UsbKeyBuffer3
000A8A  2  2000 6c3         		call	Set_LedState			;detect led status and let NumLock and CapsLock on		
000A8B  2  0A00 50,1        		incf	ScanNumber,F	
000A8C  2  0040             		ret			
000A8D  2                   	NormalKeyValue06_android:						
000A8D  2  1900 e8          		movlw	E8h
000A8E  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000A8F  2  1600 3,2         		btfss	Zero
000A90  2  3000 a97         		goto	NormalKeyValue07_android
000A91  2                   		;bsf	ReportIDFlag
000A91  2                   		;clrf	UsbKeyBuffer2
000A91  2  1900 1           		movlw	01h    				;ctrl	
000A92  2  0080 55          		movwf	UsbKeyBuffer2
000A93  2  1900 f           		movlw	0fh    				;L	
000A94  2  0080 56          		movwf	UsbKeyBuffer3	
000A95  2  0A00 50,1        		incf	ScanNumber,F	
000A96  2  0040             		ret			
000A97  2                   
000A97  2                   ;third 
000A97  2                   	NormalKeyValue07_android:						
000A97  2  1900 e9          		movlw	E9h
000A98  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000A99  2  1600 3,2         		btfss	Zero
000A9A  2  3000 aa0         		goto	NormalKeyValue08_android
000A9B  2  0180 55          		clrf	UsbKeyBuffer2
000A9C  2  1900 65          		movlw	65h					;0x65
000A9D  2  0080 56          		movwf	UsbKeyBuffer3	
000A9E  2  0A00 50,1        		incf	ScanNumber,F	
000A9F  2  0040             		ret
000AA0  2                   	NormalKeyValue08_android:						
000AA0  2  1900 ea          		movlw	EAh
000AA1  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000AA2  2  1600 3,2         		btfss	Zero
000AA3  2  3000 aa9         		goto	NormalKeyValue09_android
000AA4  2  0180 55          		clrf	UsbKeyBuffer2
000AA5  2  1900 2b          		movlw	2bh					;tab
000AA6  2  0080 56          		movwf	UsbKeyBuffer3
000AA7  2  0A00 50,1        		incf	ScanNumber,F	
000AA8  2  0040             		ret
000AA9  2                   	NormalKeyValue09_android:						
000AA9  2  1900 ec          		movlw	ECh
000AAA  2  0600 55,0        		xorwf	UsbKeyBuffer2,W
000AAB  2  1600 3,2         		btfss	Zero
000AAC  2  3000 ab2         		goto	NormalKeyValue10_android
000AAD  2  0180 55          		clrf	UsbKeyBuffer2
000AAE  2  1900 4f          		movlw	4fh					;0x4f 'right arrow key'
000AAF  2  0080 56          		movwf	UsbKeyBuffer3
000AB0  2  0A00 50,1        		incf	ScanNumber,F	
000AB1  2  0040             		ret			
000AB2  2                   ;third
000AB2  2                   		
000AB2  2                   	NormalKeyValue10_android:
000AB2  2                   ;	NormalKeyValue09_android:
000AB2  2  0180 54          		clrf	UsbKeyBuffer0
000AB3  2  0A00 50,1        		incf	ScanNumber,F
000AB4  2  1900 3b          		movlw	AndroidWebLength
000AB5  2  1400 2f,1        		btfsc AndroidURLDoneFlag
000AB6  2  1900 2f          		movlw AndroidThirdLength
000AB7  2  0200 50,0        		subwf	ScanNumber,W
000AB8  2  1600 3,0         		btfss	Carry
000AB9  2  0040             		ret
000ABA  2  0180 50          		clrf	ScanNumber
000ABB  2  1000 2a,1        		bcf	EndTransFlag
000ABC  2  1000 2b,2        		bcf	DataInFlag1
000ABD  2  1000 25,0        		bcf	GUIFlag
000ABE  2  1000 2a,2        		bcf	OneFlag
000ABF  2  0040             		ret
000AC0  2                   		
000AC0  2                   
000AC0  2                   DataTransfer1_android:
000AC0  2  1400 2f,1        		btfsc AndroidURLDoneFlag
000AC1  2  3000 ac5         		goto SendDataReport_android
000AC2  2                   		
000AC2  2  1400 2a,3        		btfsc	TransFlag
000AC3  2  3000 ac5         		goto	SendDataReport_android
000AC4  2  0040             		ret
000AC5  2                     SendDataReport_android:
000AC5  2  1400 15,7          		btfsc	Tx1Rdy
000AC6  2  0040               		ret
000AC7  2                   		
000AC7  2  1900 2           		movlw	02h				;report id = 2
000AC8  2  1400 2e,6        		btfsc	ReportIDFlag
000AC9  2  1900 1           		movlw	01h
000ACA  2  1E00 58          		movwr	Tx1FifoReg0
000ACB  2                   		
000ACB  2  0800 55            		movfw	UsbKeyBuffer2
000ACC  2  1E00 59            		movwr	Tx1FifoReg1
000ACD  2  0800 56            		movfw	UsbKeyBuffer3
000ACE  2  1E00 5b            		movwr	Tx1FifoReg3
000ACF  2  0800 57            		movfw	UsbKeyBuffer4
000AD0  2  1E00 5c            		movwr	Tx1FifoReg4;
000AD1  2  0800 69            		movfw	UsbKeyBuffer5
000AD2  2  1E00 5e            		movwr	Tx1FifoReg6;
000AD3  2  1900 0             		movlw	00h
000AD4  2                     		;movwr	Tx1FifoReg1
000AD4  2                     		;movwr	Tx1FifoReg5
000AD4  2  1E00 5a          		movwr	Tx1FifoReg2
000AD5  2                   		;movwr	Tx1FifoReg3
000AD5  2                   		;movwr	Tx1FifoReg4
000AD5  2                   		;movwr	Tx1FifoReg5
000AD5  2  1E00 5e            		movwr	Tx1FifoReg6
000AD6  2  1E00 5f            		movwr	Tx1FifoReg7
000AD7  2  0080 56            		movwf	UsbKeyBuffer3
000AD8  2                     		;movwf	UsbKeyBuffer4
000AD8  2                   		;movwf   UsbKeyBuffer5
000AD8  2                   
000AD8  2  1900 f0           		movlw	f0h
000AD9  2  0500 15,1         		andwf	Tx1Reg,F
000ADA  2                   		
000ADA  2  1900 2           		movlw	02h
000ADB  2  1400 2e,6        		btfsc	ReportIDFlag
000ADC  2  1900 8            		movlw	08h
000ADD  2  0400 15,1        		iorwf	Tx1Reg,F
000ADE  2  1900 40          		movlw	40h
000ADF  2  0600 15,1        		xorwf	Tx1Reg,F
000AE0  2  1200 15,7        		bsf	Tx1Rdy
000AE1  2                   
000AE1  2  1000 2a,2        		bcf	OneFlag
000AE2  2  1000 2a,3          		bcf	TransFlag
000AE3  2                   
000AE3  2  0180 54          		clrf	UsbKeyBuffer0
000AE4  2  0180 55          		clrf	UsbKeyBuffer2
000AE5  2  0180 56            		clrf	UsbKeyBuffer3
000AE6  2                   		
000AE6  2                   		
000AE6  2  1600 2f,1        		btfss AndroidURLDoneFlag
000AE7  2  0040             		ret
000AE8  2  2000 af0         		call DelaySendKeyRoutine
000AE9  2  0880 50          		testz ScanNumber
000AEA  2  1600 3,2         		btfss	Zero
000AEB  2  0040             		ret
000AEC  2  1000 13,3        		bcf	DeviceR
000AED  2  1E03             		sleep
000AEE  2  3000 aed         		goto $-1
000AEF  2                   		
000AEF  2  0040             		ret	
000AF0  2                   
000AF0  2                   DelaySendKeyRoutine:
000AF0  2  1900 40          		movlw	40h
000AF1  2  1400 2e,5        		btfsc	AndroidOSFlag
000AF2  2  1900 80          		movlw	80h;c0h
000AF3  2  1400 2f,1        		btfsc AndroidURLDoneFlag
000AF4  2  1900 30          		movlw	30h
000AF5  2  0080 33          		movwf	gTempVar3
000AF6  2  0080 34          		movwf	gTempVar4
000AF7  2                   DelaySendKey_sub:	
000AF7  2  0300 34,1        		decf 	gTempVar4,F
000AF8  2  1600 3,2         		btfss	Zero
000AF9  2  3000 af7         		goto	$-2
000AFA  2  0300 33,1        		decf 	gTempVar3,F
000AFB  2  1600 3,2         		btfss	Zero
000AFC  2  3000 af7         		goto	DelaySendKey_sub
000AFD  2  0180 33          		clrf	gTempVar3
000AFE  2  0180 34          		clrf	gTempVar4
000AFF  2  0040             		ret
000B00  2                   		
000B00  2                   ;---------------------------------------------		
000B00  2                   		org 0b00h
000B00  2                   ;---------------------------------------------		
000B00  2                   .TABLE		
000B00  2                   GetKeyValuePro_Android:
000B00  2  0700 2,1         		addwf	Pcl,F
000B01  2                   	AndroidArray_start:
000B01  2  1800 0           		retlw	00h
000B02  2  1800 0           		retlw	00h
000B03  2  1800 e1          		retlw	E1h			;	AC Home
000B04  2  1800 0           		retlw	00h
000B05  2  1800 0           		retlw	00h
000B06  2  1800 e3          		retlw	E3h
000B07  2  1800 0           		retlw	00h 
000B08  2  1800 0           		retlw	00h			
000B09  2  1800 0           		retlw	00h
000B0A  2  1800 e7          		retlw	E7h			;	detect SetLed
000B0B  2  1800 0           		retlw	00h
000B0C  2  1800 0           		retlw	00h			
000B0D  2  1800 0           		retlw	00h
000B0E  2  1800 e3          		retlw	E3h
000B0F  2  1800 0           		retlw	00h
000B10  2  1800 0           		retlw	00h	
000B11  2  1800 e2          		retlw	E2h			;	win+b
000B12  2  1800 0           		retlw	00h
000B13  2  1800 0           		retlw	00h			
000B14  2  1800 0           		retlw	00h
000B15  2  1800 e3          		retlw	E3h
000B16  2  1800 0           		retlw	00h
000B17  2  1800 0           		retlw	00h
000B18  2                   
000B18  2  1800 e4          		retlw	E4h			;	enter
000B19  2  1800 0           		retlw	00h
000B1A  2  1800 0           		retlw	00h	
000B1B  2  1800 e3          		retlw	E3h
000B1C  2  1800 0           		retlw	00h
000B1D  2  1800 0           		retlw	00h
000B1E  2                   		
000B1E  2  1800 e4          		retlw	E4h			;	enter
000B1F  2  1800 0           		retlw	00h
000B20  2  1800 0           		retlw	00h	
000B21  2  1800 e3          		retlw	E3h
000B22  2  1800 0           		retlw	00h
000B23  2  1800 0           		retlw	00h		
000B24  2                   		
000B24  2  1800 e4          		retlw	E4h			;	enter
000B25  2  1800 0           		retlw	00h
000B26  2  1800 0           		retlw	00h	
000B27  2  1800 e3          		retlw	E3h
000B28  2  1800 0           		retlw	00h
000B29  2  1800 0           		retlw	00h
000B2A  2                   		
000B2A  2  1800 e5          		retlw	E5h			;	AC search
000B2B  2  1800 0           		retlw	00h
000B2C  2  1800 0           		retlw	00h
000B2D  2  1800 e3          		retlw	E3h
000B2E  2  1800 0           		retlw	00h
000B2F  2  1800 0           		retlw	00h	
000B30  2                   
000B30  2  1800 e8          		retlw	E8h			;	ctrl+L
000B31  2  1800 0           		retlw	00h
000B32  2  1800 0           		retlw	00h
000B33  2  1800 e3          		retlw	E3h
000B34  2  1800 0           		retlw	00h
000B35  2  1800 0           		retlw	00h	
000B36  2                   
000B36  2  1800 e6          		retlw	E6h			;	alt+D
000B37  2  1800 0           		retlw	00h
000B38  2  1800 0           		retlw	00h
000B39  2  1800 e3          		retlw	E3h
000B3A  2  1800 0           		retlw	00h
000B3B  2  1800 0           		retlw	00h			
000B3C  2                   	AndroidArray_end:
000B3C  2                   .ENDTABLE		
000B3C  2                   
000B3C  2                   .TABLE		
000B3C  2                   GetThirdKeyValue_Android:
000B3C  2  0700 2,1         		addwf	Pcl,F
000B3D  2                   	AndroidThird_start:
000B3D  2  1800 0           		retlw	00h
000B3E  2  1800 0           		retlw	00h
000B3F  2  1800 e9          		retlw	E9h			;	0x65
000B40  2  1800 0           		retlw	00h
000B41  2  1800 0           		retlw	00h
000B42  2  1800 e3          		retlw	E3h
000B43  2  1800 0           		retlw	00h 
000B44  2  1800 0           		retlw	00h			
000B45  2  1800 0           		retlw	00h
000B46  2  1800 ec          		retlw	ECh			;	tab
000B47  2  1800 0           		retlw	00h
000B48  2  1800 0           		retlw	00h			
000B49  2  1800 0           		retlw	00h
000B4A  2  1800 e3          		retlw	E3h
000B4B  2  1800 0           		retlw	00h
000B4C  2  1800 0           		retlw	00h	
000B4D  2  1800 eb          		retlw	EBh			;	0x51 ;table0x51addr
000B4E  2  1800 0           		retlw	00h
000B4F  2  1800 0           		retlw	00h			
000B50  2  1800 0           		retlw	00h
000B51  2  1800 e3          		retlw	E3h
000B52  2  1800 0           		retlw	00h
000B53  2  1800 0           		retlw	00h
000B54  2                   
000B54  2  1800 e4          		retlw	E4h			;	enter
000B55  2  1800 0           		retlw	00h
000B56  2  1800 0           		retlw	00h	
000B57  2  1800 e3          		retlw	E3h
000B58  2  1800 0           		retlw	00h
000B59  2  1800 0           		retlw	00h
000B5A  2                   		
000B5A  2  1800 ea          		retlw	EAh			;	tab
000B5B  2  1800 0           		retlw	00h
000B5C  2  1800 0           		retlw	00h	
000B5D  2  1800 e3          		retlw	E3h
000B5E  2  1800 0           		retlw	00h
000B5F  2  1800 0           		retlw	00h		
000B60  2                   		
000B60  2  1800 ea          		retlw	EAh			;	tab
000B61  2  1800 0           		retlw	00h
000B62  2  1800 0           		retlw	00h	
000B63  2  1800 e3          		retlw	E3h
000B64  2  1800 0           		retlw	00h
000B65  2  1800 0           		retlw	00h
000B66  2                   		
000B66  2  1800 e4          		retlw	E4h			;	enter
000B67  2  1800 0           		retlw	00h
000B68  2  1800 0           		retlw	00h
000B69  2  1800 e3          		retlw	E3h
000B6A  2  1800 0           		retlw	00h
000B6B  2  1800 0           		retlw	00h	
000B6C  2                   
000B6C  2                   		
000B6C  2                   	AndroidThird_end:
000B6C  2                   .ENDTABLE
000B6C  2                   
000B6C  1                   #include 	USB_TBLS.asm
000B6C  2                   
000B6C  2                   ;==================================================================================================
000B6C  2                   		org		    0c00h
000C00  2                   ;==============================================================================
000C00  2                   ;	   Device  Descriptor
000C00  2                   ;==============================================================================
000C00  2                   .TABLE
000C00  2                   DeviceDescTable:
000C00  2  0700 2,1         		addwf	Pcl,F
000C01  2                   Device_Descriptor:
000C01  2  1800 12          		retlw   12h				;bLength			=>12h byte
000C02  2  1800 1           		retlw   01h				;bdescriptorType		=>Device
000C03  2  1800 10          		retlw   10h				;bcdUSB low Byte		=>USB is VER:1.1
000C04  2  1800 1           		retlw   01h				;bcdUSB hi  Byte
000C05  2  1800 0           		retlw   00h				;bDeviceClass
000C06  2  1800 0           		retlw   00h				;bDeviceSubClass
000C07  2  1800 0           		retlw   00h				;bDeviceProtocol
000C08  2  1800 8           		retlw   08h				;bMaxPacketSize0		=>8 byte
000C09  2  1800 ac          		retlw   VID_LO				;idVendor low byte		=>Tenx Vendor ID is 1130
000C0A  2  1800 5           		retlw   VID_HI				;idVendor hi  byte
000C0B  2  1800 b           		retlw   PID_LO				;idProduct low byte		=>Product ID for MASK type.
000C0C  2  1800 2           		retlw   PID_HI				;idProduct hi byte
000C0D  2  1800 0           		retlw   00h				;bcdDevice low byte
000C0E  2  1800 5           		retlw   05h				;bcdDevice hi byte
000C0F  2  1800 1           		retlw   01h				;iManufacturer
000C10  2  1800 2           		retlw   02h				;iProduct
000C11  2  1800 0           		retlw   00h				;iSeriaNumber
000C12  2  1800 1           		retlw   01h				;bNumConfigurations		=>One configuration
000C13  2                   ;------------------------------------------------------------------------
000C13  2                   ;	   Configuration  Descriptor			  12h
000C13  2                   ;------------------------------------------------------------------------
000C13  2                   Configuration_Descriptor:
000C13  2  1800 9           		retlw   09h				;bLength			=>9 byte
000C14  2  1800 2           		retlw   02h				;bDescriptorType		=>Configuration
000C15  2  1800 22          		retlw   ConfigLen		  	;wTotalLength low Byte	  	=>Transfer all byte number
000C16  2  1800 0           		retlw   00h				;wTotalLength  hi  Byte
000C17  2  1800 1           		retlw   01h;02h				;bNumInterfaces			=>Two Interface
000C18  2  1800 1           		retlw   01h				;bConfigurationValue		=>Configruation Valume
000C19  2  1800 0           		retlw   00h				;iConfiguration			=>Unused
000C1A  2  1800 80          		retlw   80h				;bmAttribute			=>(Bit7:Bus supply Power/Bit5:RemoteWakeUp)
000C1B  2  1800 32          		retlw   32h				;MaxPower   			=>Max Current 500mA
000C1C  2                   HID_Class1_Begin:
000C1C  2                   ;------------------------------------------------------------------------
000C1C  2                   ;	   HID Interface Descriptor
000C1C  2                   ;------------------------------------------------------------------------
000C1C  2  1800 9           		retlw   09h				;bLength			=>9 byte
000C1D  2  1800 4           		retlw   04h				;bDescriptorType		=>Interface
000C1E  2  1800 0           		retlw   00h				;bInterfaceNumber		=>set0
000C1F  2  1800 0           		retlw   00h				;bAlternateSetting		=>0
000C20  2  1800 1           		retlw   01h				;bNumEndPoint			=>EndPoint 1
000C21  2  1800 3           		retlw   03h				;bInterfaceClass
000C22  2  1800 1           		retlw   01h				;bInterfaceSubclass
000C23  2  1800 1           		retlw   01h				;bIinterfaceProtocal
000C24  2  1800 0           		retlw   00h				;iInterface
000C25  2                   ;------------------------------------------------------------------------
000C25  2                   ;	   HID Class Descriptor
000C25  2                   ;------------------------------------------------------------------------
000C25  2                   HID_Class1_Desc:
000C25  2  1800 9           		retlw	09h
000C26  2  1800 21          		retlw	21h
000C27  2  1800 10          		retlw	10h
000C28  2  1800 1           		retlw	01h
000C29  2  1800 0           		retlw	00h;21h				;bCountryCode
000C2A  2  1800 1           		retlw	01h
000C2B  2  1800 22          		retlw	22h
000C2C  2  1800 62          		retlw	HidReport1Len
000C2D  2  1800 0           		retlw	00h
000C2E  2                   ;------------------------------------------------------------------------
000C2E  2                   ;	   HID Endpoint descriptor
000C2E  2                   ;------------------------------------------------------------------------
000C2E  2  1800 7           		retlw   07h				;bLength			=>7 byte
000C2F  2  1800 5           		retlw   05h				;bDescriptorType		=>endpoint
000C30  2  1800 81          		retlw   81h				;enpoint address	 	=>in endpoint, endpoint 1
000C31  2  1800 3           		retlw   03h				;endpoint attribute		=>interrupt
000C32  2  1800 8           		retlw   08h				;max packet size		=>8 bytes
000C33  2  1800 0           		retlw   00h				;max packet size
000C34  2  1800 a           		retlw   0ah				;polling interval		=>1 ms
000C35  2                   HID_Class1_End:
000C35  2                   
000C35  2                   HID_Class2_Begin:
000C35  2                   ;------------------------------------------------------------------------
000C35  2                   ;	   HID Interface2 Descriptor
000C35  2                   ;------------------------------------------------------------------------
000C35  2                   		;retlw   09h				;bLength			=>9 byte
000C35  2                   		;retlw   04h				;bDescriptorType		=>Interface
000C35  2                   		;retlw   01h				;bInterfaceNumber		=>set1
000C35  2                   		;retlw   00h				;bAlternateSetting		=>0
000C35  2                   		;retlw   01h				;bNumEndPoint			=>EndPoint 1
000C35  2                   		;retlw   03h				;bInterfaceClass
000C35  2                   		;retlw   00h				;bInterfaceSubclass
000C35  2                   		;retlw   00h				;bIinterfaceProtocal
000C35  2                   		;retlw   00h				;iInterface
000C35  2                   ;------------------------------------------------------------------------
000C35  2                   ;	   HID Class2 Descriptor
000C35  2                   ;------------------------------------------------------------------------
000C35  2                   HID_Class2_Desc:
000C35  2                   		;retlw	09h
000C35  2                   		;retlw	21h
000C35  2                   		;retlw	10h
000C35  2                   		;retlw	01h
000C35  2                   		;retlw	21h
000C35  2                   		;retlw	01h
000C35  2                   		;retlw	22h
000C35  2                   		;retlw	HidReport2Len
000C35  2                   		;retlw	00h
000C35  2                   ;------------------------------------------------------------------------
000C35  2                   ;	   HID Endpoint2 descriptor
000C35  2                   ;------------------------------------------------------------------------
000C35  2                   		;retlw   07h				;bLength			=>7 byte
000C35  2                   		;retlw   05h				;bDescriptorType		=>endpoint
000C35  2                   		;retlw   06h				;enpoint address	 	=>out endpoint, endpoint 6
000C35  2                   		;retlw   03h				;endpoint attribute		=>interrupt
000C35  2                   		;retlw   08h				;max packet size		=>8 bytes
000C35  2                   		;retlw   00h				;max packet size
000C35  2                   		;retlw   0ah				;polling interval		=>1 ms
000C35  2                   HID_Class2_End:
000C35  2                   
000C35  2                   ;-----------------------------------------------------------------------
000C35  2                   ;	   String Index0  Descriptor
000C35  2                   ;-----------------------------------------------------------------------
000C35  2                   String0_Descriptor:
000C35  2  1800 4           		retlw   04h				;length
000C36  2  1800 3           		retlw   03h				;type (3 = string)Language English
000C37  2  1800 9           		retlw   09h				;Language:English
000C38  2  1800 4           		retlw   04h  			   	;Sub-Language:default
000C39  2                   ;-----------------------------------------------------------------------
000C39  2                   ;	   String Index1  Descriptor
000C39  2                   ;-----------------------------------------------------------------------
000C39  2                   String1_Descriptor:
000C39  2  1800 a           		retlw   0ah				;length
000C3A  2  1800 3           		retlw   03h				;type (3 = string)Language English
000C3B  2                   
000C3B  2  1800 54          		retlw	'T'
000C3C  2  1800 0           		retlw   00h
000C3D  2  1800 45          		retlw	'E'
000C3E  2  1800 0           		retlw	00h
000C3F  2  1800 4e          		retlw	'N'
000C40  2  1800 0           		retlw	00h
000C41  2  1800 58          		retlw	'X'
000C42  2  1800 0           		retlw	00h
000C43  2                   ;-----------------------------------------------------------------------
000C43  2                   ;	   String Index2  Descriptor
000C43  2                   ;-----------------------------------------------------------------------
000C43  2                   ;------------------------------------------------------------------------------
000C43  2                   ;TP6620 WEBKEY
000C43  2                   ;-----------------------------------------------------------------------------
000C43  2                   String2_Descriptor:
000C43  2  1800 1c          		retlw	28		;34 bytes
000C44  2  1800 3           		retlw	03h
000C45  2                   
000C45  2  1800 54          		retlw	'T'
000C46  2  1800 0           		retlw	00h
000C47  2  1800 50          		retlw	'P'
000C48  2  1800 0           		retlw	00h
000C49  2  1800 39          		retlw	'9'
000C4A  2  1800 0           		retlw	00h
000C4B  2  1800 38          		retlw	'8'
000C4C  2  1800 0           		retlw	00h
000C4D  2  1800 30          		retlw	'0'
000C4E  2  1800 0           		retlw	00h
000C4F  2  1800 38          		retlw	'8'
000C50  2  1800 0           		retlw	00h
000C51  2  1800 20          		retlw	' '
000C52  2  1800 0           		retlw	00h
000C53  2  1800 57          		retlw	'W'
000C54  2  1800 0           		retlw	00h
000C55  2  1800 45          		retlw	'E'
000C56  2  1800 0           		retlw	00h
000C57  2  1800 42          		retlw	'B'
000C58  2  1800 0           		retlw	00h
000C59  2  1800 4b          		retlw	'K'
000C5A  2  1800 0           		retlw	00h
000C5B  2  1800 45          		retlw	'E'
000C5C  2  1800 0           		retlw	00h
000C5D  2  1800 59          		retlw	'Y'
000C5E  2  1800 0           		retlw	00h
000C5F  2                   		;retlw	' '
000C5F  2                   		;retlw	00h
000C5F  2                   		;retlw	' '
000C5F  2                   		;retlw	00h
000C5F  2                   		;retlw	' '
000C5F  2                   		;retlw	00h
000C5F  2                   ;------------------------------------------------------------------------------
000C5F  2                   ;General Purpose USB
000C5F  2                   ;-----------------------------------------------------------------------------
000C5F  2                   HID_Report1_Desc:
000C5F  2  1800 5           		retlw   05h	; usage page (generic desktop)		;65 bytes----------00h
000C60  2  1800 1           		retlw	01h
000C61  2  1800 9           		retlw   09h	; usage (keyboard)
000C62  2  1800 6           		retlw	06h
000C63  2  1800 a1          		retlw   a1h	; collection (application)
000C64  2  1800 1           		retlw	01h
000C65  2                   		
000C65  2  1800 85          		retlw	85h	; report id(1)
000C66  2  1800 1           		retlw	01h
000C67  2                   		
000C67  2  1800 5           		retlw   05h	; USAGE_PAGE (Keyboard)
000C68  2  1800 7           		retlw	07h
000C69  2                   
000C69  2  1800 19          		retlw   19h	; USAGE_MINIMUM (Keyboard LeftControl)
000C6A  2  1800 e0          		retlw	e0h
000C6B  2  1800 29          		retlw   29h	; USAGE_MAXIMUM (Keyboard Right GUI)
000C6C  2  1800 e7          		retlw	e7h
000C6D  2  1800 15          		retlw   15h	; logical minimum (0)
000C6E  2  1800 0           		retlw	00h
000C6F  2  1800 25          		retlw   25h	; logical maximum (1)
000C70  2  1800 1           		retlw	01h
000C71  2                   
000C71  2  1800 75          		retlw   75h	; report size (1 bit)
000C72  2  1800 1           		retlw	01h
000C73  2  1800 95          		retlw   95h	; report count (8 bits)
000C74  2  1800 8           		retlw	08h
000C75  2  1800 81          		retlw   81h	; input (data, variable, absolute)
000C76  2  1800 2           		retlw	02h
000C77  2  1800 95          		retlw   95h	; report count (1 byte)
000C78  2  1800 1           		retlw	01h
000C79  2                   
000C79  2  1800 75          		retlw   75h	; report size (8 bits)
000C7A  2  1800 8           		retlw	08h
000C7B  2  1800 81          		retlw   81h	; input (constant)
000C7C  2  1800 1           		retlw	01h
000C7D  2  1800 95          		retlw   95h	; report count (3)
000C7E  2  1800 3           		retlw	03h
000C7F  2  1800 75          		retlw   75h	; report size (1)
000C80  2  1800 1           		retlw	01h
000C81  2                   
000C81  2  1800 5           		retlw   05h	; usage page (LEDs)
000C82  2  1800 8           		retlw	08h
000C83  2  1800 19          		retlw   19h	; usage minimum (1)
000C84  2  1800 1           		retlw	01h
000C85  2  1800 29          		retlw   29h	; usage maximum (3)
000C86  2  1800 3           		retlw	03h
000C87  2  1800 91          		retlw   91h	; output (data, variable, absolute)
000C88  2  1800 2           		retlw	02h
000C89  2                   
000C89  2  1800 95          		retlw   95h	; report count (5)
000C8A  2  1800 5           		retlw	05h
000C8B  2  1800 75          		retlw   75h	; report size (1)
000C8C  2  1800 1           		retlw	01h
000C8D  2  1800 91          		retlw   91h	; output (constant)
000C8E  2  1800 1           		retlw	01h
000C8F  2  1800 95          		retlw   95h	; report count (6)
000C90  2  1800 5           		retlw	05h	;06h
000C91  2                   
000C91  2  1800 75          		retlw   75h	; report size (8)
000C92  2  1800 8           		retlw	08h
000C93  2  1800 15          		retlw   15h	; logical minimum (0)
000C94  2  1800 0           		retlw	00h
000C95  2  1800 26          		retlw   26h	; logical maximum (255)
000C96  2  1800 ff          		retlw	ffh
000C97  2  1800 0           		retlw	00h
000C98  2  1800 5           		retlw   05h	; usage page (key codes)
000C99  2                   
000C99  2  1800 7           		retlw	07h
000C9A  2  1800 19          		retlw   19h	; usage minimum (0)
000C9B  2  1800 0           		retlw	00h
000C9C  2  1800 2a          		retlw   2ah	; usage maximum (255)
000C9D  2  1800 ff          		retlw	ffh
000C9E  2  1800 0           		retlw	00h
000C9F  2  1800 81          		retlw   81h	; input (data, array)
000CA0  2  1800 0           		retlw	00h
000CA1  2                   
000CA1  2  1800 c0          		retlw   c0h	; end collection
000CA2  2                   		
000CA2  2  1800 5           		retlw	05h	; usage page(consumer)
000CA3  2  1800 c           		retlw	0ch
000CA4  2  1800 9           		retlw	09h	; usage(remote control)
000CA5  2  1800 1           		retlw	01h		
000CA6  2  1800 a1          		retlw	a1h	; collection(application)
000CA7  2  1800 1           		retlw	01h
000CA8  2  1800 85          		retlw	85h	; report ID
000CA9  2  1800 2           		retlw	02h
000CAA  2  1800 15          		retlw	15h	; logical minimal
000CAB  2  1800 0           		retlw	00h
000CAC  2  1800 25          		retlw	25h	; logical maximal
000CAD  2  1800 1           		retlw	01h
000CAE  2  1800 75          		retlw	75h	; report size(1)
000CAF  2  1800 1           		retlw	01h
000CB0  2  1800 a           		retlw	0ah	; usage(AC search)
000CB1  2  1800 21          		retlw	21h
000CB2  2  1800 2           		retlw	02h
000CB3  2  1800 a           		retlw	0ah	; usage(AC Home)
000CB4  2  1800 23          		retlw	23h
000CB5  2  1800 2           		retlw	02h
000CB6  2                   
000CB6  2                   		;retlw	0ah	; usage(AC Yes)
000CB6  2                   		;retlw	5dh
000CB6  2                   		;retlw	02h
000CB6  2                   		;retlw	0ah	; usage(AC No)
000CB6  2                   		;retlw	5eh
000CB6  2                   		;retlw	02h
000CB6  2                   		;retlw	0ah	; usage(AC Cancel)
000CB6  2                   		;retlw	5fh
000CB6  2                   		;retlw	02h		
000CB6  2                   		
000CB6  2  1800 95          		retlw	95h	; report count(2)
000CB7  2  1800 2           		retlw	02h
000CB8  2  1800 81          		retlw	81h	; input(data, variable, absolute)
000CB9  2  1800 6           		retlw	06h
000CBA  2  1800 75          		retlw	75h	; report size(1)
000CBB  2  1800 1           		retlw	01h
000CBC  2  1800 95          		retlw	95h	; report count(6)
000CBD  2  1800 6           		retlw	06h
000CBE  2  1800 81          		retlw	81h	; input(constant)
000CBF  2  1800 1           		retlw	01h
000CC0  2  1800 c0          		retlw	c0h			
000CC1  2                   
000CC1  2                   		
000CC1  2                   Device_Status_Table1:
000CC1  2                   				
000CC1  2                   ;HID_Report2_Desc:		;//HOST TO DEVICE,used to send CBW
000CC1  2                   ;		retlw   05h		;//Usage Page (Generic Desktop Control)		05 01
000CC1  2                   ;		retlw	01h
000CC1  2                   ;		retlw   09h		;//Usage (Reserved)							09 03
000CC1  2                   ;		retlw	03h	
000CC1  2                   ;		retlw   a1h		;//Collection (Application)					A1 01
000CC1  2                   ;		retlw	01h
000CC1  2                   
000CC1  2                   		;//  DEVICE TO HOST32*8BITDATAARRAYABSOLUTE
000CC1  2                   ;		retlw   95h		;//Report Count (32)						95 20
000CC1  2                   ;		retlw	20h      
000CC1  2                   ;		retlw   75h		;//Report Size (8)							75 08  
000CC1  2                   ;		retlw	08h 	 
000CC1  2                   ;		retlw   15h		;//Logical Minimum (0)						15 00  
000CC1  2                   ;		retlw	00h       
000CC1  2                   ;		retlw   26h		;//Logical Maximum (255)					26 ff 00  
000CC1  2                   ;		retlw	ffh    
000CC1  2                   ;		retlw   00h
000CC1  2                   ;		retlw	05h     ;//Usage Page (Keyboard/Keypad Keys)		05 07
000CC1  2                   ;		retlw   07h	
000CC1  2                   ;		retlw	19h		;//Usage Minimum (0)						19 00
000CC1  2                   ;		retlw   00h
000CC1  2                   ;		retlw	2ah     ;//Usage Maximum (255)						2A FF 00
000CC1  2                   ;		retlw   ffh	
000CC1  2                   ;		retlw	00h    
000CC1  2                   ;		retlw   b1h		;//feature(Data, Array, Absolute)			81 00
000CC1  2                   ;		retlw	00h     
000CC1  2                   
000CC1  2                   		                ;//  HOST TO DEVICE 64*8BIT 64bytes at a time)
000CC1  2                   ;		retlw  15h		;//Logical Minimum (0)						15 00
000CC1  2                   ;		retlw	00h	  
000CC1  2                   ;		retlw  25h		;//Logical Maximum (1)						25 01  
000CC1  2                   ;		retlw	01h     
000CC1  2                   ;		;retlw  96h		;//Report Count (128)						96 00 01  
000CC1  2                   ;		;retlw	00h      
000CC1  2                   ;		;retlw	01h
000CC1  2                   ;		;retlw  75h		;//Report Size (8)							75 08  
000CC1  2                   ;		;retlw	01h	
000CC1  2                   ;		retlw  05h		;//Usage Page (LED)							05 08
000CC1  2                   ;		retlw	08h 	
000CC1  2                   ;		retlw  19h		;//Usage Minimum (1)						19 01
000CC1  2                   ;		retlw	01h     
000CC1  2                   ;		retlw  29h		;//Usage Maximum (128)						29 80
000CC1  2                   ;		retlw	80h    
000CC1  2                   ;		retlw  91h		;//Output (Data, Variable, Absolute)		91 02
000CC1  2                   ;		retlw	02h     
000CC1  2                   ;		retlw  C0h		;//End Collection							C0
000CC1  2                   
000CC1  2                   ;Device_Status_Table2:
000CC1  2                   .ENDTABLE
000CC1  2                   
000CC1  2                   		org 0d78h
000D78  2                   
000D78  2                   		
000D78  2                   .TABLE		
000D78  2                   WindowsURLTable:
000D78  2  0700 2,1         		addwf	Pcl,F
000D79  2                   	WindowsIDTable:
000D79  2  1800 12          		retlw	12h						;verify tag v3
000D7A  2  1800 1           		retlw	01h						;language type(use 0f00) 
000D7B  2  1800 2           		retlw	02h						;encryption type(use 0f00)
000D7C  2  1800 0           		retlw	00h						;Windows URL started address high byte
000D7D  2  1800 10          		retlw	10h						;Windows URL started address low byte
000D7E  2  1800 13          		retlw	13h						;Windows URL length(1 Bytes 1 char)
000D7F  2  1800 0           		retlw	00h						;next OS URL started address high byte
000D80  2  1800 23          		retlw	23h						;next OS URL started address low byte
000D81  2  1800 13          		retlw	13h						;next OS URL length
000D82  2  1800 0           		retlw	00h						;security key started address high byte
000D83  2  1800 49          		retlw	49h						;security key started address low byte
000D84  2  1800 0           		retlw	00h						;reserved
000D85  2  1800 0           		retlw	00h						;reserved
000D86  2  1800 2           		retlw	02h						;reserved
000D87  2  1800 0           		retlw	00h						;reserved
000D88  2  1800 0           		retlw	00h						;reserved
000D89  2                   		
000D89  2                   	WindowsURLAddress:
000D89  2  1800 68          		retlw	68h			;68h
000D8A  2  1800 f4          		retlw	f4h			;'T'
000D8B  2  1800 74          		retlw	74h			;'t'
000D8C  2  1800 f0          		retlw	f0h			;'p'
000D8D  2  1800 3a          		retlw	3ah			;':'
000D8E  2  1800 af          		retlw	afh			;'/'
000D8F  2  1800 2f          		retlw	2fh			;'/'
000D90  2  1800 f7          		retlw	f7h			;'w'
000D91  2  1800 77          		retlw	77h			;'w'
000D92  2  1800 f7          		retlw	f7h			;'w'
000D93  2  1800 2e          		retlw	2eh			;'.'
000D94  2  1800 e1          		retlw	e1h			;'a'
000D95  2  1800 73          		retlw	73h			;'s'
000D96  2  1800 ef          		retlw	efh			;'o'
000D97  2  1800 73          		retlw	73h			;'s'
000D98  2  1800 ae          		retlw	aeh			;'.'
000D99  2  1800 63          		retlw	63h			;'c'
000D9A  2  1800 ef          		retlw	efh			;'o'
000D9B  2  1800 6d          		retlw	6dh			;'m'
000D9C  2                   		
000D9C  2                   
000D9C  2                   	WindowsURLDone:	
000D9C  2                   	
000D9C  2                   .ENDTABLE
000D9C  2                   
000D9C  2                   ;===========================Device Information Table===========================
000D9C  2                   			org	0e00h;0f00h
000E00  2                   ;==============================================================================
000E00  2                   .TABLE		
000E00  2                   MACURLTable:
000E00  2                   ;DeviceInfoTable:
000E00  2  0700 2,1         		addwf	Pcl,F
000E01  2                   ;	DeviceIDTable:
000E01  2                   	MACIDTable:
000E01  2  1800 12          		retlw	12h						;verify tag v3
000E02  2  1800 1           		retlw	01h						;language type(use 0f00) 
000E03  2  1800 2           		retlw	02h						;encryption type(use 0f00)
000E04  2  1800 0           		retlw	00h						;MAC URL started address high byte
000E05  2  1800 10          		retlw	10h						;MAC URL started address low byte
000E06  2  1800 13          		retlw	13h						;MAC URL length(2 Bytes 1 char,max 79 char)
000E07  2  1800 0           		retlw	00h						;next OS URL started address high byte
000E08  2  1800 36          		retlw	36h						;next OS URL started address low byte
000E09  2  1800 13          		retlw	13h						;next OS URL length
000E0A  2  1800 0           		retlw	00h						;security key started address high byte
000E0B  2  1800 4c          		retlw	4Ch						;security key started address low byte
000E0C  2  1800 0           		retlw	00h						;reserved
000E0D  2  1800 0           		retlw	00h						;reserved
000E0E  2  1800 2           		retlw	02h						;reserved
000E0F  2  1800 0           		retlw	00h						;reserved
000E10  2  1800 0           		retlw	00h						;reserved
000E11  2                   		
000E11  2                   ;	URLAddressTable:
000E11  2                   	
000E11  2                   ;		retlw	68h;e8h;68h
000E11  2                   ;		retlw	f4h;74h;'T'
000E11  2                   ;		retlw	74h;f4h;'t'
000E11  2                   ;		retlw	f0h;70h;'p'
000E11  2                   ;		retlw	3ah;bah;':'
000E11  2                   ;		retlw	afh;2fh;'/'
000E11  2                   ;		retlw	2fh;afh;'/'
000E11  2                   ;		retlw	f7h;77h;'w'
000E11  2                   ;		retlw	77h;f7h;'w'
000E11  2                   ;		retlw	f7h;77h;'w'
000E11  2                   ;		retlw	2eh;aeh;'.'
000E11  2                   ;		retlw	e9h;		'i'
000E11  2                   ;		retlw	70h;		'p'
000E11  2                   ;		retlw	f0h;		'p'
000E11  2                   ;		retlw	30h;		'0'
000E11  2                   ;		retlw	aeh;		'.'
000E11  2                   ;		retlw	6eh;		'n'
000E11  2                   ;		retlw	e5h;		'e'
000E11  2                   ;		retlw	74h;		't'
000E11  2                   	
000E11  2                   ;	MacURLAddressTable:	
000E11  2                   	MACURLAddress:
000E11  2  1800 0           		retlw	00h
000E12  2  1800 8b          		retlw	8bh		;h
000E13  2  1800 0           		retlw	00h
000E14  2  1800 97          		retlw	97h		;t
000E15  2  1800 0           		retlw	00h
000E16  2  1800 97          		retlw	97h		;t
000E17  2  1800 0           		retlw	00h
000E18  2  1800 93          		retlw	93h		;p
000E19  2  1800 2           		retlw	02h
000E1A  2  1800 b3          		retlw	b3h		;:
000E1B  2  1800 0           		retlw	00h
000E1C  2  1800 b8          		retlw	b8h		;/		
000E1D  2  1800 0           		retlw	00h				
000E1E  2  1800 b8          		retlw	b8h		;/		
000E1F  2  1800 0           		retlw	00h		
000E20  2  1800 9a          		retlw	9ah		;w
000E21  2  1800 0           		retlw	00h
000E22  2  1800 9a          		retlw	9ah		;w
000E23  2  1800 0           		retlw	00h
000E24  2  1800 9a          		retlw	9ah		;w
000E25  2  1800 0           		retlw	00h		
000E26  2  1800 b7          		retlw	b7h		;.
000E27  2  1800 0           		retlw	00h
000E28  2  1800 8c          		retlw	8ch		;i
000E29  2  1800 0           		retlw	00h
000E2A  2  1800 93          		retlw	93h		;p
000E2B  2  1800 0           		retlw	00h
000E2C  2  1800 93          		retlw	93h		;p
000E2D  2  1800 0           		retlw	00h
000E2E  2  1800 a7          		retlw	a7h		;0
000E2F  2  1800 0           		retlw	00h
000E30  2  1800 b7          		retlw	b7h		;.
000E31  2  1800 0           		retlw	00h		
000E32  2  1800 91          		retlw	91h		;n
000E33  2  1800 0           		retlw	00h		
000E34  2  1800 88          		retlw	88h		;e		
000E35  2  1800 0           		retlw	00h		
000E36  2  1800 97          		retlw	97h		;t
000E37  2                   		
000E37  2                   
000E37  2                   	MACURLDone:	
000E37  2                   
000E37  2                   
000E37  2                   .ENDTABLE	
000E37  2                   
000E37  2                   		
000E37  2                   ;	SecurityKeyURLAddress:	
000E37  2                   ;		retlw	02h;
000E37  2                   ;		retlw	05h;'B'
000E37  2                   ;		retlw	02h;
000E37  2                   ;		retlw	10h;'M'
000E37  2                   ;		retlw	02h;
000E37  2                   ;		retlw	1ah;'W'
000E37  2                   ;		retlw	02h;
000E37  2                   ;		retlw	20h;'#'
000E37  2                   ;		retlw	'#'
000E37  2                   ;		;retlw	'#'
000E37  2                   ;	SecurityKeyEnd:	
000E37  2                   
000E37  2                   
000E37  2                   ;===========================Device Information Table===========================
000E37  2                   			org	0f00h
000F00  2                   ;==============================================================================
000F00  2                   .TABLE		
000F00  2                   AndroidURLTable:
000F00  2  0700 2,1         		addwf	Pcl,F
000F01  2                   	AndroidIDTable:
000F01  2  1800 12          		retlw	12h						;verify tag v3
000F02  2  1800 1           		retlw	01h						;language type(use 0f00) 
000F03  2  1800 2           		retlw	02h						;encryption type(use 0f00)
000F04  2  1800 0           		retlw	00h						;Android URL started address high byte
000F05  2  1800 10          		retlw	10h						;Android URL started address low byte
000F06  2  1800 13          		retlw	13h						;Android URL length(2 Bytes 1 char,max 79 char)
000F07  2  1800 0           		retlw	00h						;next OS URL started address high byte
000F08  2  1800 36          		retlw	36h						;next OS URL started address low byte
000F09  2  1800 13          		retlw	13h						;next OS URL length
000F0A  2  1800 0           		retlw	00h						;security key started address high byte
000F0B  2  1800 4c          		retlw	4Ch						;security key started address low byte
000F0C  2  1800 0           		retlw	00h						;reserved
000F0D  2  1800 0           		retlw	00h						;reserved
000F0E  2  1800 2           		retlw	02h						;reserved
000F0F  2  1800 0           		retlw	00h						;reserved
000F10  2  1800 0           		retlw	00h						;reserved
000F11  2                   	AndroidURLAddress:	
000F11  2  1800 0           		retlw	00h
000F12  2  1800 8b          		retlw	8bh		;h
000F13  2  1800 0           		retlw	00h
000F14  2  1800 97          		retlw	97h		;t
000F15  2  1800 0           		retlw	00h
000F16  2  1800 97          		retlw	97h		;t
000F17  2  1800 0           		retlw	00h
000F18  2  1800 93          		retlw	93h		;p
000F19  2  1800 2           		retlw	02h
000F1A  2  1800 b3          		retlw	b3h		;:
000F1B  2  1800 0           		retlw	00h
000F1C  2  1800 b8          		retlw	b8h		;/		
000F1D  2  1800 0           		retlw	00h				
000F1E  2  1800 b8          		retlw	b8h		;/		
000F1F  2  1800 0           		retlw	00h		
000F20  2  1800 97          		retlw	97h		;t
000F21  2  1800 0           		retlw	00h
000F22  2  1800 9a          		retlw	9ah		;w
000F23  2  1800 0           		retlw	00h		
000F24  2  1800 b7          		retlw	b7h		;.
000F25  2  1800 0           		retlw	00h
000F26  2  1800 9c          		retlw	9ch		;y
000F27  2  1800 0           		retlw	00h
000F28  2  1800 84          		retlw	84h		;a
000F29  2  1800 0           		retlw	00h
000F2A  2  1800 8b          		retlw	8bh		;h
000F2B  2  1800 0           		retlw	00h
000F2C  2  1800 92          		retlw	92h		;o
000F2D  2  1800 0           		retlw	00h
000F2E  2  1800 92          		retlw	92h		;o		
000F2F  2  1800 0           		retlw	00h
000F30  2  1800 b7          		retlw	b7h		;.
000F31  2  1800 0           		retlw	00h		
000F32  2  1800 86          		retlw	86h		;c
000F33  2  1800 0           		retlw	00h		
000F34  2  1800 92          		retlw	92h		;o		
000F35  2  1800 0           		retlw	00h		
000F36  2  1800 90          		retlw	90h		;m
000F37  2                   
000F37  2                   
000F37  2                   		
000F37  2                   	AndroidURLDone:	
000F37  2                   
000F37  2                   
000F37  2                   .ENDTABLE
000F37  2                   
000F37  1                   
